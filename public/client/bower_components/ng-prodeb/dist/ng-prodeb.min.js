"use strict";!function(){angular.module("ngProdeb",["ngMaterial","md.data.table","ngMaterialDatePicker","text-mask","angularFileUpload"])}(),function(){function n(n,e,o,t,r){n.theme("default").primaryPalette("indigo").accentPalette("amber"),o.locale("pt-BR"),o.createFromInputFallback=function(n){n._d=new Date(n._i)},r.errorOnUnhandledRejections(!1),angular.forEach(t,function(n){e.icon(n.id,n.url)})}n.$inject=["$mdThemingProvider","$mdIconProvider","moment","PrIcons","$qProvider"],angular.module("ngProdeb").config(n)}(),function(){angular.module("ngProdeb").constant("lodash",_).constant("_",_).constant("alasql",alasql).constant("moment",moment)}(),function(){function n(n,e){angular.forEach(e,function(e){n.put(e.url,e.svg)})}n.$inject=["$templateCache","PrIcons"],angular.module("ngProdeb").run(n)}(),function(){angular.module("ngProdeb").component("prDateTimePicker",{template:'\n          <md-input-container class="md-block" flex="$ctrl.flex">\n            <label for="$ctrl.id">{{$ctrl.label}}</label>\n            <md-icon md-font-set="material-icons" class="md-warn"\n              ng-style="$ctrl.style.label"\n              ng-click="$ctrl.show(true)"\n              md-colors="$ctrl.colors.icon">date_range</md-icon>\n            <input\n              id="$ctrl.id"\n              ng-model="$ctrl.ngModel"\n              ng-click="$ctrl.show(false)"\n              ng-readonly="$ctrl.clickToShowInField"\n              text-mask="$ctrl.maskConfig"\n              type="text">\n            </input>\n          </md-input-container>\n        ',controller:["mdcDateTimeDialog","moment",function(n,e){function o(n){return angular.isUndefined(n)||n}var t=this;t.$onInit=function(){t.style={label:{cursor:"pointer"}},t.autoOk=o(t.autoOk),t.withMinutesPicker=o(t.withMinutesPicker),t.clickToShowInField=o(t.clickToShowInField),t.format=t.format||t.withTime?"DD/MM/YYYY HH:mm":"DD/MM/YYYY",t.defineMask(),t.defineColors()},t.defineColors=function(){t.colors={icon:{color:t.iconColor?t.iconColor:"default-grey-900"}}},t.defineMask=function(){angular.isUndefined(t.mask)&&(t.mask=[/\d/,/\d/,"/",/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/],t.withTime&&(t.mask=t.mask.concat([" ",/\d/,/\d/,":",/\d/,/\d/]))),t.maskConfig={mask:t.mask,guide:!1}},t.show=function(o){(t.clickToShowInField||o)&&n.show({maxDate:angular.isUndefined(t.maxDate)?null:t.maxDate,format:t.format,minutes:t.withMinutesPicker,currentDate:t.ngModel,autoOk:t.autoOk,cancelText:"Cancelar",todayText:"Hoje",time:t.withTime,date:!0}).then(function(n){t.ngModel=e(n).format(t.format)})}}],require:{ngModelCtrl:"ngModel"},bindings:{label:"=",minDate:"=",maxDate:"=",ngModel:"<",id:"<",iconColor:"<",withTime:"<",withMask:"<",withMinutesPicker:"<",clickToShowInField:"<",autoOk:"<",format:"<",flex:"<",mask:"<"}})}(),function(){function n(n,e,o,t,r,a){function i(e){if(!angular.isObject(e))return void n.error("PrDialog: Parâmetro inválido, é esperando um objeto como parâmetro.");var o={hasBackdrop:!1,escapeToClose:!1,bindToController:!0,clickOutsideToClose:!0,autoWrap:!0,skipHide:!0,locals:{},zIndex:75,fullscreen:!1};return angular.isDefined(e.locals)&&(o.locals=e.locals,delete e.locals),angular.merge(o,e)}function l(n){var o=i(n);return o.locals={title:angular.isDefined(o.title)?o.title:"Exception",description:angular.isDefined(o.description)?o.description:"",okBgColor:angular.isDefined(o.okBgColor)?o.okBgColor:"red-A700",toolbarBgColor:angular.isDefined(o.toolbarBgColor)?o.toolbarBgColor:"red-A700"},o.template=' <md-dialog flex=50 aria-label="'+o.locals.title+'">\n              <md-toolbar md-scroll-shrink md-colors="::{background:\'default-{{ctrl.toolbarBgColor}}\'}">\n                <div class="md-toolbar-tools">\n                  <h3>\n                    <span>'+o.locals.title+"</span>\n                  </h3>\n                </div>\n              </md-toolbar>\n              <md-dialog-content layout-margin>\n                <p>"+o.locals.description+'</p>\n              </md-dialog-content>\n              <md-dialog-actions>\n                <md-button class="md-raised"\n                  md-colors="::{background:\'default-{{ctrl.okBgColor}}\'}"\n                  ng-click="ctrl.okAction()">Ok</md-button>\n              </md-dialog-actions>\n            </md-dialog>\n          ',o.controller=["$mdDialog",function(n){function e(){n.hide()}var o=this;o.okAction=e}],o.controllerAs="ctrl",o.clickOutsideToClose=!1,o.hasBackdrop=!0,e.show(o)}function c(n){var o=i(n);return o.template=' <md-dialog flex=50 aria-label="{{::ctrl.title}}">\n              <md-toolbar md-scroll-shrink>\n                <div class="md-toolbar-tools">\n                  <h3>\n                    <span>{{::ctrl.title}}</span>\n                  </h3>\n                </div>\n              </md-toolbar>\n              <md-dialog-content layout-margin>\n                <p>{{::ctrl.description}}</p>\n              </md-dialog-content>\n              <md-dialog-actions>\n                <md-button class="md-raised"\n                  md-colors="::{background:\'default-{{ctrl.yesBgColor}}\'}"\n                  ng-click="ctrl.yesAction()">Sim</md-button>\n                <md-button class="md-raised"\n                  md-colors="::{background:\'default-{{ctrl.noBgColor}}\'}"\n                  ng-click="ctrl.noAction()">Não</md-button>\n              </md-dialog-actions>\n            </md-dialog>\n          ',o.locals={title:angular.isDefined(o.title)?o.title:"",description:angular.isDefined(o.description)?o.description:"",yesBgColor:angular.isDefined(o.yesBgColor)?o.yesBgColor:"primary",noBgColor:angular.isDefined(o.noBgColor)?o.noBgColor:"accent"},o.controller=["$mdDialog",function(n){function e(){n.cancel()}function o(){n.hide()}var t=this;t.noAction=e,t.yesAction=o}],o.controllerAs="ctrl",o.clickOutsideToClose=!1,o.hasBackdrop=!0,e.show(o)}function s(o){var t=i(o);return angular.isUndefined(t.templateUrl)&&angular.isUndefined(t.template)?void n.error("PrDialog: templateUrl ou template indefinido, é esperando um templateUrl ou um template como atributo."):(t=u(t),t.hasBackdrop=!1,e.show(t))}function u(n){if(n.hasBackdrop){var e=o.createBackdrop(t,"md-dialog-backdrop md-opaque md-backdrop-custom");r.enter(e,angular.element(a.find("body")));var i=n.onRemoving;n.onRemoving=function(){e.remove(),angular.isFunction(i)&&i.call()};var l=n.onComplete;n.onComplete=function(e,o){var t=parseInt(n.zIndex,10);angular.element(a[0].querySelector(".md-backdrop-custom")).css("z-index",t),o.css("z-index",t+1),angular.isFunction(l)&&l.call()}}return n}function d(){e.hide()}return{custom:s,confirm:c,close:d,alert:l}}n.$inject=["$log","$mdDialog","$mdUtil","$rootScope","$animate","$document"],angular.module("ngProdeb").factory("PrDialog",n)}(),function(){function n(n,e,o){function t(e,o,t,r){var a={headers:!0};return angular.isObject(r)&&angular.merge(a,r),angular.isUndefined(t)&&(t="export"),a.where=angular.isDefined(a.where)?" WHERE "+a.where:" ",a.orderBy=angular.isDefined(a.orderBy)?" ORDER BY "+a.orderBy:" ",t=t+"."+a.formatTo,n.promise("SELECT "+i(e)+" INTO "+a.formatTo.toUpperCase()+"(?, ?) FROM ? "+a.where+a.orderBy,[t,a,o])}function r(n,e,o,r){return angular.isUndefined(r)&&(r={}),r.formatTo="csv",t(n,e,o,r)}function a(n,e,o,r){return angular.isUndefined(r)&&(r={}),r.formatTo="xlsx",t(n,e,o,r)}function i(n){return angular.isArray(n)&&(n=e.map(n,function(n){return n.name+" as ["+n.label+"]"}).join(", ")),n}var l={exportToExcel:a,exportToCSV:r};return n.fn.formatDate=function(n,e){return o("prDate")(n,e)},l}n.$inject=["alasql","lodash","$filter"],angular.module("ngProdeb").factory("PrFile",n)}(),function(){function n(n){return function(e,o){var t="DD/MM/YYYY";return angular.isDefined(o)?n(e,o).format(t):n(e).format(t)}}n.$inject=["moment"],angular.module("ngProdeb").filter("prDate",n)}(),function(){function n(n){return function(e){return n(e).format("DD/MM/YYYY HH:mm")}}n.$inject=["moment"],angular.module("ngProdeb").filter("prDatetime",n)}(),function(){function n(n){return function(e){return n("currency")(e,"R$ ")}}n.$inject=["$filter"],angular.module("ngProdeb").filter("real",n)}(),function(){angular.module("ngProdeb").constant("PrIcons",[{id:"pr-excel",url:"pr-excel.svg",svg:'<svg height="24" width="24" style="fill:#2E7D32" viewBox="0 0 24 24"><path d="M6,2H14L20,8V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V4A2,2 0 0,1 6,2M13,3.5V9H18.5L13,3.5M17,11H13V13H14L12,14.67L10,13H11V11H7V13H8L11,15.5L8,18H7V20H11V18H10L12,16.33L14,18H13V20H17V18H16L13,15.5L16,13H17V11Z" /></svg>'}])}(),function(){function n(){return{restrict:"AE",scope:{paginator:"="},template:'\n        <section class="pr-pagination" layout="row">\n          <section layout="row" layout-align="center center" layout-wrap\n            style="margin-right: 10px"\n            ng-show="paginator.numberOfPages > 1">\n              <md-button class="md-raised"\n                ng-disabled="paginator.currentPage === 1"\n                ng-click="paginator.goToPage(1)">{{paginator.options.labels.first}}</md-button>\n              <md-button class="md-raised"\n                ng-disabled="paginator.currentPage === 1"\n                ng-click="paginator.previousPage()">{{paginator.options.labels.previous}}</md-button>\n              <md-button class="md-raised"\n                ng-repeat="n in paginator.pages(s)"\n                ng-class="{\'md-primary\': n == paginator.currentPage}"\n                ng-click="paginator.goToPage(n)"\n                ng-bind="n">1</md-button>\n            <md-button class="md-raised"\n              ng-disabled="paginator.currentPage == paginator.numberOfPages"\n              ng-click="paginator.nextPage()">{{paginator.options.labels.next}}</md-button>\n            <md-button class="md-raised"\n              ng-disabled="paginator.currentPage == paginator.numberOfPages"\n              ng-click="paginator.goToPage(paginator.numberOfPages)">{{paginator.options.labels.last}}</md-button>\n          </section>\n          <section layout="row" layout-align="center center"\n            ng-show="paginator.total > 0">\n            <md-button class="md-raised" style="cursor: default;"\n              ng-disabled="true" md-colors="::{background:\'default-accent\'}">Total: {{paginator.total}} registro(s)</md-button>\n          </section>\n        </section>'}}angular.module("ngProdeb").directive("prPagination",n)}(),function(){function n(){var n=function(n,e,o){var t={maxPages:10,labels:{first:"««",previous:"«",next:"»",last:"»»"}};angular.isUndefined(e)&&(e=10),angular.isDefined(o)&&(angular.isDefined(o.maxPages)&&(t.maxPages=o.maxPages),angular.isDefined(o.labels)&&(t.labels=o.labels)),t.maxPagesInner=Math.floor(t.maxPages/2),this.searchMethod=n,this.numberOfPages=1,this.total=0,this.perPage=e,this.currentPage=0,this.options=t};return n.prototype.calcNumberOfPages=function(n){this.total=n,n<=0?this.numberOfPages=1:this.numberOfPages=Math.floor(n/this.perPage)+(n%this.perPage>0?1:0)},n.prototype.pages=function(){for(var n=[],e=1;e<=this.numberOfPages;e++)this.currentPage===e?n.push(e):this.currentPage<=this.options.maxPagesInner+1?e<=this.options.maxPages&&n.push(e):e>=this.currentPage-this.options.maxPagesInner&&e<=this.currentPage+this.options.maxPagesInner&&n.push(e);return n},n.prototype.previousPage=function(){this.currentPage>1&&this.searchMethod(this.currentPage-1)},n.prototype.nextPage=function(){this.currentPage<this.numberOfPages&&this.searchMethod(this.currentPage+1)},n.prototype.goToPage=function(n){n>=1&&n<=this.numberOfPages&&this.searchMethod(n)},{getInstance:function(e,o,t){return new n(e,o,t)}}}angular.module("ngProdeb").factory("PrPagination",n)}(),function(){angular.module("ngProdeb").component("prSpinner",{template:'\n        <md-progress-linear class="spin-label-component {{::$ctrl.color}}"\n          ng-style="$ctrl.style"\n          md-mode="indeterminate"\n          ng-show="$ctrl.spinner && $ctrl.spinner.show"></md-progress-linear>\n        ',bindings:{position:"@",color:"@"},controller:["$scope",function(n){var e=this;e.$onInit=function(){e.style={position:angular.isDefined(e.position)?e.position:"fixed"},angular.isUndefined(e.color)&&(e.color="md-primary")},e.spinner={show:!1},n.$on("show-spinner",function(){e.spinner={show:!0}}),n.$on("hide-spinner",function(){e.spinner={show:!1}})}]})}(),function(){function n(n){function e(){n.$broadcast("show-spinner")}function o(){n.$broadcast("hide-spinner")}return{show:e,hide:o}}n.$inject=["$rootScope"],angular.module("ngProdeb").factory("PrSpinner",n)}(),function(){function n(n,e,o,t){function r(e,t,r){if(e){var a={template:'\n            <md-toast>\n              <div class="md-toast-content" md-colors="::{background:\''+t+'\'}">\n                <span class="md-toast-text" flex>'+e+"</span>\n              </div>\n            </md-toast>\n          ",position:"top right"};return angular.isObject(r)&&(a=angular.merge(a,r)),n.show(a)}o.debug("Mensagem para ser exibida no Toast não foi informada")}function a(e){return n.hide(e)}function i(n,e){return r(n,"green",e)}function l(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(angular.isObject(n)){var a="";if(g(n)){a+="Message: "+n.message+"<br/>Source: "+n.source+"<br/>Line: "+n.line+"<br/><br/>StackTrace: ";var i=n.stacktrace.split(" at ");return i.length>0?i.forEach(function(n,e){a+="<br/>Step "+(e+1)+": "+n}):a+=n.stacktrace,t.alert({title:"Exception",description:a})}e.forIn(n,function(n){a+=c(n)}),n=a}else angular.isArray(n)&&(n=c(n));return r(n,"red-A700",o)}function c(n){var e="";return angular.isArray(n)?n.forEach(function(n){e+=n+"<br/>"}):e+=n+"<br/>",e}function s(n,e,o){m.error(angular.isArray(n)||angular.isObject(n)?n:e,o)}function u(n,e){return r(n,"teal",e)}function d(n,e){return r(n,"warn",e)}function g(n){return angular.isObject(n)&&angular.isDefined(n.line)&&angular.isDefined(n.source)&&angular.isDefined(n.stacktrace)}var m={success:i,error:l,errorValidation:s,info:u,warn:d,hide:a};return m}n.$inject=["$mdToast","lodash","$log","PrDialog"],angular.module("ngProdeb").factory("PrToast",n)}(),function(){angular.module("ngProdeb").directive("prUploaderBase64",["$q",function(n){var e=Array.prototype.slice;return{restrict:"A",require:"?ngModel",link:function(o,t,r,a){a&&(a.$render=function(){},t.bind("change",function(o){function t(e){var o=n.defer(),t=new FileReader;return t.onload=function(n){o.resolve(n.target.result)},t.onerror=function(n){o.reject(n)},t.readAsDataURL(e),o.promise}var r=o.target;n.all(e.call(r.files,0).map(t)).then(function(n){r.multiple?a.$setViewValue(n):a.$setViewValue(n.length?n[0]:null)})}))}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5nLXByb2RlYi5qcyIsImFwcC5qcyIsImFwcC5jb25maWcuanMiLCJuZy1wcm9kZWIubWluLmpzIiwiYXBwLmV4dGVybmFsLmpzIiwiYXBwLnJ1bi5qcyIsImRhdGVwaWNrZXIvcHItZGF0ZS10aW1lLXBpY2tlci5kaXJlY3RpdmUuanMiLCJkaWFsb2cvcHItZGlhbG9nLnNlcnZpY2UuanMiLCJmaWxlL3ByLWZpbGUuc2VydmljZS5qcyIsImZpbHRlcnMvcHItZGF0ZS5maWx0ZXIuanMiLCJmaWx0ZXJzL3ByLWRhdGV0aW1lLmZpbHRlci5qcyIsImZpbHRlcnMvcmVhbC5maWx0ZXIuanMiLCJpY29ucy9wci1pY29ucy5jb25zdGFudC5qcyIsInBhZ2luYXRpb24vcHItcGFnaW5hdGlvbi5kaXJlY3RpdmUuanMiLCJwYWdpbmF0aW9uL3ByLXBhZ2luYXRpb24uc2VydmljZS5qcyIsInNwaW5uZXIvcHItc3Bpbm5lci5jb21wb25lbnQuanMiLCJzcGlubmVyL3ByLXNwaW5uZXIuc2VydmljZS5qcyIsInRvYXN0L3ByLXRvYXN0LnNlcnZpY2UuanMiLCJ1cGxvYWRlci1iYXNlNjQvcHItdXBsb2FkZXItYmFzZTY0LmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJG1kVGhlbWluZ1Byb3ZpZGVyIiwiJG1kSWNvblByb3ZpZGVyIiwibW9tZW50IiwiUHJJY29ucyIsIiRxUHJvdmlkZXIiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiYWNjZW50UGFsZXR0ZSIsImxvY2FsZSIsImNyZWF0ZUZyb21JbnB1dEZhbGxiYWNrIiwiX2QiLCJEYXRlIiwiX2kiLCJlcnJvck9uVW5oYW5kbGVkUmVqZWN0aW9ucyIsImZvckVhY2giLCJpY29uIiwiaWQiLCJ1cmwiLCIkaW5qZWN0IiwiY29uc3RhbnQiLCJfIiwiYWxhc3FsIiwicnVuIiwiJHRlbXBsYXRlQ2FjaGUiLCJwdXQiLCJzdmciLCJjb21wb25lbnQiLCJ0ZW1wbGF0ZSIsImNvbnRyb2xsZXIiLCJtZGNEYXRlVGltZURpYWxvZyIsInNldERlZmF1bHRUb1RydWUiLCJ2YWx1ZSIsImlzVW5kZWZpbmVkIiwiY3RybCIsInRoaXMiLCIkb25Jbml0Iiwic3R5bGUiLCJsYWJlbCIsImN1cnNvciIsImF1dG9PayIsIndpdGhNaW51dGVzUGlja2VyIiwiY2xpY2tUb1Nob3dJbkZpZWxkIiwiZm9ybWF0Iiwid2l0aFRpbWUiLCJkZWZpbmVNYXNrIiwiZGVmaW5lQ29sb3JzIiwiY29sb3JzIiwiY29sb3IiLCJpY29uQ29sb3IiLCJtYXNrIiwiY29uY2F0IiwibWFza0NvbmZpZyIsImd1aWRlIiwic2hvdyIsImZyb21JY29uIiwibWF4RGF0ZSIsIm1pbnV0ZXMiLCJjdXJyZW50RGF0ZSIsIm5nTW9kZWwiLCJjYW5jZWxUZXh0IiwidG9kYXlUZXh0IiwidGltZSIsImRhdGUiLCJ0aGVuIiwicmVxdWlyZSIsIm5nTW9kZWxDdHJsIiwiYmluZGluZ3MiLCJtaW5EYXRlIiwid2l0aE1hc2siLCJmbGV4IiwiZGlhbG9nU2VydmljZSIsIiRsb2ciLCIkbWREaWFsb2ciLCIkbWRVdGlsIiwiJHJvb3RTY29wZSIsIiRhbmltYXRlIiwiJGRvY3VtZW50IiwiYnVpbGQiLCJpc09iamVjdCIsImVycm9yIiwiZGVmYXVsdE9wdGlvbnMiLCJoYXNCYWNrZHJvcCIsImVzY2FwZVRvQ2xvc2UiLCJiaW5kVG9Db250cm9sbGVyIiwiY2xpY2tPdXRzaWRlVG9DbG9zZSIsImF1dG9XcmFwIiwic2tpcEhpZGUiLCJsb2NhbHMiLCJ6SW5kZXgiLCJmdWxsc2NyZWVuIiwiaXNEZWZpbmVkIiwibWVyZ2UiLCJhbGVydCIsIm9wdGlvbnMiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwib2tCZ0NvbG9yIiwidG9vbGJhckJnQ29sb3IiLCJva0FjdGlvbiIsImhpZGUiLCJ2bSIsImNvbnRyb2xsZXJBcyIsImNvbmZpcm0iLCJ5ZXNCZ0NvbG9yIiwibm9CZ0NvbG9yIiwibm9BY3Rpb24iLCJjYW5jZWwiLCJ5ZXNBY3Rpb24iLCJjdXN0b20iLCJ0ZW1wbGF0ZVVybCIsImFkZEJhY2tkcm9wIiwiYmFja2Ryb3AiLCJjcmVhdGVCYWNrZHJvcCIsImVudGVyIiwiZWxlbWVudCIsImZpbmQiLCJvcmlnaW5hbE9uUmVtb3ZpbmciLCJvblJlbW92aW5nIiwicmVtb3ZlIiwiaXNGdW5jdGlvbiIsImNhbGwiLCJvcmlnaW5hbE9uQ29tcGxldGUiLCJvbkNvbXBsZXRlIiwic2NvcGUiLCJwYXJzZUludCIsInF1ZXJ5U2VsZWN0b3IiLCJjc3MiLCJjbG9zZSIsImZhY3RvcnkiLCJQckZpbGUiLCJsb2Rhc2giLCIkZmlsdGVyIiwiZXhwb3J0VG8iLCJmaWVsZHMiLCJkYXRhIiwiZmlsZU5hbWUiLCJkZWZhdWx0Q29uZmlnIiwiaGVhZGVycyIsIndoZXJlIiwib3JkZXJCeSIsImZvcm1hdFRvIiwicHJvbWlzZSIsImJ1aWxkRmllbGRzIiwidG9VcHBlckNhc2UiLCJleHBvcnRUb0NTViIsImV4cG9ydFRvRXhjZWwiLCJpc0FycmF5IiwibWFwIiwiZmllbGQiLCJuYW1lIiwiam9pbiIsIm9iaiIsImZuIiwiZm9ybWF0RGF0ZSIsInByRGF0ZSIsImlucHV0Rm9ybWF0Iiwib3V0cHV0Rm9ybWF0IiwiZmlsdGVyIiwicHJEYXRldGltZSIsInJlYWwiLCJwYWdpbmF0aW9uRGlyZWN0aXZlIiwicmVzdHJpY3QiLCJwYWdpbmF0b3IiLCJkaXJlY3RpdmUiLCJwYWdpbmF0aW9uU2VydmljZSIsIlByUGFnaW5hY2FvIiwic2VhcmNoTWV0aG9kIiwicGVyUGFnZSIsIl9vcHRpb25zIiwibWF4UGFnZXMiLCJsYWJlbHMiLCJmaXJzdCIsInByZXZpb3VzIiwibmV4dCIsImxhc3QiLCJtYXhQYWdlc0lubmVyIiwiTWF0aCIsImZsb29yIiwibnVtYmVyT2ZQYWdlcyIsInRvdGFsIiwiY3VycmVudFBhZ2UiLCJwcm90b3R5cGUiLCJjYWxjTnVtYmVyT2ZQYWdlcyIsInBhZ2VzIiwicmV0IiwiaSIsInB1c2giLCJwcmV2aW91c1BhZ2UiLCJuZXh0UGFnZSIsImdvVG9QYWdlIiwicGFnZSIsImdldEluc3RhbmNlIiwicG9zaXRpb24iLCIkc2NvcGUiLCJzcGlubmVyIiwiJG9uIiwic3Bpbm5lclNlcnZpY2UiLCIkYnJvYWRjYXN0IiwiVG9hc3QiLCIkbWRUb2FzdCIsIlByRGlhbG9nIiwidG9hc3QiLCJtc2ciLCJkZWJ1ZyIsIm9iamVjdCIsInN1Y2Nlc3MiLCJlcnJvcnMiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJlcnJvclN0ciIsImNoZWNrRXJyb3JJc1Vua25vd25FeGNlcHRpb24iLCJtZXNzYWdlIiwic291cmNlIiwibGluZSIsInN0ZXBzIiwic3RhY2t0cmFjZSIsInNwbGl0Iiwic3RlcCIsImluZGV4IiwiZm9ySW4iLCJrZXlFcnJvcnMiLCJidWlsZEFycmF5TWVzc2FnZSIsImFyck1zZyIsImVycm9yVmFsaWRhdGlvbiIsImluZm8iLCJ3YXJuIiwiJHEiLCJzbGljZSIsIkFycmF5IiwibGluayIsImF0dHJzIiwiJHJlbmRlciIsImJpbmQiLCJlIiwicmVhZEZpbGUiLCJmaWxlIiwiZGVmZXJyZWQiLCJkZWZlciIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJyZXNvbHZlIiwidGFyZ2V0IiwicmVzdWx0Iiwib25lcnJvciIsInJlamVjdCIsInJlYWRBc0RhdGFVUkwiLCJhbGwiLCJmaWxlcyIsInZhbHVlcyIsIm11bHRpcGxlIiwiJHNldFZpZXdWYWx1ZSJdLCJtYXBwaW5ncyI6IkFBQUEsY0NFQSxXQUlFQSxRQUFRQyxPQUFPLFlBQWEsYUFBYyxnQkFBaUIsdUJBQXdCLFlBQWEseUJDTmpHLFdBU0MsUUFBU0MsR0FBT0MsRUFBb0JDLEVBQ2xDQyxFQUFRQyxFQUFTQyxHQUVqQkosRUFBbUJLLE1BQU0sV0FDdEJDLGVBQWUsVUFDZkMsY0FBYyxTQUVqQkwsRUFBT00sT0FBTyxTQUVkTixFQUFPTyx3QkFBMEIsU0FBU1YsR0FFeENBLEVBQU9XLEdBQUssR0FBSUMsTUFBS1osRUFBT2EsS0FHOUJSLEVBQVdTLDRCQUEy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VStDLEtBRTVCLFFBQ0VuRSxTQUFVLElBQ1ZqRyxRQUFTLFdBQ1RzSyxLQUFNLFNBQVMzRyxFQUFPVCxFQUFTcUgsRUFBTzdLLEdBQy9CQSxJQUVMQSxFQUFROEssUUFBVSxhQUVsQnRILEVBQVF1SCxLQUFLLFNBQVUsU0FBU0MsR0FTOUIsUUFBU0MsR0FBU0MsR0FDaEIsR0FBSUMsR0FBV1YsRUFBR1csUUFFZEMsRUFBUyxHQUFJQyxXQVVqQixPQVJBRCxHQUFPRSxPQUFTLFNBQVNQLEdBQ3ZCRyxFQUFTSyxRQUFRUixFQUFFUyxPQUFPQyxTQUU1QkwsRUFBT00sUUFBVSxTQUFTWCxHQUN4QkcsRUFBU1MsT0FBT1osSUFFbEJLLEVBQU9RLGNBQWNYLEdBRWRDLEVBQVNoRyxRQXJCbEIsR0FBSTNCLEdBQVV3SCxFQUFFUyxNQUVoQmhCLEdBQUdxQixJQUFJcEIsRUFBTTVHLEtBQUtOLEVBQVF1SSxNQUFPLEdBQUd0RyxJQUFJd0YsSUFDckM1SyxLQUFLLFNBQVMyTCxHQUNUeEksRUFBUXlJLFNBQVVqTSxFQUFRa00sY0FBY0YsR0FDdkNoTSxFQUFRa00sY0FBY0YsRUFBTzFDLE9BQVMwQyxFQUFPLEdBQUsiLCJmaWxlIjoibmctcHJvZGViLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQgYW5ndWxhci9maWxlLW5hbWU6IDAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLy9pbmljaWEgbyBtb2R1bG8gZGEgYmlibGlvdGVjYSBlIGRlZmluZSBhcyBkZXBlbmTDqm5jaWFzXG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJywgWyduZ01hdGVyaWFsJywgJ21kLmRhdGEudGFibGUnLCAnbmdNYXRlcmlhbERhdGVQaWNrZXInLCAndGV4dC1tYXNrJywgJ2FuZ3VsYXJGaWxlVXBsb2FkJ10pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmNvbmZpZyhjb25maWcpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gY29uZmlnKCRtZFRoZW1pbmdQcm92aWRlciwgJG1kSWNvblByb3ZpZGVyLCBtb21lbnQsIFBySWNvbnMsICRxUHJvdmlkZXIpIHtcbiAgICAvL2NvbmZpZ3VyYcOnw7VlcyBwYWRyw7VlcyBkYXMgYmlibGlvdGVjYXMgcXVlIHPDo28gdXRpbGl6YWRhc1xuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpLnByaW1hcnlQYWxldHRlKCdpbmRpZ28nKS5hY2NlbnRQYWxldHRlKCdhbWJlcicpO1xuXG4gICAgbW9tZW50LmxvY2FsZSgncHQtQlInKTtcblxuICAgIG1vbWVudC5jcmVhdGVGcm9tSW5wdXRGYWxsYmFjayA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgIC8vIHVucmVsaWFibGUgc3RyaW5nIG1hZ2ljLCBvclxuICAgICAgY29uZmlnLl9kID0gbmV3IERhdGUoY29uZmlnLl9pKTtcbiAgICB9O1xuXG4gICAgJHFQcm92aWRlci5lcnJvck9uVW5oYW5kbGVkUmVqZWN0aW9ucyhmYWxzZSk7XG5cbiAgICBhbmd1bGFyLmZvckVhY2goUHJJY29ucywgZnVuY3Rpb24gKGljb24pIHtcbiAgICAgICRtZEljb25Qcm92aWRlci5pY29uKGljb24uaWQsIGljb24udXJsKTtcbiAgICB9KTtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQgYW5ndWxhci9maWxlLW5hbWU6IDAsIG5vLXVuZGVmOiAwKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vZW5jYXBzdWxhIGFzIGJpYmxpb3RlY2FzIGV4dGVybmFzIHBhcmEgc2VyZW0gY2FycmVnYWRhcyBjb21vIHVtYSBkZXBlbmTDqm5jaWFcbiAgLy9kbyBhbmd1bGFyLlxuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmNvbnN0YW50KCdsb2Rhc2gnLCBfKS5jb25zdGFudCgnXycsIF8pLmNvbnN0YW50KCdhbGFzcWwnLCBhbGFzcWwpLmNvbnN0YW50KCdtb21lbnQnLCBtb21lbnQpO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLnJ1bihydW4pO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gcnVuKCR0ZW1wbGF0ZUNhY2hlLCBQckljb25zKSB7XG4gICAgYW5ndWxhci5mb3JFYWNoKFBySWNvbnMsIGZ1bmN0aW9uIChpY29uKSB7XG4gICAgICAkdGVtcGxhdGVDYWNoZS5wdXQoaWNvbi51cmwsIGljb24uc3ZnKTtcbiAgICB9KTtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICogRGlyZXRpdmEgcXVlIGV4aWJlIHVtIHNwaW5uZXIgc2VtcHJlIHF1ZSB1bSBicm9hZGNhc3QsIG1hbnVhbG1lbnRlLCDDqSBkaXNwYXJhZG9cbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5jb21wb25lbnQoJ3ByRGF0ZVRpbWVQaWNrZXInLCB7XG4gICAgdGVtcGxhdGU6ICdcXG4gICAgICAgICAgPG1kLWlucHV0LWNvbnRhaW5lciBjbGFzcz1cIm1kLWJsb2NrXCIgZmxleD1cIiRjdHJsLmZsZXhcIj5cXG4gICAgICAgICAgICA8bGFiZWwgZm9yPVwiJGN0cmwuaWRcIj57eyRjdHJsLmxhYmVsfX08L2xhYmVsPlxcbiAgICAgICAgICAgIDxtZC1pY29uIG1kLWZvbnQtc2V0PVwibWF0ZXJpYWwtaWNvbnNcIiBjbGFzcz1cIm1kLXdhcm5cIlxcbiAgICAgICAgICAgICAgbmctc3R5bGU9XCIkY3RybC5zdHlsZS5sYWJlbFwiXFxuICAgICAgICAgICAgICBuZy1jbGljaz1cIiRjdHJsLnNob3codHJ1ZSlcIlxcbiAgICAgICAgICAgICAgbWQtY29sb3JzPVwiJGN0cmwuY29sb3JzLmljb25cIj5kYXRlX3JhbmdlPC9tZC1pY29uPlxcbiAgICAgICAgICAgIDxpbnB1dFxcbiAgICAgICAgICAgICAgaWQ9XCIkY3RybC5pZFwiXFxuICAgICAgICAgICAgICBuZy1tb2RlbD1cIiRjdHJsLm5nTW9kZWxcIlxcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCIkY3RybC5zaG93KGZhbHNlKVwiXFxuICAgICAgICAgICAgICBuZy1yZWFkb25seT1cIiRjdHJsLmNsaWNrVG9TaG93SW5GaWVsZFwiXFxuICAgICAgICAgICAgICB0ZXh0LW1hc2s9XCIkY3RybC5tYXNrQ29uZmlnXCJcXG4gICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCI+XFxuICAgICAgICAgICAgPC9pbnB1dD5cXG4gICAgICAgICAgPC9tZC1pbnB1dC1jb250YWluZXI+XFxuICAgICAgICAnLFxuICAgIGNvbnRyb2xsZXI6IFsnbWRjRGF0ZVRpbWVEaWFsb2cnLCAnbW9tZW50JywgZnVuY3Rpb24gKG1kY0RhdGVUaW1lRGlhbG9nLCBtb21lbnQpIHtcbiAgICAgIHZhciBjdHJsID0gdGhpcztcblxuICAgICAgY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjdHJsLnN0eWxlID0ge1xuICAgICAgICAgIGxhYmVsOiB7XG4gICAgICAgICAgICBjdXJzb3I6ICdwb2ludGVyJ1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBjdHJsLmF1dG9PayA9IHNldERlZmF1bHRUb1RydWUoY3RybC5hdXRvT2spO1xuICAgICAgICBjdHJsLndpdGhNaW51dGVzUGlja2VyID0gc2V0RGVmYXVsdFRvVHJ1ZShjdHJsLndpdGhNaW51dGVzUGlja2VyKTtcbiAgICAgICAgY3RybC5jbGlja1RvU2hvd0luRmllbGQgPSBzZXREZWZhdWx0VG9UcnVlKGN0cmwuY2xpY2tUb1Nob3dJbkZpZWxkKTtcbiAgICAgICAgY3RybC5mb3JtYXQgPSBjdHJsLmZvcm1hdCB8fCBjdHJsLndpdGhUaW1lID8gJ0REL01NL1lZWVkgSEg6bW0nIDogJ0REL01NL1lZWVknO1xuXG4gICAgICAgIGN0cmwuZGVmaW5lTWFzaygpO1xuICAgICAgICBjdHJsLmRlZmluZUNvbG9ycygpO1xuICAgICAgfTtcblxuICAgICAgY3RybC5kZWZpbmVDb2xvcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGN0cmwuY29sb3JzID0ge1xuICAgICAgICAgIGljb246IHtcbiAgICAgICAgICAgIGNvbG9yOiBjdHJsLmljb25Db2xvciA/IGN0cmwuaWNvbkNvbG9yIDogJ2RlZmF1bHQtZ3JleS05MDAnXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfTtcblxuICAgICAgY3RybC5kZWZpbmVNYXNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChjdHJsLm1hc2spKSB7XG4gICAgICAgICAgY3RybC5tYXNrID0gWy9cXGQvLCAvXFxkLywgJy8nLCAvXFxkLywgL1xcZC8sICcvJywgL1xcZC8sIC9cXGQvLCAvXFxkLywgL1xcZC9dO1xuXG4gICAgICAgICAgaWYgKGN0cmwud2l0aFRpbWUpIHtcbiAgICAgICAgICAgIGN0cmwubWFzayA9IGN0cmwubWFzay5jb25jYXQoWycgJywgL1xcZC8sIC9cXGQvLCAnOicsIC9cXGQvLCAvXFxkL10pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGN0cmwubWFza0NvbmZpZyA9IHtcbiAgICAgICAgICBtYXNrOiBjdHJsLm1hc2ssXG4gICAgICAgICAgZ3VpZGU6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICB9O1xuXG4gICAgICBmdW5jdGlvbiBzZXREZWZhdWx0VG9UcnVlKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBhbmd1bGFyLmlzVW5kZWZpbmVkKHZhbHVlKSB8fCB2YWx1ZTtcbiAgICAgIH1cblxuICAgICAgY3RybC5zaG93ID0gZnVuY3Rpb24gKGZyb21JY29uKSB7XG4gICAgICAgIGlmIChjdHJsLmNsaWNrVG9TaG93SW5GaWVsZCB8fCBmcm9tSWNvbikge1xuICAgICAgICAgIG1kY0RhdGVUaW1lRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgbWF4RGF0ZTogYW5ndWxhci5pc1VuZGVmaW5lZChjdHJsLm1heERhdGUpID8gbnVsbCA6IGN0cmwubWF4RGF0ZSxcbiAgICAgICAgICAgIGZvcm1hdDogY3RybC5mb3JtYXQsXG4gICAgICAgICAgICBtaW51dGVzOiBjdHJsLndpdGhNaW51dGVzUGlja2VyLFxuICAgICAgICAgICAgY3VycmVudERhdGU6IGN0cmwubmdNb2RlbCxcbiAgICAgICAgICAgIGF1dG9PazogY3RybC5hdXRvT2ssXG4gICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsYXInLFxuICAgICAgICAgICAgdG9kYXlUZXh0OiAnSG9qZScsXG4gICAgICAgICAgICB0aW1lOiBjdHJsLndpdGhUaW1lLFxuICAgICAgICAgICAgZGF0ZTogdHJ1ZVxuICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGUpIHtcbiAgICAgICAgICAgIGN0cmwubmdNb2RlbCA9IG1vbWVudChkYXRlKS5mb3JtYXQoY3RybC5mb3JtYXQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1dLFxuICAgIHJlcXVpcmU6IHtcbiAgICAgIG5nTW9kZWxDdHJsOiAnbmdNb2RlbCdcbiAgICB9LFxuICAgIGJpbmRpbmdzOiB7XG4gICAgICBsYWJlbDogJz0nLFxuICAgICAgbWluRGF0ZTogJz0nLFxuICAgICAgbWF4RGF0ZTogJz0nLFxuICAgICAgbmdNb2RlbDogJzwnLFxuICAgICAgaWQ6ICc8JyxcbiAgICAgIGljb25Db2xvcjogJzwnLFxuICAgICAgd2l0aFRpbWU6ICc8JyxcbiAgICAgIHdpdGhNYXNrOiAnPCcsXG4gICAgICB3aXRoTWludXRlc1BpY2tlcjogJzwnLFxuICAgICAgY2xpY2tUb1Nob3dJbkZpZWxkOiAnPCcsXG4gICAgICBhdXRvT2s6ICc8JyxcbiAgICAgIGZvcm1hdDogJzwnLFxuICAgICAgZmxleDogJzwnLFxuICAgICAgbWFzazogJzwnXG4gICAgfVxuICB9KTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmFjdG9yeSgnUHJEaWFsb2cnLCBkaWFsb2dTZXJ2aWNlKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIGRpYWxvZ1NlcnZpY2UoJGxvZywgJG1kRGlhbG9nLCAkbWRVdGlsLCAkcm9vdFNjb3BlLCAkYW5pbWF0ZSwgJGRvY3VtZW50KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGN1c3RvbTogY3VzdG9tLFxuICAgICAgY29uZmlybTogY29uZmlybSxcbiAgICAgIGNsb3NlOiBjbG9zZSxcbiAgICAgIGFsZXJ0OiBhbGVydFxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBjb25maWd1cmEgZSByZWFsaXphIG8gbWVyZ2UgZG8gb2JqZXRvIHJlY2ViaWRvIHZpYSBwYXLDom1ldHJvXG4gICAgICogY29tIGEgY29uZmlndXJhw6fDo28gcGFkcsOjbyBwYXJhIGEgZXhpYmnDp8OjbyBkbyBkaWFsb2dcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gY29uZmlnIC0gT2JqZXRvIGNvbnRlbmRvIGFzIGNvbmZpZ3VyYcOnw7Vlc1xuICAgICAqIEByZXR1cm5zIHtkaWFsb2dTZXJ2aWNlfSAtIFJldG9ybmEgbyBzZXJ2aWNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gYnVpbGQoY29uZmlnKSB7XG5cbiAgICAgIGlmICghYW5ndWxhci5pc09iamVjdChjb25maWcpKSB7XG4gICAgICAgICRsb2cuZXJyb3IoJ1ByRGlhbG9nOiBQYXLDom1ldHJvIGludsOhbGlkbywgw6kgZXNwZXJhbmRvIHVtIG9iamV0byBjb21vIHBhcsOibWV0cm8uJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgICAgICBoYXNCYWNrZHJvcDogZmFsc2UsXG4gICAgICAgIGVzY2FwZVRvQ2xvc2U6IGZhbHNlLFxuICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICBhdXRvV3JhcDogdHJ1ZSxcbiAgICAgICAgc2tpcEhpZGU6IHRydWUsXG4gICAgICAgIGxvY2Fsczoge30sXG4gICAgICAgIHpJbmRleDogNzUsXG4gICAgICAgIGZ1bGxzY3JlZW46IGZhbHNlXG4gICAgICB9O1xuXG4gICAgICAvL27Do28gZmF6ZW1vcyBtZXJnZSBkYSBwcm9wcmllZGFkZSBsb2NhbHMgcGFyYSBuw6NvIGVzdG91cmFyIG8gbGltaXRlIGRlIHJlY3Vyc2l2aWRhZGVcbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChjb25maWcubG9jYWxzKSkge1xuICAgICAgICBkZWZhdWx0T3B0aW9ucy5sb2NhbHMgPSBjb25maWcubG9jYWxzO1xuICAgICAgICBkZWxldGUgY29uZmlnLmxvY2FscztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGFuZ3VsYXIubWVyZ2UoZGVmYXVsdE9wdGlvbnMsIGNvbmZpZyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTcOpdG9kbyBxdWUgZXhpYmUgbyBkaWFsb2cgZGUgY29uZmlybWHDp8OjbyBuYSB0ZWxhIGRlcG9pcyBxdWUgbyBidWlsZCBlIGludm9jYWRvXG4gICAgICogZGUgdW1hIGRldGVybWluYWRhIGHDp8Ojb1xuICAgICAqIEByZXR1cm5zIHtwcm9taXNzZX0gLSBSZXRvcm5hIHVtYSBwcm9taXNzZSBxdWUgcG9kZSBvdSBuw6NvIHNlciByZXNvbHZpZGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhbGVydChjb25maWcpIHtcblxuICAgICAgdmFyIG9wdGlvbnMgPSBidWlsZChjb25maWcpO1xuXG4gICAgICBvcHRpb25zLmxvY2FscyA9IHtcbiAgICAgICAgdGl0bGU6IGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMudGl0bGUpID8gb3B0aW9ucy50aXRsZSA6ICdFeGNlcHRpb24nLFxuICAgICAgICBkZXNjcmlwdGlvbjogYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy5kZXNjcmlwdGlvbikgPyBvcHRpb25zLmRlc2NyaXB0aW9uIDogJycsXG4gICAgICAgIG9rQmdDb2xvcjogYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy5va0JnQ29sb3IpID8gb3B0aW9ucy5va0JnQ29sb3IgOiAncmVkLUE3MDAnLFxuICAgICAgICB0b29sYmFyQmdDb2xvcjogYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy50b29sYmFyQmdDb2xvcikgPyBvcHRpb25zLnRvb2xiYXJCZ0NvbG9yIDogJ3JlZC1BNzAwJ1xuICAgICAgfTtcblxuICAgICAgb3B0aW9ucy50ZW1wbGF0ZSA9ICcgPG1kLWRpYWxvZyBmbGV4PTUwIGFyaWEtbGFiZWw9XCInICsgb3B0aW9ucy5sb2NhbHMudGl0bGUgKyAnXCI+XFxuICAgICAgICAgICAgICA8bWQtdG9vbGJhciBtZC1zY3JvbGwtc2hyaW5rIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6XFwnZGVmYXVsdC17e2N0cmwudG9vbGJhckJnQ29sb3J9fVxcJ31cIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXRvb2xiYXItdG9vbHNcIj5cXG4gICAgICAgICAgICAgICAgICA8aDM+XFxuICAgICAgICAgICAgICAgICAgICA8c3Bhbj4nICsgb3B0aW9ucy5sb2NhbHMudGl0bGUgKyAnPC9zcGFuPlxcbiAgICAgICAgICAgICAgICAgIDwvaDM+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgPC9tZC10b29sYmFyPlxcbiAgICAgICAgICAgICAgPG1kLWRpYWxvZy1jb250ZW50IGxheW91dC1tYXJnaW4+XFxuICAgICAgICAgICAgICAgIDxwPicgKyBvcHRpb25zLmxvY2Fscy5kZXNjcmlwdGlvbiArICc8L3A+XFxuICAgICAgICAgICAgICA8L21kLWRpYWxvZy1jb250ZW50PlxcbiAgICAgICAgICAgICAgPG1kLWRpYWxvZy1hY3Rpb25zPlxcbiAgICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcXG4gICAgICAgICAgICAgICAgICBtZC1jb2xvcnM9XCI6OntiYWNrZ3JvdW5kOlxcJ2RlZmF1bHQte3tjdHJsLm9rQmdDb2xvcn19XFwnfVwiXFxuICAgICAgICAgICAgICAgICAgbmctY2xpY2s9XCJjdHJsLm9rQWN0aW9uKClcIj5PazwvbWQtYnV0dG9uPlxcbiAgICAgICAgICAgICAgPC9tZC1kaWFsb2ctYWN0aW9ucz5cXG4gICAgICAgICAgICA8L21kLWRpYWxvZz5cXG4gICAgICAgICAgJztcblxuICAgICAgb3B0aW9ucy5jb250cm9sbGVyID0gWyckbWREaWFsb2cnLCBmdW5jdGlvbiAoJG1kRGlhbG9nKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0ub2tBY3Rpb24gPSBva0FjdGlvbjtcblxuICAgICAgICBmdW5jdGlvbiBva0FjdGlvbigpIHtcbiAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgICAgICB9XG4gICAgICB9XTtcblxuICAgICAgb3B0aW9ucy5jb250cm9sbGVyQXMgPSAnY3RybCc7XG4gICAgICBvcHRpb25zLmNsaWNrT3V0c2lkZVRvQ2xvc2UgPSBmYWxzZTtcbiAgICAgIG9wdGlvbnMuaGFzQmFja2Ryb3AgPSB0cnVlO1xuXG4gICAgICByZXR1cm4gJG1kRGlhbG9nLnNob3cob3B0aW9ucyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTcOpdG9kbyBxdWUgZXhpYmUgbyBkaWFsb2cgZGUgY29uZmlybWHDp8OjbyBuYSB0ZWxhIGRlcG9pcyBxdWUgbyBidWlsZCBlIGludm9jYWRvXG4gICAgICogZGUgdW1hIGRldGVybWluYWRhIGHDp8Ojb1xuICAgICAqIEByZXR1cm5zIHtwcm9taXNzZX0gLSBSZXRvcm5hIHVtYSBwcm9taXNzZSBxdWUgcG9kZSBvdSBuw6NvIHNlciByZXNvbHZpZGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb25maXJtKGNvbmZpZykge1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IGJ1aWxkKGNvbmZpZyk7XG5cbiAgICAgIG9wdGlvbnMudGVtcGxhdGUgPSAnIDxtZC1kaWFsb2cgZmxleD01MCBhcmlhLWxhYmVsPVwie3s6OmN0cmwudGl0bGV9fVwiPlxcbiAgICAgICAgICAgICAgPG1kLXRvb2xiYXIgbWQtc2Nyb2xsLXNocmluaz5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXRvb2xiYXItdG9vbHNcIj5cXG4gICAgICAgICAgICAgICAgICA8aDM+XFxuICAgICAgICAgICAgICAgICAgICA8c3Bhbj57ezo6Y3RybC50aXRsZX19PC9zcGFuPlxcbiAgICAgICAgICAgICAgICAgIDwvaDM+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgPC9tZC10b29sYmFyPlxcbiAgICAgICAgICAgICAgPG1kLWRpYWxvZy1jb250ZW50IGxheW91dC1tYXJnaW4+XFxuICAgICAgICAgICAgICAgIDxwPnt7OjpjdHJsLmRlc2NyaXB0aW9ufX08L3A+XFxuICAgICAgICAgICAgICA8L21kLWRpYWxvZy1jb250ZW50PlxcbiAgICAgICAgICAgICAgPG1kLWRpYWxvZy1hY3Rpb25zPlxcbiAgICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcXG4gICAgICAgICAgICAgICAgICBtZC1jb2xvcnM9XCI6OntiYWNrZ3JvdW5kOlxcJ2RlZmF1bHQte3tjdHJsLnllc0JnQ29sb3J9fVxcJ31cIlxcbiAgICAgICAgICAgICAgICAgIG5nLWNsaWNrPVwiY3RybC55ZXNBY3Rpb24oKVwiPlNpbTwvbWQtYnV0dG9uPlxcbiAgICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcXG4gICAgICAgICAgICAgICAgICBtZC1jb2xvcnM9XCI6OntiYWNrZ3JvdW5kOlxcJ2RlZmF1bHQte3tjdHJsLm5vQmdDb2xvcn19XFwnfVwiXFxuICAgICAgICAgICAgICAgICAgbmctY2xpY2s9XCJjdHJsLm5vQWN0aW9uKClcIj5OXFx4RTNvPC9tZC1idXR0b24+XFxuICAgICAgICAgICAgICA8L21kLWRpYWxvZy1hY3Rpb25zPlxcbiAgICAgICAgICAgIDwvbWQtZGlhbG9nPlxcbiAgICAgICAgICAnO1xuICAgICAgb3B0aW9ucy5sb2NhbHMgPSB7XG4gICAgICAgIHRpdGxlOiBhbmd1bGFyLmlzRGVmaW5lZChvcHRpb25zLnRpdGxlKSA/IG9wdGlvbnMudGl0bGUgOiAnJyxcbiAgICAgICAgZGVzY3JpcHRpb246IGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMuZGVzY3JpcHRpb24pID8gb3B0aW9ucy5kZXNjcmlwdGlvbiA6ICcnLFxuICAgICAgICB5ZXNCZ0NvbG9yOiBhbmd1bGFyLmlzRGVmaW5lZChvcHRpb25zLnllc0JnQ29sb3IpID8gb3B0aW9ucy55ZXNCZ0NvbG9yIDogJ3ByaW1hcnknLFxuICAgICAgICBub0JnQ29sb3I6IGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMubm9CZ0NvbG9yKSA/IG9wdGlvbnMubm9CZ0NvbG9yIDogJ2FjY2VudCdcbiAgICAgIH07XG5cbiAgICAgIG9wdGlvbnMuY29udHJvbGxlciA9IFsnJG1kRGlhbG9nJywgZnVuY3Rpb24gKCRtZERpYWxvZykge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIHZtLm5vQWN0aW9uID0gbm9BY3Rpb247XG4gICAgICAgIHZtLnllc0FjdGlvbiA9IHllc0FjdGlvbjtcblxuICAgICAgICBmdW5jdGlvbiBub0FjdGlvbigpIHtcbiAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24geWVzQWN0aW9uKCkge1xuICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgIH1dO1xuXG4gICAgICBvcHRpb25zLmNvbnRyb2xsZXJBcyA9ICdjdHJsJztcbiAgICAgIG9wdGlvbnMuY2xpY2tPdXRzaWRlVG9DbG9zZSA9IGZhbHNlO1xuICAgICAgb3B0aW9ucy5oYXNCYWNrZHJvcCA9IHRydWU7XG5cbiAgICAgIHJldHVybiAkbWREaWFsb2cuc2hvdyhvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBleGliZSBvIGRpYWxvZyBjdXN0b21pemFkbyBuYSB0ZWxhIGRlcG9pcyBxdWUgbyBidWlsZCBlIGludm9jYWRvXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGN1c3RvbShjb25maWcpIHtcblxuICAgICAgdmFyIG9wdGlvbnMgPSBidWlsZChjb25maWcpO1xuXG4gICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChvcHRpb25zLnRlbXBsYXRlVXJsKSAmJiBhbmd1bGFyLmlzVW5kZWZpbmVkKG9wdGlvbnMudGVtcGxhdGUpKSB7XG4gICAgICAgICRsb2cuZXJyb3IoJ1ByRGlhbG9nOiB0ZW1wbGF0ZVVybCBvdSB0ZW1wbGF0ZSBpbmRlZmluaWRvLCDDqSBlc3BlcmFuZG8gdW0gdGVtcGxhdGVVcmwgb3UgdW0gdGVtcGxhdGUgY29tbyBhdHJpYnV0by4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvL0NyaWFkbyBvIGJhY2tkcm9wIG1hbnVhbG1lbnRlIHBhcmEgZGltaW51aXIgbyB6LWluZGV4IGF0cmF2w6lzIGRlIHVtYSBjbGFzc2UgY3NzXG4gICAgICAvL28gei1pbmRleCB0ZW0gcXVlIGZpY2FyIG1lbm9yIGRldmlkbyBhbyBkaWFsb2cuY29uZmlybSB1c2FyIG8gei1pbmRleCBvcmlnaW5hbCBkZSA4MFxuICAgICAgb3B0aW9ucyA9IGFkZEJhY2tkcm9wKG9wdGlvbnMpO1xuXG4gICAgICBvcHRpb25zLmhhc0JhY2tkcm9wID0gZmFsc2U7XG5cbiAgICAgIHJldHVybiAkbWREaWFsb2cuc2hvdyhvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBjcmlhIG8gYmFja2Ryb3AgZSBtb3N0cmEgbmEgdGVsYSBjb20gbyB6LWluZGV4IGNvbmZpZ3VyYXbDqWxcbiAgICAgKiBwYXJhIHNvYnJlcG9yIG9zIGVsZW1lbnRvcyBkYSB0ZWxhXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWRkQmFja2Ryb3Aob3B0aW9ucykge1xuICAgICAgaWYgKG9wdGlvbnMuaGFzQmFja2Ryb3ApIHtcbiAgICAgICAgdmFyIGJhY2tkcm9wID0gJG1kVXRpbC5jcmVhdGVCYWNrZHJvcCgkcm9vdFNjb3BlLCAnbWQtZGlhbG9nLWJhY2tkcm9wIG1kLW9wYXF1ZSBtZC1iYWNrZHJvcC1jdXN0b20nKTtcblxuICAgICAgICAkYW5pbWF0ZS5lbnRlcihiYWNrZHJvcCwgYW5ndWxhci5lbGVtZW50KCRkb2N1bWVudC5maW5kKCdib2R5JykpKTtcblxuICAgICAgICB2YXIgb3JpZ2luYWxPblJlbW92aW5nID0gb3B0aW9ucy5vblJlbW92aW5nO1xuXG4gICAgICAgIC8vTcOpdG9kbyBleGVjdXRhZG8gcXVhbmRvIGEgYW5pbWHDp8OjbyBkZSBmZWNoYW1lbnRvIGRvIGRpYWxvZyB0ZXJtaW5hXG4gICAgICAgIG9wdGlvbnMub25SZW1vdmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBiYWNrZHJvcC5yZW1vdmUoKTtcbiAgICAgICAgICBpZiAoYW5ndWxhci5pc0Z1bmN0aW9uKG9yaWdpbmFsT25SZW1vdmluZykpIG9yaWdpbmFsT25SZW1vdmluZy5jYWxsKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIG9yaWdpbmFsT25Db21wbGV0ZSA9IG9wdGlvbnMub25Db21wbGV0ZTtcblxuICAgICAgICAvL03DqXRvZG8gZXhlY3V0YWRvIHF1YW5kbyBhIGFuaW1hw6fDo28gZGUgYWJlcnR1cmEgZG8gZGlhbG9nIHRlcm1pbmFcbiAgICAgICAgb3B0aW9ucy5vbkNvbXBsZXRlID0gZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgICAgdmFyIHpJbmRleCA9IHBhcnNlSW50KG9wdGlvbnMuekluZGV4LCAxMCk7XG5cbiAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJGRvY3VtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1iYWNrZHJvcC1jdXN0b20nKSkuY3NzKCd6LWluZGV4JywgekluZGV4KTtcbiAgICAgICAgICBlbGVtZW50LmNzcygnei1pbmRleCcsIHpJbmRleCArIDEpO1xuICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24ob3JpZ2luYWxPbkNvbXBsZXRlKSkgb3JpZ2luYWxPbkNvbXBsZXRlLmNhbGwoKTtcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTcOpdG9kbyBxdWUgc2VydmUgcGFyYSBmZWNoYXIgbyBkaWFsb2dcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgfVxuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmZhY3RvcnkoJ1ByRmlsZScsIFByRmlsZSk7XG5cbiAgLyoqXG4gICAqIFNlcnZpY2UgcXVlIGVuY2Fwc3VsYSBvcyBzZXJ2acOnb3NcbiAgICogZGUgZXhwb3J0YcOnw6NvIGUgaW1wb3J0YcOnw6NvIGRlIGFycXVpdm9zXG4gICAqL1xuICAvKiogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIFByRmlsZShhbGFzcWwsIGxvZGFzaCwgJGZpbHRlcikge1xuICAgIHZhciBvYmogPSB7XG4gICAgICBleHBvcnRUb0V4Y2VsOiBleHBvcnRUb0V4Y2VsLFxuICAgICAgZXhwb3J0VG9DU1Y6IGV4cG9ydFRvQ1NWXG4gICAgfTtcblxuICAgIC8vRGVmaW5lZCBmaWx0ZXJzXG5cbiAgICBhbGFzcWwuZm4uZm9ybWF0RGF0ZSA9IGZ1bmN0aW9uIChkYXRlLCBmb3JtYXQpIHtcbiAgICAgIHJldHVybiAkZmlsdGVyKCdwckRhdGUnKShkYXRlLCBmb3JtYXQpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnRhIG9zIGRhZG9zIGVudmlhZG9zIHBhcmEgbyBmb3JtYXRvIGluZm9ybWFkby5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfGFycmF5fSBmaWVsZHNcbiAgICAgKiAgU3RyaW5nIGNvbnRlbmRvIG9zIGNhbXBvcyBzZXBhcmFkbyBwb3IgdmlyZ3VsYVxuICAgICAqICAgIGV4OiBuYW1lLCBkZXNjcmlwdGlvblxuICAgICAqICAgIGV4OiBuYW1lIGFzIE5vbWUsIGRlc2NyaXB0aW9uIGFzICdEZXNjcmnDp8OjbydcbiAgICAgKiAgICBleDogKiAgKHBhcmEgdG9kb3Mgb3MgY2FtcG9zKVxuICAgICAqICBBcnJheSBkZSBvYmpldG9zIGNvbSBvcyBjYW1wb3NcbiAgICAgKiAgICBleDogW1xuICAgICAqICAgICAgeyBuYW1lOiAnbmFtZScsIGxhYmVsOiAnTm9tZScgfSxcbiAgICAgKiAgICAgIHsgbmFtZTogJ2Rlc2NyaXB0aW9uJywgbGFiZWw6ICdEZXNjcmnDp8OjbycgfSxcbiAgICAgKiAgICAgIHsgbmFtZTogJ3JvbGUubmFtZScsIGxhYmVsOiAnUGVyZmlsJyB9LFxuICAgICAqICAgICAgeyBuYW1lOiAnZm9ybWF0RGF0ZShkYXRlKScsIGxhYmVsOiAnRGF0YScgfSwqXG4gICAgICogICAgXVxuICAgICAqIEBwYXJhbSB7YXJyYXl9IGRhdGEgLSBBcnJheSBxdWUgdmFpIHNlcnZpciBjb21vIGZvbnRlIGRlIGRhZG9zXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZpbGVOYW1lIC0gTm9tZSBkbyBhcnF1aXZvIHNlbSBhIGV4dGVuc8Ojb1xuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWdcbiAgICAgKiBDb25maWd1cmHDp8O1ZXMgZGEgZG9jdW1lbnRhw6fDo28gZG8gYWxhc3FsIGNvbW86XG4gICAgICogIC0gKGJvb2xlYW4pIGhlYWRlcnNcbiAgICAgKiBtYWlzIGFzIGRlc3RhY2FkYXMgYWJhaXhvXG4gICAgICogIC0gKHN0cmluZykgd2hlcmVcbiAgICAgKiAgLSAoc3RyaW5nKSBvcmRlckJ5XG4gICAgICpcbiAgICAgKiBmaWx0ZXJzIGRlZmluaWRvc1xuICAgICAqXG4gICAgICogZm9ybWF0RGF0ZShjYW1wbywgW2Zvcm1hdG9dKVxuICAgICAqXG4gICAgICogRXhlbXBsbzpcbiAgICAgKlxuICAgICAqIHZhciBjYXJzID0gW1xuICAgICAqICB7IG5hbWU6ICdTdGlsbycsICBicmFuZDogJ0ZpYXQnLCBkYXRlOiBtb21lbnQoKS5zdWJ0cmFjdCgxLCAneWVhcnMnKSB9LFxuICAgICAqICB7IG5hbWU6ICdQdW50bycsICBicmFuZDogJ0ZpYXQnLCBkYXRlOiBtb21lbnQoKS5zdWJ0cmFjdCgzLCAneWVhcnMnKSB9LFxuICAgICAqICB7IG5hbWU6ICdGaWVzdGEnLCBicmFuZDogJ0ZvcmQnLCBkYXRlOiAnMDQtMDEtMjAxNycgfVxuICAgICAqIF1cbiAgICAgKlxuICAgICAqIFByRmlsZS5leHBvcnRUb0V4Y2VsKFtcbiAgICAgKiAgeyBuYW1lOiAnYnJhbmQnLCBsYWJlbDogJ01hcmNhJyB9LFxuICAgICAqICB7IG5hbWU6ICduYW1lJywgbGFiZWw6ICdOb21lJyB9LFxuICAgICAqICB7IG5hbWU6ICdmb3JtYXREYXRlKGRhdGUsIFxcJ0RELU1NLVlZWVlcXCcpJywgbGFiZWw6ICdDb21wcmFkbyBlbT8nIH1cbiAgICAgKiBdLCBjYXJzLCAnZGF0YS1leHBvcnQnLCB7XG4gICAgICogIG9yZGVyQnk6ICdicmFuZCBBU0MsIG5hbWUgQVNDJyxcbiAgICAgKiAgd2hlcmU6ICdicmFuZCBsaWtlIFwiJUZpJVwiJ1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4cG9ydFRvKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZykge1xuICAgICAgdmFyIGRlZmF1bHRDb25maWcgPSB7XG4gICAgICAgIGhlYWRlcnM6IHRydWVcbiAgICAgIH07XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzT2JqZWN0KGNvbmZpZykpIGFuZ3VsYXIubWVyZ2UoZGVmYXVsdENvbmZpZywgY29uZmlnKTtcbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKGZpbGVOYW1lKSkgZmlsZU5hbWUgPSAnZXhwb3J0JztcblxuICAgICAgZGVmYXVsdENvbmZpZy53aGVyZSA9IGFuZ3VsYXIuaXNEZWZpbmVkKGRlZmF1bHRDb25maWcud2hlcmUpID8gJyBXSEVSRSAnICsgZGVmYXVsdENvbmZpZy53aGVyZSA6ICcgJztcbiAgICAgIGRlZmF1bHRDb25maWcub3JkZXJCeSA9IGFuZ3VsYXIuaXNEZWZpbmVkKGRlZmF1bHRDb25maWcub3JkZXJCeSkgPyAnIE9SREVSIEJZICcgKyBkZWZhdWx0Q29uZmlnLm9yZGVyQnkgOiAnICc7XG5cbiAgICAgIGZpbGVOYW1lID0gZmlsZU5hbWUgKyAnLicgKyBkZWZhdWx0Q29uZmlnLmZvcm1hdFRvO1xuXG4gICAgICByZXR1cm4gYWxhc3FsLnByb21pc2UoJ1NFTEVDVCAnICsgYnVpbGRGaWVsZHMoZmllbGRzKSArICcgSU5UTyAnICsgZGVmYXVsdENvbmZpZy5mb3JtYXRUby50b1VwcGVyQ2FzZSgpICsgJyg/LCA/KSBGUk9NID8gJyArIGRlZmF1bHRDb25maWcud2hlcmUgKyBkZWZhdWx0Q29uZmlnLm9yZGVyQnksIFtmaWxlTmFtZSwgZGVmYXVsdENvbmZpZywgZGF0YV0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4cG9ydGEgb3MgZGFkb3MgZW52aWFkb3MgcGFyYSBjc3ZcbiAgICAgKlxuICAgICAqIEBzZWUgZXhwb3J0VG9cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleHBvcnRUb0NTVihmaWVsZHMsIGRhdGEsIGZpbGVOYW1lLCBjb25maWcpIHtcbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKGNvbmZpZykpIGNvbmZpZyA9IHt9O1xuXG4gICAgICBjb25maWcuZm9ybWF0VG8gPSAnY3N2JztcblxuICAgICAgcmV0dXJuIGV4cG9ydFRvKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0YSBvcyBkYWRvcyBlbnZpYWRvcyBwYXJhIGV4Y2VsXG4gICAgICpcbiAgICAgKiBAc2VlIGV4cG9ydFRvXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXhwb3J0VG9FeGNlbChmaWVsZHMsIGRhdGEsIGZpbGVOYW1lLCBjb25maWcpIHtcbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKGNvbmZpZykpIGNvbmZpZyA9IHt9O1xuXG4gICAgICBjb25maWcuZm9ybWF0VG8gPSAneGxzeCc7XG5cbiAgICAgIHJldHVybiBleHBvcnRUbyhmaWVsZHMsIGRhdGEsIGZpbGVOYW1lLCBjb25maWcpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1vbnRhIHVtYSBzdHJpbmcgY29udGVuZG8gb3MgY2FtcG9zIHBhcmEgbyBTRUxFQ1QgZGEgUXVlcnkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYnVpbGRGaWVsZHMoZmllbGRzKSB7XG4gICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGZpZWxkcykpIHtcbiAgICAgICAgZmllbGRzID0gbG9kYXNoLm1hcChmaWVsZHMsIGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgICAgIHJldHVybiBmaWVsZC5uYW1lICsgJyBhcyBbJyArIGZpZWxkLmxhYmVsICsgJ10nO1xuICAgICAgICB9KS5qb2luKCcsICcpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmllbGRzO1xuICAgIH1cblxuICAgIHJldHVybiBvYmo7XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmZpbHRlcigncHJEYXRlJywgcHJEYXRlKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIHByRGF0ZShtb21lbnQpIHtcbiAgICAvKipcbiAgICAgKiBGb3JtYXRhIHVtYSBkYXRhIG5vIHBhZHLDo28gYnJhc2lsZWlyb1xuICAgICAqL1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUsIGlucHV0Rm9ybWF0KSB7XG4gICAgICB2YXIgb3V0cHV0Rm9ybWF0ID0gJ0REL01NL1lZWVknO1xuXG4gICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoaW5wdXRGb3JtYXQpKSB7XG4gICAgICAgIHJldHVybiBtb21lbnQodmFsdWUsIGlucHV0Rm9ybWF0KS5mb3JtYXQob3V0cHV0Rm9ybWF0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBtb21lbnQodmFsdWUpLmZvcm1hdChvdXRwdXRGb3JtYXQpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmZpbHRlcigncHJEYXRldGltZScsIHByRGF0ZXRpbWUpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gcHJEYXRldGltZShtb21lbnQpIHtcbiAgICAvKipcbiAgICAgKiBGb3JtYXRhIHVtYSBkYXRhIGNvbSBob3LDoXJpbyBubyBwYWRyw6NvIGJyYXNpbGVpcm9cbiAgICAgKi9cbiAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICByZXR1cm4gbW9tZW50KHZhbHVlKS5mb3JtYXQoJ0REL01NL1lZWVkgSEg6bW0nKTtcbiAgICB9O1xuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5maWx0ZXIoJ3JlYWwnLCByZWFsKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIHJlYWwoJGZpbHRlcikge1xuICAgIC8qKlxuICAgICAqIEZvcm1hdGEgdW0gdmFsb3IgcGFyYSBvIHBhZHLDo28gYnJhc2lsZWlyb1xuICAgICAqL1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiAkZmlsdGVyKCdjdXJyZW5jeScpKHZhbHVlLCAnUiQgJyk7XG4gICAgfTtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKiBlc2xpbnQtZGlzYWJsZSBtYXgtbGVuICovXG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuY29uc3RhbnQoJ1BySWNvbnMnLCBbe1xuICAgIGlkOiAncHItZXhjZWwnLFxuICAgIHVybDogJ3ByLWV4Y2VsLnN2ZycsXG4gICAgc3ZnOiAnPHN2ZyBoZWlnaHQ9XCIyNFwiIHdpZHRoPVwiMjRcIiBzdHlsZT1cImZpbGw6IzJFN0QzMlwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj48cGF0aCBkPVwiTTYsMkgxNEwyMCw4VjIwQTIsMiAwIDAsMSAxOCwyMkg2QTIsMiAwIDAsMSA0LDIwVjRBMiwyIDAgMCwxIDYsMk0xMywzLjVWOUgxOC41TDEzLDMuNU0xNywxMUgxM1YxM0gxNEwxMiwxNC42N0wxMCwxM0gxMVYxMUg3VjEzSDhMMTEsMTUuNUw4LDE4SDdWMjBIMTFWMThIMTBMMTIsMTYuMzNMMTQsMThIMTNWMjBIMTdWMThIMTZMMTMsMTUuNUwxNiwxM0gxN1YxMVpcIiAvPjwvc3ZnPidcbiAgfV0pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5kaXJlY3RpdmUoJ3ByUGFnaW5hdGlvbicsIHBhZ2luYXRpb25EaXJlY3RpdmUpO1xuXG4gIC8qKlxuICAgKiBEaXJldGl2YSBxdWUgZXhpYmUgdW1hIHBhZ2luYcOnw6NvLlxuICAgKiBBZG90YSBvIGVzdGlsbyBkZSBwYWdpbmHDp8OjbyBkYSBCdXNjYSBkbyBHb29nbGUuXG4gICAqIFV0aWxpemEgb3MgZXN0aWxvcyBkbyBib290c3RyYXBcbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gcGFnaW5hdGlvbkRpcmVjdGl2ZSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdBRScsXG4gICAgICBzY29wZToge1xuICAgICAgICBwYWdpbmF0b3I6ICc9J1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlOiAnXFxuICAgICAgICA8c2VjdGlvbiBjbGFzcz1cInByLXBhZ2luYXRpb25cIiBsYXlvdXQ9XCJyb3dcIj5cXG4gICAgICAgICAgPHNlY3Rpb24gbGF5b3V0PVwicm93XCIgbGF5b3V0LWFsaWduPVwiY2VudGVyIGNlbnRlclwiIGxheW91dC13cmFwXFxuICAgICAgICAgICAgc3R5bGU9XCJtYXJnaW4tcmlnaHQ6IDEwcHhcIlxcbiAgICAgICAgICAgIG5nLXNob3c9XCJwYWdpbmF0b3IubnVtYmVyT2ZQYWdlcyA+IDFcIj5cXG4gICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxcbiAgICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cInBhZ2luYXRvci5jdXJyZW50UGFnZSA9PT0gMVwiXFxuICAgICAgICAgICAgICAgIG5nLWNsaWNrPVwicGFnaW5hdG9yLmdvVG9QYWdlKDEpXCI+e3twYWdpbmF0b3Iub3B0aW9ucy5sYWJlbHMuZmlyc3R9fTwvbWQtYnV0dG9uPlxcbiAgICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXFxuICAgICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwicGFnaW5hdG9yLmN1cnJlbnRQYWdlID09PSAxXCJcXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCJwYWdpbmF0b3IucHJldmlvdXNQYWdlKClcIj57e3BhZ2luYXRvci5vcHRpb25zLmxhYmVscy5wcmV2aW91c319PC9tZC1idXR0b24+XFxuICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcXG4gICAgICAgICAgICAgICAgbmctcmVwZWF0PVwibiBpbiBwYWdpbmF0b3IucGFnZXMocylcIlxcbiAgICAgICAgICAgICAgICBuZy1jbGFzcz1cIntcXCdtZC1wcmltYXJ5XFwnOiBuID09IHBhZ2luYXRvci5jdXJyZW50UGFnZX1cIlxcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5nb1RvUGFnZShuKVwiXFxuICAgICAgICAgICAgICAgIG5nLWJpbmQ9XCJuXCI+MTwvbWQtYnV0dG9uPlxcbiAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxcbiAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCJwYWdpbmF0b3IuY3VycmVudFBhZ2UgPT0gcGFnaW5hdG9yLm51bWJlck9mUGFnZXNcIlxcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCJwYWdpbmF0b3IubmV4dFBhZ2UoKVwiPnt7cGFnaW5hdG9yLm9wdGlvbnMubGFiZWxzLm5leHR9fTwvbWQtYnV0dG9uPlxcbiAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxcbiAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCJwYWdpbmF0b3IuY3VycmVudFBhZ2UgPT0gcGFnaW5hdG9yLm51bWJlck9mUGFnZXNcIlxcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCJwYWdpbmF0b3IuZ29Ub1BhZ2UocGFnaW5hdG9yLm51bWJlck9mUGFnZXMpXCI+e3twYWdpbmF0b3Iub3B0aW9ucy5sYWJlbHMubGFzdH19PC9tZC1idXR0b24+XFxuICAgICAgICAgIDwvc2VjdGlvbj5cXG4gICAgICAgICAgPHNlY3Rpb24gbGF5b3V0PVwicm93XCIgbGF5b3V0LWFsaWduPVwiY2VudGVyIGNlbnRlclwiXFxuICAgICAgICAgICAgbmctc2hvdz1cInBhZ2luYXRvci50b3RhbCA+IDBcIj5cXG4gICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCIgc3R5bGU9XCJjdXJzb3I6IGRlZmF1bHQ7XCJcXG4gICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwidHJ1ZVwiIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6XFwnZGVmYXVsdC1hY2NlbnRcXCd9XCI+VG90YWw6IHt7cGFnaW5hdG9yLnRvdGFsfX0gcmVnaXN0cm8ocyk8L21kLWJ1dHRvbj5cXG4gICAgICAgICAgPC9zZWN0aW9uPlxcbiAgICAgICAgPC9zZWN0aW9uPidcbiAgICB9O1xuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmZhY3RvcnkoJ1ByUGFnaW5hdGlvbicsIHBhZ2luYXRpb25TZXJ2aWNlKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIHBhZ2luYXRpb25TZXJ2aWNlKCkge1xuXG4gICAgLyoqXG4gICAgICogQ3JpYSBlIHJldG9ybmEgdW1hIGluc3RhbmNpYSBkbyBvYmpldG8gcGFnaW5hZG9yLlxuICAgICAqXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gc2VhcmNoTWV0aG9kIC0gZnVuw6fDo28gcmVzcG9uc8OhdmVsIHBvciBjYXJyZWdhciBvcyBkYWRvc1xuICAgICAgIGUgcXVlIHZhaSBzZXIgY2hhbWFkYSBxdWFuZG8gbyB1c3XDoXJpbyBjbGljYXIgZW0gdW1hIHDDoWdpbmFcbiAgICAgKiBAcGFyYW0ge2ludH0gcGVyUGFnZSAtIE7Dum1lcm8gZGUgaXRlbnMgcG9yIHDDoWdpbmEuIFBhZHLDo28gw6kgMTAuXG4gICAgICogQHBhcmFtIHtvYmplY3R9IF9vcHRpb25zIC0gT2JqZXRvIGNvbnRlbmRvIGFzIGRlbWFpcyBjb25maWd1cmHDp8O1ZXNcbiAgICAgKi9cbiAgICB2YXIgUHJQYWdpbmFjYW8gPSBmdW5jdGlvbiBQclBhZ2luYWNhbyhzZWFyY2hNZXRob2QsIHBlclBhZ2UsIF9vcHRpb25zKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgbWF4UGFnZXM6IDEwLFxuICAgICAgICBsYWJlbHM6IHtcbiAgICAgICAgICBmaXJzdDogJ8KrwqsnLFxuICAgICAgICAgIHByZXZpb3VzOiAnwqsnLFxuICAgICAgICAgIG5leHQ6ICfCuycsXG4gICAgICAgICAgbGFzdDogJ8K7wrsnXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8vc29icmVlc2NyZXZlIG9zIHBhcmFtZXRyb3MgcGFkcsO1ZXNcbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKHBlclBhZ2UpKSB7XG4gICAgICAgIHBlclBhZ2UgPSAxMDtcbiAgICAgIH1cblxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKF9vcHRpb25zKSkge1xuICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoX29wdGlvbnMubWF4UGFnZXMpKSB7XG4gICAgICAgICAgb3B0aW9ucy5tYXhQYWdlcyA9IF9vcHRpb25zLm1heFBhZ2VzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChfb3B0aW9ucy5sYWJlbHMpKSB7XG4gICAgICAgICAgb3B0aW9ucy5sYWJlbHMgPSBfb3B0aW9ucy5sYWJlbHM7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy9jYWxjdWxhIHF1YW50YXMgcMOhZ2luYXMgdsOjbyBzZXIgZXhpYmlkYXMgbmEgcGFydGUgaW50ZXJtZWRpYXJpYSBkYSBwYWdpbmHDp8Ojb1xuICAgICAgb3B0aW9ucy5tYXhQYWdlc0lubmVyID0gTWF0aC5mbG9vcihvcHRpb25zLm1heFBhZ2VzIC8gMik7XG5cbiAgICAgIC8vQ3JpYSBvIG9iamV0byBwYWdpbmFkb3IgY29tIG9zIHBhcmFtZXRyb3MgaW5pY2lhaXNcbiAgICAgIHRoaXMuc2VhcmNoTWV0aG9kID0gc2VhcmNoTWV0aG9kO1xuICAgICAgdGhpcy5udW1iZXJPZlBhZ2VzID0gMTtcbiAgICAgIHRoaXMudG90YWwgPSAwO1xuICAgICAgdGhpcy5wZXJQYWdlID0gcGVyUGFnZTtcbiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAwO1xuICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYSBvIG7Dum1lcm8gZGUgcMOhZ2luYXMgcXVlIHZhaSBzZXIgZXhpYmlkYSBiYXNlYWRvIG5vIHRvdGFsIGRlXG4gICAgICogaXRlbnMgY29tIGEgcGVyUGFnZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbnR9IHRvdGFsIC0gdG90YWwgZGUgaXRlbnNcbiAgICAgKi9cbiAgICBQclBhZ2luYWNhby5wcm90b3R5cGUuY2FsY051bWJlck9mUGFnZXMgPSBmdW5jdGlvbiAodG90YWwpIHtcbiAgICAgIHRoaXMudG90YWwgPSB0b3RhbDtcblxuICAgICAgaWYgKHRvdGFsIDw9IDApIHtcbiAgICAgICAgdGhpcy5udW1iZXJPZlBhZ2VzID0gMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubnVtYmVyT2ZQYWdlcyA9IE1hdGguZmxvb3IodG90YWwgLyB0aGlzLnBlclBhZ2UpICsgKHRvdGFsICUgdGhpcy5wZXJQYWdlID4gMCA/IDEgOiAwKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVmVyaWZpY2EgYXMgcMOhZ2luYXMgcXVlIGRldmVtIHNlciBleGliaWRhc1xuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5wYWdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciByZXQgPSBbXTtcblxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gdGhpcy5udW1iZXJPZlBhZ2VzOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPT09IGkpIHtcbiAgICAgICAgICByZXQucHVzaChpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA8PSB0aGlzLm9wdGlvbnMubWF4UGFnZXNJbm5lciArIDEpIHtcbiAgICAgICAgICAgIGlmIChpIDw9IHRoaXMub3B0aW9ucy5tYXhQYWdlcykge1xuICAgICAgICAgICAgICByZXQucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGkgPj0gdGhpcy5jdXJyZW50UGFnZSAtIHRoaXMub3B0aW9ucy5tYXhQYWdlc0lubmVyICYmIGkgPD0gdGhpcy5jdXJyZW50UGFnZSArIHRoaXMub3B0aW9ucy5tYXhQYWdlc0lubmVyKSB7XG4gICAgICAgICAgICAgIHJldC5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJldDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FycmVnYSBvcyBkYWRvcyBkYSBww6FnaW5hIGFudGVyaW9yXG4gICAgICovXG4gICAgUHJQYWdpbmFjYW8ucHJvdG90eXBlLnByZXZpb3VzUGFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlID4gMSkge1xuICAgICAgICB0aGlzLnNlYXJjaE1ldGhvZCh0aGlzLmN1cnJlbnRQYWdlIC0gMSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENhcnJlZ2Egb3MgZGFkb3MgZGEgcHLDs3hpbWEgcMOhZ2luYVxuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5uZXh0UGFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlIDwgdGhpcy5udW1iZXJPZlBhZ2VzKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoTWV0aG9kKHRoaXMuY3VycmVudFBhZ2UgKyAxKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FycmVnYSBvcyBkYWRvcyBkYSBww6FnaW5hIGluZm9ybWFkYVxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbnR9IHBhZ2UgLSBwYWdpbmEgcXVlIGRldmUgc2VyIGNhcnJlZ2FkYVxuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5nb1RvUGFnZSA9IGZ1bmN0aW9uIChwYWdlKSB7XG4gICAgICBpZiAocGFnZSA+PSAxICYmIHBhZ2UgPD0gdGhpcy5udW1iZXJPZlBhZ2VzKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoTWV0aG9kKHBhZ2UpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgZ2V0SW5zdGFuY2U6IGZ1bmN0aW9uIGdldEluc3RhbmNlKHNlYXJjaE1ldGhvZCwgcGVyUGFnZSwgX29wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQclBhZ2luYWNhbyhzZWFyY2hNZXRob2QsIHBlclBhZ2UsIF9vcHRpb25zKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qKlxuICAgKiBEaXJldGl2YSBxdWUgZXhpYmUgdW0gc3Bpbm5lciBzZW1wcmUgcXVlIHVtIGJyb2FkY2FzdCwgbWFudWFsbWVudGUsIMOpIGRpc3BhcmFkb1xuICAgKi9cbiAgLyoqIEBuZ0luamVjdCAqL1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmNvbXBvbmVudCgncHJTcGlubmVyJywge1xuICAgIHRlbXBsYXRlOiAnXFxuICAgICAgICA8bWQtcHJvZ3Jlc3MtbGluZWFyIGNsYXNzPVwic3Bpbi1sYWJlbC1jb21wb25lbnQge3s6OiRjdHJsLmNvbG9yfX1cIlxcbiAgICAgICAgICBuZy1zdHlsZT1cIiRjdHJsLnN0eWxlXCJcXG4gICAgICAgICAgbWQtbW9kZT1cImluZGV0ZXJtaW5hdGVcIlxcbiAgICAgICAgICBuZy1zaG93PVwiJGN0cmwuc3Bpbm5lciAmJiAkY3RybC5zcGlubmVyLnNob3dcIj48L21kLXByb2dyZXNzLWxpbmVhcj5cXG4gICAgICAgICcsXG4gICAgYmluZGluZ3M6IHtcbiAgICAgIHBvc2l0aW9uOiAnQCcsXG4gICAgICBjb2xvcjogJ0AnXG4gICAgfSxcbiAgICBjb250cm9sbGVyOiBbJyRzY29wZScsIGZ1bmN0aW9uICgkc2NvcGUpIHtcbiAgICAgIHZhciBjdHJsID0gdGhpcztcblxuICAgICAgY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL0RlZmluZSBhIHBvc2nDp8Ojb1xuICAgICAgICBjdHJsLnN0eWxlID0geyBwb3NpdGlvbjogYW5ndWxhci5pc0RlZmluZWQoY3RybC5wb3NpdGlvbikgPyBjdHJsLnBvc2l0aW9uIDogJ2ZpeGVkJyB9O1xuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChjdHJsLmNvbG9yKSkgY3RybC5jb2xvciA9ICdtZC1wcmltYXJ5JztcbiAgICAgIH07XG4gICAgICAvL2NvbXBvcnRhbWVudG8gcGFkcsOjb1xuICAgICAgY3RybC5zcGlubmVyID0ge1xuICAgICAgICBzaG93OiBmYWxzZVxuICAgICAgfTtcblxuICAgICAgLy9Fc2N1dGEgbyBjYW5hbCBlbWl0aWRvIHZpYSBicm9hZGNhc3RcbiAgICAgIC8vcGFyYSBleGliaXIvZXNjb25kZXIgbyBjb21wb25lbnRlXG4gICAgICAkc2NvcGUuJG9uKCdzaG93LXNwaW5uZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGN0cmwuc3Bpbm5lciA9IHtcbiAgICAgICAgICBzaG93OiB0cnVlXG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgJHNjb3BlLiRvbignaGlkZS1zcGlubmVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBjdHJsLnNwaW5uZXIgPSB7XG4gICAgICAgICAgc2hvdzogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH1dXG4gIH0pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmZhY3RvcnkoJ1ByU3Bpbm5lcicsIHNwaW5uZXJTZXJ2aWNlKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIHNwaW5uZXJTZXJ2aWNlKCRyb290U2NvcGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2hvdzogc2hvdyxcbiAgICAgIGhpZGU6IGhpZGVcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRXhpYmUgbyBzcGlubmVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2hvdygpIHtcbiAgICAgIC8vZW1pdGUgbyBzaW5hbCBwYXJhIGEgZGlyZXRpdmEgaW5mb3JtYW5kbyBxdWUgbyBjb21wb25lbnRlIHNwaW5uZXIgZGV2ZSBzZXIgZXhpYmlkb1xuICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdzaG93LXNwaW5uZXInKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc2NvbmRlIG8gc3Bpbm5lclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhpZGUoKSB7XG4gICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2hpZGUtc3Bpbm5lcicpO1xuICAgIH1cbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5mYWN0b3J5KCdQclRvYXN0JywgVG9hc3QpO1xuXG4gIC8qKlxuICAgKiBTZXJ2acOnbyBxdWUgZW5jYXBzdWxhIGUgYW1wbGlhIG9zIHNlcnZpw6dvcyBkbyBhbmd1bGFyIHRvYXN0clxuICAgKi9cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBUb2FzdCgkbWRUb2FzdCwgbG9kYXNoLCAkbG9nLCBQckRpYWxvZykge1xuICAgIHZhciBvYmogPSB7XG4gICAgICBzdWNjZXNzOiBzdWNjZXNzLFxuICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgZXJyb3JWYWxpZGF0aW9uOiBlcnJvclZhbGlkYXRpb24sXG4gICAgICBpbmZvOiBpbmZvLFxuICAgICAgd2Fybjogd2FybixcbiAgICAgIGhpZGU6IGhpZGVcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRXhpYmUgdW1hIG5vdGlmaWNhw6fDo29cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtc2cgLSBNZW5zYWdlbSBkYSBub3RpZmljYcOnw6NvXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbG9yIC0gQ29yIGRlIGZ1bmRvIGRhIG5vdGlmaWNhw6fDo29cbiAgICAgKlxuICAgICAgQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHRvYXN0KG1zZywgY29sb3IsIG9wdGlvbnMpIHtcbiAgICAgIGlmIChtc2cpIHtcbiAgICAgICAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgICAgICAgIHRlbXBsYXRlOiAnXFxuICAgICAgICAgICAgPG1kLXRvYXN0PlxcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXRvYXN0LWNvbnRlbnRcIiBtZC1jb2xvcnM9XCI6OntiYWNrZ3JvdW5kOlxcJycgKyBjb2xvciArICdcXCd9XCI+XFxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibWQtdG9hc3QtdGV4dFwiIGZsZXg+JyArIG1zZyArICc8L3NwYW4+XFxuICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L21kLXRvYXN0PlxcbiAgICAgICAgICAnLFxuICAgICAgICAgIHBvc2l0aW9uOiAndG9wIHJpZ2h0J1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChhbmd1bGFyLmlzT2JqZWN0KG9wdGlvbnMpKSBkZWZhdWx0T3B0aW9ucyA9IGFuZ3VsYXIubWVyZ2UoZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuXG4gICAgICAgIHJldHVybiAkbWRUb2FzdC5zaG93KGRlZmF1bHRPcHRpb25zKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRsb2cuZGVidWcoJ01lbnNhZ2VtIHBhcmEgc2VyIGV4aWJpZGEgbm8gVG9hc3QgbsOjbyBmb2kgaW5mb3JtYWRhJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXNjb25kZSB1bWEgbm90aWZpY2HDp8Ojb1xuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IG9iamVjdCAtIFVtIGFyZ3VtZW50byBvcGNpb25hbCBwYXJhIGEgcHJvbWlzZSBhIHNlciByZXNvbHZpZGFcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtwcm9taXNzZX0gLSBSZXRvcm5hIHVtYSBwcm9taXNzZSBxdWUgw6kgZXhlY3V0YWRhIHF1YW5kbyBhIG5vdGlmaWNhw6fDo28gw6kgcmVtb3ZpZGEgZG8gRE9NXG4gICAgICovXG4gICAgZnVuY3Rpb24gaGlkZShvYmplY3QpIHtcbiAgICAgIHJldHVybiAkbWRUb2FzdC5oaWRlKG9iamVjdCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3VjY2Vzcyhtc2csIG9wdGlvbnMpIHtcbiAgICAgIHJldHVybiB0b2FzdChtc2csICdncmVlbicsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4aWJlIHVtIHRvYXN0IGNvbSBhcyBtZW5zYWdlbnMgZGUgZXJybyByZWZlcmVudGUgYSB2YWxpZGHDp8Ojby5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nIHwgb2JqZWN0IHwgYXJyYXl9IGVycm9ycyAtIFN0cmluZywgT2JqZXRvIG91IEFycmF5IGNvbnRlbmRvIGFzIG1lbnNhZ2VucyBkZSBlcnJvLlxuICAgICAqIFN1cG9ydGEgZGlmZXJlbnRlIGZvcm1hdG9zOlxuICAgICAqXG4gICAgICogUGFyYSB2YWxpZGHDp8O1ZXMgZGUgYXRyaWJ1dG9zXG4gICAgICogICB7XG4gICAgICogICAgXCJub21lLWRvLWF0cmlidXRvMVwiOiBbXCJtZW5zYWdlbSBkZSBlcnJvIDFcIiwgXCJtZW5zYWdlbSBkZSBlcnJvIDJcIl0sXG4gICAgICogICAgXCJub21lLWRvLWF0cmlidXRvMlwiOiBbXCJtZW5zYWdlbSBkZSBlcnJvIDFcIl1cbiAgICAgKiAgIH1cbiAgICAgKlxuICAgICAqIG91IC0gUGFyYSB2w6FyaWFzIG1lbnNhZ2VucyBzaW1wbGVzXG4gICAgICogICBbXG4gICAgICogICAgJ01lbnNhZ2VtIDEnLFxuICAgICAqICAgICdNZW5zYWdlbSAyJ1xuICAgICAqICAgXVxuICAgICAqXG4gICAgICogIG91IC0gUGFyYSAxIMO6bmljYSBtZW5zYWdlbVxuICAgICAqICAgXCJNZW5zYWdlbSAxXCJcbiAgICAgKlxuICAgICAqICBvdSAtIFBhcmEgZXhjZXB0aW9ucyAtIE5lc3RlIGNhc28gdXNhIHVtIFByRGlhbG9nXG4gICAgICogICB7XG4gICAgICogICAgIG1lc3NhZ2U6ICdFeGNlcHRpb24gRGVzY29uaGVjaWRhJyxcbiAgICAgKiAgICAgc291cmNlOiAnU3RhcnRlclBhY2suQ29udHJvbGxlcnMuU3VwcG9ydENvbnRyb2xsZXIubGFuZ3MoKScsXG4gICAgICogICAgIGxpbmU6IDIxLFxuICAgICAqICAgICBzdGFja3RyYWNlOiAnYXQgU3RhcnRlclBhY2suQ29udHJvbGxlcnMuU3VwcG9ydENvbnRyb2xsZXIubGFuZ3MoKSBpbiAvaG9tZS93b3Jrc3BhLi4uJ1xuICAgICAqICAgfVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtc2cgLSBPcGNpb25hbC4gTWVuc2FnZW0gZGUgZXJyby5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBlcnJvcihlcnJvcnMpIHtcbiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcblxuICAgICAgLy9zZSBmb3IgdW0gb2JqZXRvIGNvbnRlbmRvIG9zIGVycm9zLCBpdGVyYSBzb2JyZSBvcyBhdHJpYnV0b3MgZG8gbWVzbW9cbiAgICAgIC8vcGFyYSBleGliaXIgYShzKSBtZW5zYWdlbShucykgZGUgZXJybyBhdHJpYnVpZGFzXG4gICAgICBpZiAoYW5ndWxhci5pc09iamVjdChlcnJvcnMpKSB7XG4gICAgICAgIHZhciBlcnJvclN0ciA9ICcnO1xuXG4gICAgICAgIGlmIChjaGVja0Vycm9ySXNVbmtub3duRXhjZXB0aW9uKGVycm9ycykpIHtcbiAgICAgICAgICBlcnJvclN0ciArPSAnTWVzc2FnZTogJyArIGVycm9ycy5tZXNzYWdlICsgJzxici8+U291cmNlOiAnICsgZXJyb3JzLnNvdXJjZSArICc8YnIvPkxpbmU6ICcgKyBlcnJvcnMubGluZSArICc8YnIvPjxici8+U3RhY2tUcmFjZTogJztcblxuICAgICAgICAgIHZhciBzdGVwcyA9IGVycm9ycy5zdGFja3RyYWNlLnNwbGl0KCcgYXQgJyk7XG5cbiAgICAgICAgICBpZiAoc3RlcHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgc3RlcHMuZm9yRWFjaChmdW5jdGlvbiAoc3RlcCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgZXJyb3JTdHIgKz0gJzxici8+U3RlcCAnICsgKGluZGV4ICsgMSkgKyAnOiAnICsgc3RlcDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlcnJvclN0ciArPSBlcnJvcnMuc3RhY2t0cmFjZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gUHJEaWFsb2cuYWxlcnQoe1xuICAgICAgICAgICAgdGl0bGU6ICdFeGNlcHRpb24nLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGVycm9yU3RyXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gZXhpYmUgYXMgbWVuc2FnZW0gZGUgZXJybyBjb250aWRhcyBubyBvYmpldG9cbiAgICAgICAgICAvLyAge1xuICAgICAgICAgIC8vICAgIFwibmFtZVwiOiBbXCJvIGNhbXBvIG5vbWUgw6kgb2JyaWdhdMOzcmlvXCJdLFxuICAgICAgICAgIC8vICAgIFwicGFzc3dvcmRcIjogW1xuICAgICAgICAgIC8vICAgICAgXCJBIGNvbmZpcm1hw6fDo28gZGUgc2VuaGEgbsOjbyBjb25mZXJlLlwiLFxuICAgICAgICAgIC8vICAgICAgXCJzZW5oYSBkZXZlIHRlciBubyBtw61uaW1vIDYgY2FyYWN0ZXJlcy5cIlxuICAgICAgICAgIC8vICAgIF1cbiAgICAgICAgICAvLyAgfVxuICAgICAgICAgIGxvZGFzaC5mb3JJbihlcnJvcnMsIGZ1bmN0aW9uIChrZXlFcnJvcnMpIHtcbiAgICAgICAgICAgIGVycm9yU3RyICs9IGJ1aWxkQXJyYXlNZXNzYWdlKGtleUVycm9ycyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBlcnJvcnMgPSBlcnJvclN0cjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZXJyb3JzKSkge1xuICAgICAgICAgIGVycm9ycyA9IGJ1aWxkQXJyYXlNZXNzYWdlKGVycm9ycyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRvYXN0KGVycm9ycywgJ3JlZC1BNzAwJywgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYnVpbGRBcnJheU1lc3NhZ2UoYXJyTXNnKSB7XG4gICAgICB2YXIgbXNnID0gJyc7XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoYXJyTXNnKSkge1xuICAgICAgICAvL2l0ZXJhIHNvYnJlIG9zIGVycm9zIGRlIHVtIGF0cmlidXRvXG4gICAgICAgIGFyck1zZy5mb3JFYWNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIG1zZyArPSBlcnJvciArICc8YnIvPic7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbXNnICs9IGFyck1zZyArICc8YnIvPic7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBtc2c7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhpYmUgdW0gdG9hc3QgY29tIGFzIG1lbnNhZ2VucyBkZSBlcnJvIHJlZmVyZW50ZSBhIHZhbGlkYcOnw6NvLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3QgfCBhcnJheX0gZXJyb3JzIC0gT2JqZXRvIG91IEFycmF5IGNvbnRlbmRvIGFzIG1lbnNhZ2VucyBkZSBlcnJvLiBEZXZlIGVzdGFyXG4gICAgICogbm8gc2VndWludGUgZm9ybWF0by5cbiAgICAgKiAgIHtcbiAgICAgKiAgICBcIm5vbWUtZG8tYXRyaWJ1dG8xXCI6IFtcIm1lbnNhZ2VtIGRlIGVycm8gMVwiLCBcIm1lbnNhZ2VtIGRlIGVycm8gMlwiXSxcbiAgICAgKiAgICBcIm5vbWUtZG8tYXRyaWJ1dG8yXCI6IFtcIm1lbnNhZ2VtIGRlIGVycm8gMVwiXVxuICAgICAqICAgfVxuICAgICAqIG91XG4gICAgICogICBbXG4gICAgICogICAgJ01lbnNhZ2VtIDEnLFxuICAgICAqICAgICdNZW5zYWdlbSAyJ1xuICAgICAqICAgXVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtc2cgLSBPcGNpb25hbC4gTWVuc2FnZW0gZGUgZXJyby5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyAtIE9wdGlvbnMgZGEgZG9jdW1lbnRhw6fDo28gZG8gJG1kVG9hc3RcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBlcnJvclZhbGlkYXRpb24oZXJyb3JzLCBtc2csIG9wdGlvbnMpIHtcbiAgICAgIG9iai5lcnJvcihhbmd1bGFyLmlzQXJyYXkoZXJyb3JzKSB8fCBhbmd1bGFyLmlzT2JqZWN0KGVycm9ycykgPyBlcnJvcnMgOiBtc2csIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluZm8obXNnLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gdG9hc3QobXNnLCAndGVhbCcsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdhcm4obXNnLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gdG9hc3QobXNnLCAnd2FybicsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNoZWNrRXJyb3JJc1Vua25vd25FeGNlcHRpb24oZXJyb3JzKSB7XG4gICAgICByZXR1cm4gYW5ndWxhci5pc09iamVjdChlcnJvcnMpICYmIGFuZ3VsYXIuaXNEZWZpbmVkKGVycm9ycy5saW5lKSAmJiBhbmd1bGFyLmlzRGVmaW5lZChlcnJvcnMuc291cmNlKSAmJiBhbmd1bGFyLmlzRGVmaW5lZChlcnJvcnMuc3RhY2t0cmFjZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9iajtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5kaXJlY3RpdmUoJ3ByVXBsb2FkZXJCYXNlNjQnLCBmdW5jdGlvbiAoJHEpIHtcbiAgICB2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXG4gICAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbCkge1xuICAgICAgICBpZiAoIW5nTW9kZWwpIHJldHVybjtcblxuICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbiAoKSB7fTtcblxuICAgICAgICBlbGVtZW50LmJpbmQoJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdmFyIGVsZW1lbnQgPSBlLnRhcmdldDtcblxuICAgICAgICAgICRxLmFsbChzbGljZS5jYWxsKGVsZW1lbnQuZmlsZXMsIDApLm1hcChyZWFkRmlsZSkpLnRoZW4oZnVuY3Rpb24gKHZhbHVlcykge1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQubXVsdGlwbGUpIG5nTW9kZWwuJHNldFZpZXdWYWx1ZSh2YWx1ZXMpO2Vsc2UgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKHZhbHVlcy5sZW5ndGggPyB2YWx1ZXNbMF0gOiBudWxsKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGZ1bmN0aW9uIHJlYWRGaWxlKGZpbGUpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXG4gICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShlLnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xufSkoKTsiLCIvKmVzbGludCBhbmd1bGFyL2ZpbGUtbmFtZTogMCovXG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vaW5pY2lhIG8gbW9kdWxvIGRhIGJpYmxpb3RlY2EgZSBkZWZpbmUgYXMgZGVwZW5kw6puY2lhc1xuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInLCBbJ25nTWF0ZXJpYWwnLCAnbWQuZGF0YS50YWJsZScsICduZ01hdGVyaWFsRGF0ZVBpY2tlcicsICd0ZXh0LW1hc2snLCAnYW5ndWxhckZpbGVVcGxvYWQnXSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ25nUHJvZGViJylcbiAgICAuY29uZmlnKGNvbmZpZyk7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LXBhcmFtc1xuICBmdW5jdGlvbiBjb25maWcoJG1kVGhlbWluZ1Byb3ZpZGVyLCAkbWRJY29uUHJvdmlkZXIsXG4gICAgbW9tZW50LCBQckljb25zLCAkcVByb3ZpZGVyKSB7XG4gICAgLy9jb25maWd1cmHDp8O1ZXMgcGFkcsO1ZXMgZGFzIGJpYmxpb3RlY2FzIHF1ZSBzw6NvIHV0aWxpemFkYXNcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgLnByaW1hcnlQYWxldHRlKCdpbmRpZ28nKVxuICAgICAgLmFjY2VudFBhbGV0dGUoJ2FtYmVyJyk7XG5cbiAgICBtb21lbnQubG9jYWxlKCdwdC1CUicpO1xuXG4gICAgbW9tZW50LmNyZWF0ZUZyb21JbnB1dEZhbGxiYWNrID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAvLyB1bnJlbGlhYmxlIHN0cmluZyBtYWdpYywgb3JcbiAgICAgIGNvbmZpZy5fZCA9IG5ldyBEYXRlKGNvbmZpZy5faSk7XG4gICAgfTtcblxuICAgICRxUHJvdmlkZXIuZXJyb3JPblVuaGFuZGxlZFJlamVjdGlvbnMoZmFsc2UpO1xuXG4gICAgYW5ndWxhci5mb3JFYWNoKFBySWNvbnMsIGZ1bmN0aW9uKGljb24pIHtcbiAgICAgICRtZEljb25Qcm92aWRlci5pY29uKGljb24uaWQsIGljb24udXJsKTtcbiAgICB9KTtcbiAgfVxufSgpKTtcbiIsIid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQgYW5ndWxhci9maWxlLW5hbWU6IDAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLy9pbmljaWEgbyBtb2R1bG8gZGEgYmlibGlvdGVjYSBlIGRlZmluZSBhcyBkZXBlbmTDqm5jaWFzXG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJywgWyduZ01hdGVyaWFsJywgJ21kLmRhdGEudGFibGUnLCAnbmdNYXRlcmlhbERhdGVQaWNrZXInLCAndGV4dC1tYXNrJywgJ2FuZ3VsYXJGaWxlVXBsb2FkJ10pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGNvbmZpZy4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1Byb3ZpZGVyXCIsIFwiJG1kSWNvblByb3ZpZGVyXCIsIFwibW9tZW50XCIsIFwiUHJJY29uc1wiLCBcIiRxUHJvdmlkZXJcIl07XG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmNvbmZpZyhjb25maWcpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gY29uZmlnKCRtZFRoZW1pbmdQcm92aWRlciwgJG1kSWNvblByb3ZpZGVyLCBtb21lbnQsIFBySWNvbnMsICRxUHJvdmlkZXIpIHtcbiAgICAvL2NvbmZpZ3VyYcOnw7VlcyBwYWRyw7VlcyBkYXMgYmlibGlvdGVjYXMgcXVlIHPDo28gdXRpbGl6YWRhc1xuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpLnByaW1hcnlQYWxldHRlKCdpbmRpZ28nKS5hY2NlbnRQYWxldHRlKCdhbWJlcicpO1xuXG4gICAgbW9tZW50LmxvY2FsZSgncHQtQlInKTtcblxuICAgIG1vbWVudC5jcmVhdGVGcm9tSW5wdXRGYWxsYmFjayA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgIC8vIHVucmVsaWFibGUgc3RyaW5nIG1hZ2ljLCBvclxuICAgICAgY29uZmlnLl9kID0gbmV3IERhdGUoY29uZmlnLl9pKTtcbiAgICB9O1xuXG4gICAgJHFQcm92aWRlci5lcnJvck9uVW5oYW5kbGVkUmVqZWN0aW9ucyhmYWxzZSk7XG5cbiAgICBhbmd1bGFyLmZvckVhY2goUHJJY29ucywgZnVuY3Rpb24gKGljb24pIHtcbiAgICAgICRtZEljb25Qcm92aWRlci5pY29uKGljb24uaWQsIGljb24udXJsKTtcbiAgICB9KTtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQgYW5ndWxhci9maWxlLW5hbWU6IDAsIG5vLXVuZGVmOiAwKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vZW5jYXBzdWxhIGFzIGJpYmxpb3RlY2FzIGV4dGVybmFzIHBhcmEgc2VyZW0gY2FycmVnYWRhcyBjb21vIHVtYSBkZXBlbmTDqm5jaWFcbiAgLy9kbyBhbmd1bGFyLlxuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmNvbnN0YW50KCdsb2Rhc2gnLCBfKS5jb25zdGFudCgnXycsIF8pLmNvbnN0YW50KCdhbGFzcWwnLCBhbGFzcWwpLmNvbnN0YW50KCdtb21lbnQnLCBtb21lbnQpO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHJ1bi4kaW5qZWN0ID0gW1wiJHRlbXBsYXRlQ2FjaGVcIiwgXCJQckljb25zXCJdO1xuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5ydW4ocnVuKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIHJ1bigkdGVtcGxhdGVDYWNoZSwgUHJJY29ucykge1xuICAgIGFuZ3VsYXIuZm9yRWFjaChQckljb25zLCBmdW5jdGlvbiAoaWNvbikge1xuICAgICAgJHRlbXBsYXRlQ2FjaGUucHV0KGljb24udXJsLCBpY29uLnN2Zyk7XG4gICAgfSk7XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLyoqXG4gICAqIERpcmV0aXZhIHF1ZSBleGliZSB1bSBzcGlubmVyIHNlbXByZSBxdWUgdW0gYnJvYWRjYXN0LCBtYW51YWxtZW50ZSwgw6kgZGlzcGFyYWRvXG4gICAqL1xuICAvKiogQG5nSW5qZWN0ICovXG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuY29tcG9uZW50KCdwckRhdGVUaW1lUGlja2VyJywge1xuICAgIHRlbXBsYXRlOiAnXFxuICAgICAgICAgIDxtZC1pbnB1dC1jb250YWluZXIgY2xhc3M9XCJtZC1ibG9ja1wiIGZsZXg9XCIkY3RybC5mbGV4XCI+XFxuICAgICAgICAgICAgPGxhYmVsIGZvcj1cIiRjdHJsLmlkXCI+e3skY3RybC5sYWJlbH19PC9sYWJlbD5cXG4gICAgICAgICAgICA8bWQtaWNvbiBtZC1mb250LXNldD1cIm1hdGVyaWFsLWljb25zXCIgY2xhc3M9XCJtZC13YXJuXCJcXG4gICAgICAgICAgICAgIG5nLXN0eWxlPVwiJGN0cmwuc3R5bGUubGFiZWxcIlxcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCIkY3RybC5zaG93KHRydWUpXCJcXG4gICAgICAgICAgICAgIG1kLWNvbG9ycz1cIiRjdHJsLmNvbG9ycy5pY29uXCI+ZGF0ZV9yYW5nZTwvbWQtaWNvbj5cXG4gICAgICAgICAgICA8aW5wdXRcXG4gICAgICAgICAgICAgIGlkPVwiJGN0cmwuaWRcIlxcbiAgICAgICAgICAgICAgbmctbW9kZWw9XCIkY3RybC5uZ01vZGVsXCJcXG4gICAgICAgICAgICAgIG5nLWNsaWNrPVwiJGN0cmwuc2hvdyhmYWxzZSlcIlxcbiAgICAgICAgICAgICAgbmctcmVhZG9ubHk9XCIkY3RybC5jbGlja1RvU2hvd0luRmllbGRcIlxcbiAgICAgICAgICAgICAgdGV4dC1tYXNrPVwiJGN0cmwubWFza0NvbmZpZ1wiXFxuICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiPlxcbiAgICAgICAgICAgIDwvaW5wdXQ+XFxuICAgICAgICAgIDwvbWQtaW5wdXQtY29udGFpbmVyPlxcbiAgICAgICAgJyxcbiAgICBjb250cm9sbGVyOiBbJ21kY0RhdGVUaW1lRGlhbG9nJywgJ21vbWVudCcsIGZ1bmN0aW9uIChtZGNEYXRlVGltZURpYWxvZywgbW9tZW50KSB7XG4gICAgICB2YXIgY3RybCA9IHRoaXM7XG5cbiAgICAgIGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY3RybC5zdHlsZSA9IHtcbiAgICAgICAgICBsYWJlbDoge1xuICAgICAgICAgICAgY3Vyc29yOiAncG9pbnRlcidcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY3RybC5hdXRvT2sgPSBzZXREZWZhdWx0VG9UcnVlKGN0cmwuYXV0b09rKTtcbiAgICAgICAgY3RybC53aXRoTWludXRlc1BpY2tlciA9IHNldERlZmF1bHRUb1RydWUoY3RybC53aXRoTWludXRlc1BpY2tlcik7XG4gICAgICAgIGN0cmwuY2xpY2tUb1Nob3dJbkZpZWxkID0gc2V0RGVmYXVsdFRvVHJ1ZShjdHJsLmNsaWNrVG9TaG93SW5GaWVsZCk7XG4gICAgICAgIGN0cmwuZm9ybWF0ID0gY3RybC5mb3JtYXQgfHwgY3RybC53aXRoVGltZSA/ICdERC9NTS9ZWVlZIEhIOm1tJyA6ICdERC9NTS9ZWVlZJztcblxuICAgICAgICBjdHJsLmRlZmluZU1hc2soKTtcbiAgICAgICAgY3RybC5kZWZpbmVDb2xvcnMoKTtcbiAgICAgIH07XG5cbiAgICAgIGN0cmwuZGVmaW5lQ29sb3JzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjdHJsLmNvbG9ycyA9IHtcbiAgICAgICAgICBpY29uOiB7XG4gICAgICAgICAgICBjb2xvcjogY3RybC5pY29uQ29sb3IgPyBjdHJsLmljb25Db2xvciA6ICdkZWZhdWx0LWdyZXktOTAwJ1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH07XG5cbiAgICAgIGN0cmwuZGVmaW5lTWFzayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoY3RybC5tYXNrKSkge1xuICAgICAgICAgIGN0cmwubWFzayA9IFsvXFxkLywgL1xcZC8sICcvJywgL1xcZC8sIC9cXGQvLCAnLycsIC9cXGQvLCAvXFxkLywgL1xcZC8sIC9cXGQvXTtcblxuICAgICAgICAgIGlmIChjdHJsLndpdGhUaW1lKSB7XG4gICAgICAgICAgICBjdHJsLm1hc2sgPSBjdHJsLm1hc2suY29uY2F0KFsnICcsIC9cXGQvLCAvXFxkLywgJzonLCAvXFxkLywgL1xcZC9dKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjdHJsLm1hc2tDb25maWcgPSB7XG4gICAgICAgICAgbWFzazogY3RybC5tYXNrLFxuICAgICAgICAgIGd1aWRlOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgfTtcblxuICAgICAgZnVuY3Rpb24gc2V0RGVmYXVsdFRvVHJ1ZSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gYW5ndWxhci5pc1VuZGVmaW5lZCh2YWx1ZSkgfHwgdmFsdWU7XG4gICAgICB9XG5cbiAgICAgIGN0cmwuc2hvdyA9IGZ1bmN0aW9uIChmcm9tSWNvbikge1xuICAgICAgICBpZiAoY3RybC5jbGlja1RvU2hvd0luRmllbGQgfHwgZnJvbUljb24pIHtcbiAgICAgICAgICBtZGNEYXRlVGltZURpYWxvZy5zaG93KHtcbiAgICAgICAgICAgIG1heERhdGU6IGFuZ3VsYXIuaXNVbmRlZmluZWQoY3RybC5tYXhEYXRlKSA/IG51bGwgOiBjdHJsLm1heERhdGUsXG4gICAgICAgICAgICBmb3JtYXQ6IGN0cmwuZm9ybWF0LFxuICAgICAgICAgICAgbWludXRlczogY3RybC53aXRoTWludXRlc1BpY2tlcixcbiAgICAgICAgICAgIGN1cnJlbnREYXRlOiBjdHJsLm5nTW9kZWwsXG4gICAgICAgICAgICBhdXRvT2s6IGN0cmwuYXV0b09rLFxuICAgICAgICAgICAgY2FuY2VsVGV4dDogJ0NhbmNlbGFyJyxcbiAgICAgICAgICAgIHRvZGF5VGV4dDogJ0hvamUnLFxuICAgICAgICAgICAgdGltZTogY3RybC53aXRoVGltZSxcbiAgICAgICAgICAgIGRhdGU6IHRydWVcbiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChkYXRlKSB7XG4gICAgICAgICAgICBjdHJsLm5nTW9kZWwgPSBtb21lbnQoZGF0ZSkuZm9ybWF0KGN0cmwuZm9ybWF0KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XSxcbiAgICByZXF1aXJlOiB7XG4gICAgICBuZ01vZGVsQ3RybDogJ25nTW9kZWwnXG4gICAgfSxcbiAgICBiaW5kaW5nczoge1xuICAgICAgbGFiZWw6ICc9JyxcbiAgICAgIG1pbkRhdGU6ICc9JyxcbiAgICAgIG1heERhdGU6ICc9JyxcbiAgICAgIG5nTW9kZWw6ICc8JyxcbiAgICAgIGlkOiAnPCcsXG4gICAgICBpY29uQ29sb3I6ICc8JyxcbiAgICAgIHdpdGhUaW1lOiAnPCcsXG4gICAgICB3aXRoTWFzazogJzwnLFxuICAgICAgd2l0aE1pbnV0ZXNQaWNrZXI6ICc8JyxcbiAgICAgIGNsaWNrVG9TaG93SW5GaWVsZDogJzwnLFxuICAgICAgYXV0b09rOiAnPCcsXG4gICAgICBmb3JtYXQ6ICc8JyxcbiAgICAgIGZsZXg6ICc8JyxcbiAgICAgIG1hc2s6ICc8J1xuICAgIH1cbiAgfSk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGRpYWxvZ1NlcnZpY2UuJGluamVjdCA9IFtcIiRsb2dcIiwgXCIkbWREaWFsb2dcIiwgXCIkbWRVdGlsXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRhbmltYXRlXCIsIFwiJGRvY3VtZW50XCJdO1xuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5mYWN0b3J5KCdQckRpYWxvZycsIGRpYWxvZ1NlcnZpY2UpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gZGlhbG9nU2VydmljZSgkbG9nLCAkbWREaWFsb2csICRtZFV0aWwsICRyb290U2NvcGUsICRhbmltYXRlLCAkZG9jdW1lbnQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY3VzdG9tOiBjdXN0b20sXG4gICAgICBjb25maXJtOiBjb25maXJtLFxuICAgICAgY2xvc2U6IGNsb3NlLFxuICAgICAgYWxlcnQ6IGFsZXJ0XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcXVlIGNvbmZpZ3VyYSBlIHJlYWxpemEgbyBtZXJnZSBkbyBvYmpldG8gcmVjZWJpZG8gdmlhIHBhcsOibWV0cm9cbiAgICAgKiBjb20gYSBjb25maWd1cmHDp8OjbyBwYWRyw6NvIHBhcmEgYSBleGliacOnw6NvIGRvIGRpYWxvZ1xuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWcgLSBPYmpldG8gY29udGVuZG8gYXMgY29uZmlndXJhw6fDtWVzXG4gICAgICogQHJldHVybnMge2RpYWxvZ1NlcnZpY2V9IC0gUmV0b3JuYSBvIHNlcnZpY2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBidWlsZChjb25maWcpIHtcblxuICAgICAgaWYgKCFhbmd1bGFyLmlzT2JqZWN0KGNvbmZpZykpIHtcbiAgICAgICAgJGxvZy5lcnJvcignUHJEaWFsb2c6IFBhcsOibWV0cm8gaW52w6FsaWRvLCDDqSBlc3BlcmFuZG8gdW0gb2JqZXRvIGNvbW8gcGFyw6JtZXRyby4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgICAgIGhhc0JhY2tkcm9wOiBmYWxzZSxcbiAgICAgICAgZXNjYXBlVG9DbG9zZTogZmFsc2UsXG4gICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgIGF1dG9XcmFwOiB0cnVlLFxuICAgICAgICBza2lwSGlkZTogdHJ1ZSxcbiAgICAgICAgbG9jYWxzOiB7fSxcbiAgICAgICAgekluZGV4OiA3NSxcbiAgICAgICAgZnVsbHNjcmVlbjogZmFsc2VcbiAgICAgIH07XG5cbiAgICAgIC8vbsOjbyBmYXplbW9zIG1lcmdlIGRhIHByb3ByaWVkYWRlIGxvY2FscyBwYXJhIG7Do28gZXN0b3VyYXIgbyBsaW1pdGUgZGUgcmVjdXJzaXZpZGFkZVxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGNvbmZpZy5sb2NhbHMpKSB7XG4gICAgICAgIGRlZmF1bHRPcHRpb25zLmxvY2FscyA9IGNvbmZpZy5sb2NhbHM7XG4gICAgICAgIGRlbGV0ZSBjb25maWcubG9jYWxzO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYW5ndWxhci5tZXJnZShkZWZhdWx0T3B0aW9ucywgY29uZmlnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBleGliZSBvIGRpYWxvZyBkZSBjb25maXJtYcOnw6NvIG5hIHRlbGEgZGVwb2lzIHF1ZSBvIGJ1aWxkIGUgaW52b2NhZG9cbiAgICAgKiBkZSB1bWEgZGV0ZXJtaW5hZGEgYcOnw6NvXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFsZXJ0KGNvbmZpZykge1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IGJ1aWxkKGNvbmZpZyk7XG5cbiAgICAgIG9wdGlvbnMubG9jYWxzID0ge1xuICAgICAgICB0aXRsZTogYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy50aXRsZSkgPyBvcHRpb25zLnRpdGxlIDogJ0V4Y2VwdGlvbicsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBhbmd1bGFyLmlzRGVmaW5lZChvcHRpb25zLmRlc2NyaXB0aW9uKSA/IG9wdGlvbnMuZGVzY3JpcHRpb24gOiAnJyxcbiAgICAgICAgb2tCZ0NvbG9yOiBhbmd1bGFyLmlzRGVmaW5lZChvcHRpb25zLm9rQmdDb2xvcikgPyBvcHRpb25zLm9rQmdDb2xvciA6ICdyZWQtQTcwMCcsXG4gICAgICAgIHRvb2xiYXJCZ0NvbG9yOiBhbmd1bGFyLmlzRGVmaW5lZChvcHRpb25zLnRvb2xiYXJCZ0NvbG9yKSA/IG9wdGlvbnMudG9vbGJhckJnQ29sb3IgOiAncmVkLUE3MDAnXG4gICAgICB9O1xuXG4gICAgICBvcHRpb25zLnRlbXBsYXRlID0gJyA8bWQtZGlhbG9nIGZsZXg9NTAgYXJpYS1sYWJlbD1cIicgKyBvcHRpb25zLmxvY2Fscy50aXRsZSArICdcIj5cXG4gICAgICAgICAgICAgIDxtZC10b29sYmFyIG1kLXNjcm9sbC1zaHJpbmsgbWQtY29sb3JzPVwiOjp7YmFja2dyb3VuZDpcXCdkZWZhdWx0LXt7Y3RybC50b29sYmFyQmdDb2xvcn19XFwnfVwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdG9vbGJhci10b29sc1wiPlxcbiAgICAgICAgICAgICAgICAgIDxoMz5cXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuPicgKyBvcHRpb25zLmxvY2Fscy50aXRsZSArICc8L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgPC9oMz5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICA8L21kLXRvb2xiYXI+XFxuICAgICAgICAgICAgICA8bWQtZGlhbG9nLWNvbnRlbnQgbGF5b3V0LW1hcmdpbj5cXG4gICAgICAgICAgICAgICAgPHA+JyArIG9wdGlvbnMubG9jYWxzLmRlc2NyaXB0aW9uICsgJzwvcD5cXG4gICAgICAgICAgICAgIDwvbWQtZGlhbG9nLWNvbnRlbnQ+XFxuICAgICAgICAgICAgICA8bWQtZGlhbG9nLWFjdGlvbnM+XFxuICAgICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxcbiAgICAgICAgICAgICAgICAgIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6XFwnZGVmYXVsdC17e2N0cmwub2tCZ0NvbG9yfX1cXCd9XCJcXG4gICAgICAgICAgICAgICAgICBuZy1jbGljaz1cImN0cmwub2tBY3Rpb24oKVwiPk9rPC9tZC1idXR0b24+XFxuICAgICAgICAgICAgICA8L21kLWRpYWxvZy1hY3Rpb25zPlxcbiAgICAgICAgICAgIDwvbWQtZGlhbG9nPlxcbiAgICAgICAgICAnO1xuXG4gICAgICBvcHRpb25zLmNvbnRyb2xsZXIgPSBbJyRtZERpYWxvZycsIGZ1bmN0aW9uICgkbWREaWFsb2cpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5va0FjdGlvbiA9IG9rQWN0aW9uO1xuXG4gICAgICAgIGZ1bmN0aW9uIG9rQWN0aW9uKCkge1xuICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgIH1dO1xuXG4gICAgICBvcHRpb25zLmNvbnRyb2xsZXJBcyA9ICdjdHJsJztcbiAgICAgIG9wdGlvbnMuY2xpY2tPdXRzaWRlVG9DbG9zZSA9IGZhbHNlO1xuICAgICAgb3B0aW9ucy5oYXNCYWNrZHJvcCA9IHRydWU7XG5cbiAgICAgIHJldHVybiAkbWREaWFsb2cuc2hvdyhvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBleGliZSBvIGRpYWxvZyBkZSBjb25maXJtYcOnw6NvIG5hIHRlbGEgZGVwb2lzIHF1ZSBvIGJ1aWxkIGUgaW52b2NhZG9cbiAgICAgKiBkZSB1bWEgZGV0ZXJtaW5hZGEgYcOnw6NvXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpcm0oY29uZmlnKSB7XG5cbiAgICAgIHZhciBvcHRpb25zID0gYnVpbGQoY29uZmlnKTtcblxuICAgICAgb3B0aW9ucy50ZW1wbGF0ZSA9ICcgPG1kLWRpYWxvZyBmbGV4PTUwIGFyaWEtbGFiZWw9XCJ7ezo6Y3RybC50aXRsZX19XCI+XFxuICAgICAgICAgICAgICA8bWQtdG9vbGJhciBtZC1zY3JvbGwtc2hyaW5rPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdG9vbGJhci10b29sc1wiPlxcbiAgICAgICAgICAgICAgICAgIDxoMz5cXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuPnt7OjpjdHJsLnRpdGxlfX08L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgPC9oMz5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICA8L21kLXRvb2xiYXI+XFxuICAgICAgICAgICAgICA8bWQtZGlhbG9nLWNvbnRlbnQgbGF5b3V0LW1hcmdpbj5cXG4gICAgICAgICAgICAgICAgPHA+e3s6OmN0cmwuZGVzY3JpcHRpb259fTwvcD5cXG4gICAgICAgICAgICAgIDwvbWQtZGlhbG9nLWNvbnRlbnQ+XFxuICAgICAgICAgICAgICA8bWQtZGlhbG9nLWFjdGlvbnM+XFxuICAgICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxcbiAgICAgICAgICAgICAgICAgIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6XFwnZGVmYXVsdC17e2N0cmwueWVzQmdDb2xvcn19XFwnfVwiXFxuICAgICAgICAgICAgICAgICAgbmctY2xpY2s9XCJjdHJsLnllc0FjdGlvbigpXCI+U2ltPC9tZC1idXR0b24+XFxuICAgICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxcbiAgICAgICAgICAgICAgICAgIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6XFwnZGVmYXVsdC17e2N0cmwubm9CZ0NvbG9yfX1cXCd9XCJcXG4gICAgICAgICAgICAgICAgICBuZy1jbGljaz1cImN0cmwubm9BY3Rpb24oKVwiPk5cXHhFM288L21kLWJ1dHRvbj5cXG4gICAgICAgICAgICAgIDwvbWQtZGlhbG9nLWFjdGlvbnM+XFxuICAgICAgICAgICAgPC9tZC1kaWFsb2c+XFxuICAgICAgICAgICc7XG4gICAgICBvcHRpb25zLmxvY2FscyA9IHtcbiAgICAgICAgdGl0bGU6IGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMudGl0bGUpID8gb3B0aW9ucy50aXRsZSA6ICcnLFxuICAgICAgICBkZXNjcmlwdGlvbjogYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy5kZXNjcmlwdGlvbikgPyBvcHRpb25zLmRlc2NyaXB0aW9uIDogJycsXG4gICAgICAgIHllc0JnQ29sb3I6IGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMueWVzQmdDb2xvcikgPyBvcHRpb25zLnllc0JnQ29sb3IgOiAncHJpbWFyeScsXG4gICAgICAgIG5vQmdDb2xvcjogYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy5ub0JnQ29sb3IpID8gb3B0aW9ucy5ub0JnQ29sb3IgOiAnYWNjZW50J1xuICAgICAgfTtcblxuICAgICAgb3B0aW9ucy5jb250cm9sbGVyID0gWyckbWREaWFsb2cnLCBmdW5jdGlvbiAoJG1kRGlhbG9nKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0ubm9BY3Rpb24gPSBub0FjdGlvbjtcbiAgICAgICAgdm0ueWVzQWN0aW9uID0geWVzQWN0aW9uO1xuXG4gICAgICAgIGZ1bmN0aW9uIG5vQWN0aW9uKCkge1xuICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB5ZXNBY3Rpb24oKSB7XG4gICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgfV07XG5cbiAgICAgIG9wdGlvbnMuY29udHJvbGxlckFzID0gJ2N0cmwnO1xuICAgICAgb3B0aW9ucy5jbGlja091dHNpZGVUb0Nsb3NlID0gZmFsc2U7XG4gICAgICBvcHRpb25zLmhhc0JhY2tkcm9wID0gdHJ1ZTtcblxuICAgICAgcmV0dXJuICRtZERpYWxvZy5zaG93KG9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcXVlIGV4aWJlIG8gZGlhbG9nIGN1c3RvbWl6YWRvIG5hIHRlbGEgZGVwb2lzIHF1ZSBvIGJ1aWxkIGUgaW52b2NhZG9cbiAgICAgKiBAcmV0dXJucyB7cHJvbWlzc2V9IC0gUmV0b3JuYSB1bWEgcHJvbWlzc2UgcXVlIHBvZGUgb3UgbsOjbyBzZXIgcmVzb2x2aWRhXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3VzdG9tKGNvbmZpZykge1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IGJ1aWxkKGNvbmZpZyk7XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKG9wdGlvbnMudGVtcGxhdGVVcmwpICYmIGFuZ3VsYXIuaXNVbmRlZmluZWQob3B0aW9ucy50ZW1wbGF0ZSkpIHtcbiAgICAgICAgJGxvZy5lcnJvcignUHJEaWFsb2c6IHRlbXBsYXRlVXJsIG91IHRlbXBsYXRlIGluZGVmaW5pZG8sIMOpIGVzcGVyYW5kbyB1bSB0ZW1wbGF0ZVVybCBvdSB1bSB0ZW1wbGF0ZSBjb21vIGF0cmlidXRvLicpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vQ3JpYWRvIG8gYmFja2Ryb3AgbWFudWFsbWVudGUgcGFyYSBkaW1pbnVpciBvIHotaW5kZXggYXRyYXbDqXMgZGUgdW1hIGNsYXNzZSBjc3NcbiAgICAgIC8vbyB6LWluZGV4IHRlbSBxdWUgZmljYXIgbWVub3IgZGV2aWRvIGFvIGRpYWxvZy5jb25maXJtIHVzYXIgbyB6LWluZGV4IG9yaWdpbmFsIGRlIDgwXG4gICAgICBvcHRpb25zID0gYWRkQmFja2Ryb3Aob3B0aW9ucyk7XG5cbiAgICAgIG9wdGlvbnMuaGFzQmFja2Ryb3AgPSBmYWxzZTtcblxuICAgICAgcmV0dXJuICRtZERpYWxvZy5zaG93KG9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcXVlIGNyaWEgbyBiYWNrZHJvcCBlIG1vc3RyYSBuYSB0ZWxhIGNvbSBvIHotaW5kZXggY29uZmlndXJhdsOpbFxuICAgICAqIHBhcmEgc29icmVwb3Igb3MgZWxlbWVudG9zIGRhIHRlbGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZGRCYWNrZHJvcChvcHRpb25zKSB7XG4gICAgICBpZiAob3B0aW9ucy5oYXNCYWNrZHJvcCkge1xuICAgICAgICB2YXIgYmFja2Ryb3AgPSAkbWRVdGlsLmNyZWF0ZUJhY2tkcm9wKCRyb290U2NvcGUsICdtZC1kaWFsb2ctYmFja2Ryb3AgbWQtb3BhcXVlIG1kLWJhY2tkcm9wLWN1c3RvbScpO1xuXG4gICAgICAgICRhbmltYXRlLmVudGVyKGJhY2tkcm9wLCBhbmd1bGFyLmVsZW1lbnQoJGRvY3VtZW50LmZpbmQoJ2JvZHknKSkpO1xuXG4gICAgICAgIHZhciBvcmlnaW5hbE9uUmVtb3ZpbmcgPSBvcHRpb25zLm9uUmVtb3Zpbmc7XG5cbiAgICAgICAgLy9Nw6l0b2RvIGV4ZWN1dGFkbyBxdWFuZG8gYSBhbmltYcOnw6NvIGRlIGZlY2hhbWVudG8gZG8gZGlhbG9nIHRlcm1pbmFcbiAgICAgICAgb3B0aW9ucy5vblJlbW92aW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGJhY2tkcm9wLnJlbW92ZSgpO1xuICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24ob3JpZ2luYWxPblJlbW92aW5nKSkgb3JpZ2luYWxPblJlbW92aW5nLmNhbGwoKTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgb3JpZ2luYWxPbkNvbXBsZXRlID0gb3B0aW9ucy5vbkNvbXBsZXRlO1xuXG4gICAgICAgIC8vTcOpdG9kbyBleGVjdXRhZG8gcXVhbmRvIGEgYW5pbWHDp8OjbyBkZSBhYmVydHVyYSBkbyBkaWFsb2cgdGVybWluYVxuICAgICAgICBvcHRpb25zLm9uQ29tcGxldGUgPSBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgICAgICB2YXIgekluZGV4ID0gcGFyc2VJbnQob3B0aW9ucy56SW5kZXgsIDEwKTtcblxuICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgkZG9jdW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLWJhY2tkcm9wLWN1c3RvbScpKS5jc3MoJ3otaW5kZXgnLCB6SW5kZXgpO1xuICAgICAgICAgIGVsZW1lbnQuY3NzKCd6LWluZGV4JywgekluZGV4ICsgMSk7XG4gICAgICAgICAgaWYgKGFuZ3VsYXIuaXNGdW5jdGlvbihvcmlnaW5hbE9uQ29tcGxldGUpKSBvcmlnaW5hbE9uQ29tcGxldGUuY2FsbCgpO1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gb3B0aW9ucztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBzZXJ2ZSBwYXJhIGZlY2hhciBvIGRpYWxvZ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICB9XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgUHJGaWxlLiRpbmplY3QgPSBbXCJhbGFzcWxcIiwgXCJsb2Rhc2hcIiwgXCIkZmlsdGVyXCJdO1xuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5mYWN0b3J5KCdQckZpbGUnLCBQckZpbGUpO1xuXG4gIC8qKlxuICAgKiBTZXJ2aWNlIHF1ZSBlbmNhcHN1bGEgb3Mgc2VydmnDp29zXG4gICAqIGRlIGV4cG9ydGHDp8OjbyBlIGltcG9ydGHDp8OjbyBkZSBhcnF1aXZvc1xuICAgKi9cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBQckZpbGUoYWxhc3FsLCBsb2Rhc2gsICRmaWx0ZXIpIHtcbiAgICB2YXIgb2JqID0ge1xuICAgICAgZXhwb3J0VG9FeGNlbDogZXhwb3J0VG9FeGNlbCxcbiAgICAgIGV4cG9ydFRvQ1NWOiBleHBvcnRUb0NTVlxuICAgIH07XG5cbiAgICAvL0RlZmluZWQgZmlsdGVyc1xuXG4gICAgYWxhc3FsLmZuLmZvcm1hdERhdGUgPSBmdW5jdGlvbiAoZGF0ZSwgZm9ybWF0KSB7XG4gICAgICByZXR1cm4gJGZpbHRlcigncHJEYXRlJykoZGF0ZSwgZm9ybWF0KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRXhwb3J0YSBvcyBkYWRvcyBlbnZpYWRvcyBwYXJhIG8gZm9ybWF0byBpbmZvcm1hZG8uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xhcnJheX0gZmllbGRzXG4gICAgICogIFN0cmluZyBjb250ZW5kbyBvcyBjYW1wb3Mgc2VwYXJhZG8gcG9yIHZpcmd1bGFcbiAgICAgKiAgICBleDogbmFtZSwgZGVzY3JpcHRpb25cbiAgICAgKiAgICBleDogbmFtZSBhcyBOb21lLCBkZXNjcmlwdGlvbiBhcyAnRGVzY3Jpw6fDo28nXG4gICAgICogICAgZXg6ICogIChwYXJhIHRvZG9zIG9zIGNhbXBvcylcbiAgICAgKiAgQXJyYXkgZGUgb2JqZXRvcyBjb20gb3MgY2FtcG9zXG4gICAgICogICAgZXg6IFtcbiAgICAgKiAgICAgIHsgbmFtZTogJ25hbWUnLCBsYWJlbDogJ05vbWUnIH0sXG4gICAgICogICAgICB7IG5hbWU6ICdkZXNjcmlwdGlvbicsIGxhYmVsOiAnRGVzY3Jpw6fDo28nIH0sXG4gICAgICogICAgICB7IG5hbWU6ICdyb2xlLm5hbWUnLCBsYWJlbDogJ1BlcmZpbCcgfSxcbiAgICAgKiAgICAgIHsgbmFtZTogJ2Zvcm1hdERhdGUoZGF0ZSknLCBsYWJlbDogJ0RhdGEnIH0sKlxuICAgICAqICAgIF1cbiAgICAgKiBAcGFyYW0ge2FycmF5fSBkYXRhIC0gQXJyYXkgcXVlIHZhaSBzZXJ2aXIgY29tbyBmb250ZSBkZSBkYWRvc1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlTmFtZSAtIE5vbWUgZG8gYXJxdWl2byBzZW0gYSBleHRlbnPDo29cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gY29uZmlnXG4gICAgICogQ29uZmlndXJhw6fDtWVzIGRhIGRvY3VtZW50YcOnw6NvIGRvIGFsYXNxbCBjb21vOlxuICAgICAqICAtIChib29sZWFuKSBoZWFkZXJzXG4gICAgICogbWFpcyBhcyBkZXN0YWNhZGFzIGFiYWl4b1xuICAgICAqICAtIChzdHJpbmcpIHdoZXJlXG4gICAgICogIC0gKHN0cmluZykgb3JkZXJCeVxuICAgICAqXG4gICAgICogZmlsdGVycyBkZWZpbmlkb3NcbiAgICAgKlxuICAgICAqIGZvcm1hdERhdGUoY2FtcG8sIFtmb3JtYXRvXSlcbiAgICAgKlxuICAgICAqIEV4ZW1wbG86XG4gICAgICpcbiAgICAgKiB2YXIgY2FycyA9IFtcbiAgICAgKiAgeyBuYW1lOiAnU3RpbG8nLCAgYnJhbmQ6ICdGaWF0JywgZGF0ZTogbW9tZW50KCkuc3VidHJhY3QoMSwgJ3llYXJzJykgfSxcbiAgICAgKiAgeyBuYW1lOiAnUHVudG8nLCAgYnJhbmQ6ICdGaWF0JywgZGF0ZTogbW9tZW50KCkuc3VidHJhY3QoMywgJ3llYXJzJykgfSxcbiAgICAgKiAgeyBuYW1lOiAnRmllc3RhJywgYnJhbmQ6ICdGb3JkJywgZGF0ZTogJzA0LTAxLTIwMTcnIH1cbiAgICAgKiBdXG4gICAgICpcbiAgICAgKiBQckZpbGUuZXhwb3J0VG9FeGNlbChbXG4gICAgICogIHsgbmFtZTogJ2JyYW5kJywgbGFiZWw6ICdNYXJjYScgfSxcbiAgICAgKiAgeyBuYW1lOiAnbmFtZScsIGxhYmVsOiAnTm9tZScgfSxcbiAgICAgKiAgeyBuYW1lOiAnZm9ybWF0RGF0ZShkYXRlLCBcXCdERC1NTS1ZWVlZXFwnKScsIGxhYmVsOiAnQ29tcHJhZG8gZW0/JyB9XG4gICAgICogXSwgY2FycywgJ2RhdGEtZXhwb3J0Jywge1xuICAgICAqICBvcmRlckJ5OiAnYnJhbmQgQVNDLCBuYW1lIEFTQycsXG4gICAgICogIHdoZXJlOiAnYnJhbmQgbGlrZSBcIiVGaSVcIidcbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtwcm9taXNzZX0gLSBSZXRvcm5hIHVtYSBwcm9taXNzZSBxdWUgcG9kZSBvdSBuw6NvIHNlciByZXNvbHZpZGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleHBvcnRUbyhmaWVsZHMsIGRhdGEsIGZpbGVOYW1lLCBjb25maWcpIHtcbiAgICAgIHZhciBkZWZhdWx0Q29uZmlnID0ge1xuICAgICAgICBoZWFkZXJzOiB0cnVlXG4gICAgICB9O1xuXG4gICAgICBpZiAoYW5ndWxhci5pc09iamVjdChjb25maWcpKSBhbmd1bGFyLm1lcmdlKGRlZmF1bHRDb25maWcsIGNvbmZpZyk7XG4gICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChmaWxlTmFtZSkpIGZpbGVOYW1lID0gJ2V4cG9ydCc7XG5cbiAgICAgIGRlZmF1bHRDb25maWcud2hlcmUgPSBhbmd1bGFyLmlzRGVmaW5lZChkZWZhdWx0Q29uZmlnLndoZXJlKSA/ICcgV0hFUkUgJyArIGRlZmF1bHRDb25maWcud2hlcmUgOiAnICc7XG4gICAgICBkZWZhdWx0Q29uZmlnLm9yZGVyQnkgPSBhbmd1bGFyLmlzRGVmaW5lZChkZWZhdWx0Q29uZmlnLm9yZGVyQnkpID8gJyBPUkRFUiBCWSAnICsgZGVmYXVsdENvbmZpZy5vcmRlckJ5IDogJyAnO1xuXG4gICAgICBmaWxlTmFtZSA9IGZpbGVOYW1lICsgJy4nICsgZGVmYXVsdENvbmZpZy5mb3JtYXRUbztcblxuICAgICAgcmV0dXJuIGFsYXNxbC5wcm9taXNlKCdTRUxFQ1QgJyArIGJ1aWxkRmllbGRzKGZpZWxkcykgKyAnIElOVE8gJyArIGRlZmF1bHRDb25maWcuZm9ybWF0VG8udG9VcHBlckNhc2UoKSArICcoPywgPykgRlJPTSA/ICcgKyBkZWZhdWx0Q29uZmlnLndoZXJlICsgZGVmYXVsdENvbmZpZy5vcmRlckJ5LCBbZmlsZU5hbWUsIGRlZmF1bHRDb25maWcsIGRhdGFdKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnRhIG9zIGRhZG9zIGVudmlhZG9zIHBhcmEgY3N2XG4gICAgICpcbiAgICAgKiBAc2VlIGV4cG9ydFRvXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXhwb3J0VG9DU1YoZmllbGRzLCBkYXRhLCBmaWxlTmFtZSwgY29uZmlnKSB7XG4gICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChjb25maWcpKSBjb25maWcgPSB7fTtcblxuICAgICAgY29uZmlnLmZvcm1hdFRvID0gJ2Nzdic7XG5cbiAgICAgIHJldHVybiBleHBvcnRUbyhmaWVsZHMsIGRhdGEsIGZpbGVOYW1lLCBjb25maWcpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4cG9ydGEgb3MgZGFkb3MgZW52aWFkb3MgcGFyYSBleGNlbFxuICAgICAqXG4gICAgICogQHNlZSBleHBvcnRUb1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4cG9ydFRvRXhjZWwoZmllbGRzLCBkYXRhLCBmaWxlTmFtZSwgY29uZmlnKSB7XG4gICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChjb25maWcpKSBjb25maWcgPSB7fTtcblxuICAgICAgY29uZmlnLmZvcm1hdFRvID0gJ3hsc3gnO1xuXG4gICAgICByZXR1cm4gZXhwb3J0VG8oZmllbGRzLCBkYXRhLCBmaWxlTmFtZSwgY29uZmlnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNb250YSB1bWEgc3RyaW5nIGNvbnRlbmRvIG9zIGNhbXBvcyBwYXJhIG8gU0VMRUNUIGRhIFF1ZXJ5LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJ1aWxkRmllbGRzKGZpZWxkcykge1xuICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShmaWVsZHMpKSB7XG4gICAgICAgIGZpZWxkcyA9IGxvZGFzaC5tYXAoZmllbGRzLCBmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgICAgICByZXR1cm4gZmllbGQubmFtZSArICcgYXMgWycgKyBmaWVsZC5sYWJlbCArICddJztcbiAgICAgICAgfSkuam9pbignLCAnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZpZWxkcztcbiAgICB9XG5cbiAgICByZXR1cm4gb2JqO1xuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXG4gICd1c2Ugc3RyaWN0JztcblxuICBwckRhdGUuJGluamVjdCA9IFtcIm1vbWVudFwiXTtcbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmlsdGVyKCdwckRhdGUnLCBwckRhdGUpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gcHJEYXRlKG1vbWVudCkge1xuICAgIC8qKlxuICAgICAqIEZvcm1hdGEgdW1hIGRhdGEgbm8gcGFkcsOjbyBicmFzaWxlaXJvXG4gICAgICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSwgaW5wdXRGb3JtYXQpIHtcbiAgICAgIHZhciBvdXRwdXRGb3JtYXQgPSAnREQvTU0vWVlZWSc7XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChpbnB1dEZvcm1hdCkpIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh2YWx1ZSwgaW5wdXRGb3JtYXQpLmZvcm1hdChvdXRwdXRGb3JtYXQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh2YWx1ZSkuZm9ybWF0KG91dHB1dEZvcm1hdCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblxuICAndXNlIHN0cmljdCc7XG5cbiAgcHJEYXRldGltZS4kaW5qZWN0ID0gW1wibW9tZW50XCJdO1xuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5maWx0ZXIoJ3ByRGF0ZXRpbWUnLCBwckRhdGV0aW1lKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIHByRGF0ZXRpbWUobW9tZW50KSB7XG4gICAgLyoqXG4gICAgICogRm9ybWF0YSB1bWEgZGF0YSBjb20gaG9yw6FyaW8gbm8gcGFkcsOjbyBicmFzaWxlaXJvXG4gICAgICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIG1vbWVudCh2YWx1ZSkuZm9ybWF0KCdERC9NTS9ZWVlZIEhIOm1tJyk7XG4gICAgfTtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblxuICAndXNlIHN0cmljdCc7XG5cbiAgcmVhbC4kaW5qZWN0ID0gW1wiJGZpbHRlclwiXTtcbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmlsdGVyKCdyZWFsJywgcmVhbCk7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LXBhcmFtc1xuICBmdW5jdGlvbiByZWFsKCRmaWx0ZXIpIHtcbiAgICAvKipcbiAgICAgKiBGb3JtYXRhIHVtIHZhbG9yIHBhcmEgbyBwYWRyw6NvIGJyYXNpbGVpcm9cbiAgICAgKi9cbiAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICByZXR1cm4gJGZpbHRlcignY3VycmVuY3knKSh2YWx1ZSwgJ1IkICcpO1xuICAgIH07XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLyogZXNsaW50LWRpc2FibGUgbWF4LWxlbiAqL1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmNvbnN0YW50KCdQckljb25zJywgW3tcbiAgICBpZDogJ3ByLWV4Y2VsJyxcbiAgICB1cmw6ICdwci1leGNlbC5zdmcnLFxuICAgIHN2ZzogJzxzdmcgaGVpZ2h0PVwiMjRcIiB3aWR0aD1cIjI0XCIgc3R5bGU9XCJmaWxsOiMyRTdEMzJcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+PHBhdGggZD1cIk02LDJIMTRMMjAsOFYyMEEyLDIgMCAwLDEgMTgsMjJINkEyLDIgMCAwLDEgNCwyMFY0QTIsMiAwIDAsMSA2LDJNMTMsMy41VjlIMTguNUwxMywzLjVNMTcsMTFIMTNWMTNIMTRMMTIsMTQuNjdMMTAsMTNIMTFWMTFIN1YxM0g4TDExLDE1LjVMOCwxOEg3VjIwSDExVjE4SDEwTDEyLDE2LjMzTDE0LDE4SDEzVjIwSDE3VjE4SDE2TDEzLDE1LjVMMTYsMTNIMTdWMTFaXCIgLz48L3N2Zz4nXG4gIH1dKTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZGlyZWN0aXZlKCdwclBhZ2luYXRpb24nLCBwYWdpbmF0aW9uRGlyZWN0aXZlKTtcblxuICAvKipcbiAgICogRGlyZXRpdmEgcXVlIGV4aWJlIHVtYSBwYWdpbmHDp8Ojby5cbiAgICogQWRvdGEgbyBlc3RpbG8gZGUgcGFnaW5hw6fDo28gZGEgQnVzY2EgZG8gR29vZ2xlLlxuICAgKiBVdGlsaXphIG9zIGVzdGlsb3MgZG8gYm9vdHN0cmFwXG4gICAqL1xuICAvKiogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIHBhZ2luYXRpb25EaXJlY3RpdmUoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnQUUnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcGFnaW5hdG9yOiAnPSdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZTogJ1xcbiAgICAgICAgPHNlY3Rpb24gY2xhc3M9XCJwci1wYWdpbmF0aW9uXCIgbGF5b3V0PVwicm93XCI+XFxuICAgICAgICAgIDxzZWN0aW9uIGxheW91dD1cInJvd1wiIGxheW91dC1hbGlnbj1cImNlbnRlciBjZW50ZXJcIiBsYXlvdXQtd3JhcFxcbiAgICAgICAgICAgIHN0eWxlPVwibWFyZ2luLXJpZ2h0OiAxMHB4XCJcXG4gICAgICAgICAgICBuZy1zaG93PVwicGFnaW5hdG9yLm51bWJlck9mUGFnZXMgPiAxXCI+XFxuICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcXG4gICAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCJwYWdpbmF0b3IuY3VycmVudFBhZ2UgPT09IDFcIlxcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5nb1RvUGFnZSgxKVwiPnt7cGFnaW5hdG9yLm9wdGlvbnMubGFiZWxzLmZpcnN0fX08L21kLWJ1dHRvbj5cXG4gICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxcbiAgICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cInBhZ2luYXRvci5jdXJyZW50UGFnZSA9PT0gMVwiXFxuICAgICAgICAgICAgICAgIG5nLWNsaWNrPVwicGFnaW5hdG9yLnByZXZpb3VzUGFnZSgpXCI+e3twYWdpbmF0b3Iub3B0aW9ucy5sYWJlbHMucHJldmlvdXN9fTwvbWQtYnV0dG9uPlxcbiAgICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXFxuICAgICAgICAgICAgICAgIG5nLXJlcGVhdD1cIm4gaW4gcGFnaW5hdG9yLnBhZ2VzKHMpXCJcXG4gICAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7XFwnbWQtcHJpbWFyeVxcJzogbiA9PSBwYWdpbmF0b3IuY3VycmVudFBhZ2V9XCJcXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCJwYWdpbmF0b3IuZ29Ub1BhZ2UobilcIlxcbiAgICAgICAgICAgICAgICBuZy1iaW5kPVwiblwiPjE8L21kLWJ1dHRvbj5cXG4gICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcXG4gICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwicGFnaW5hdG9yLmN1cnJlbnRQYWdlID09IHBhZ2luYXRvci5udW1iZXJPZlBhZ2VzXCJcXG4gICAgICAgICAgICAgIG5nLWNsaWNrPVwicGFnaW5hdG9yLm5leHRQYWdlKClcIj57e3BhZ2luYXRvci5vcHRpb25zLmxhYmVscy5uZXh0fX08L21kLWJ1dHRvbj5cXG4gICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcXG4gICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwicGFnaW5hdG9yLmN1cnJlbnRQYWdlID09IHBhZ2luYXRvci5udW1iZXJPZlBhZ2VzXCJcXG4gICAgICAgICAgICAgIG5nLWNsaWNrPVwicGFnaW5hdG9yLmdvVG9QYWdlKHBhZ2luYXRvci5udW1iZXJPZlBhZ2VzKVwiPnt7cGFnaW5hdG9yLm9wdGlvbnMubGFiZWxzLmxhc3R9fTwvbWQtYnV0dG9uPlxcbiAgICAgICAgICA8L3NlY3Rpb24+XFxuICAgICAgICAgIDxzZWN0aW9uIGxheW91dD1cInJvd1wiIGxheW91dC1hbGlnbj1cImNlbnRlciBjZW50ZXJcIlxcbiAgICAgICAgICAgIG5nLXNob3c9XCJwYWdpbmF0b3IudG90YWwgPiAwXCI+XFxuICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiIHN0eWxlPVwiY3Vyc29yOiBkZWZhdWx0O1wiXFxuICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cInRydWVcIiBtZC1jb2xvcnM9XCI6OntiYWNrZ3JvdW5kOlxcJ2RlZmF1bHQtYWNjZW50XFwnfVwiPlRvdGFsOiB7e3BhZ2luYXRvci50b3RhbH19IHJlZ2lzdHJvKHMpPC9tZC1idXR0b24+XFxuICAgICAgICAgIDwvc2VjdGlvbj5cXG4gICAgICAgIDwvc2VjdGlvbj4nXG4gICAgfTtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5mYWN0b3J5KCdQclBhZ2luYXRpb24nLCBwYWdpbmF0aW9uU2VydmljZSk7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBwYWdpbmF0aW9uU2VydmljZSgpIHtcblxuICAgIC8qKlxuICAgICAqIENyaWEgZSByZXRvcm5hIHVtYSBpbnN0YW5jaWEgZG8gb2JqZXRvIHBhZ2luYWRvci5cbiAgICAgKlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHNlYXJjaE1ldGhvZCAtIGZ1bsOnw6NvIHJlc3BvbnPDoXZlbCBwb3IgY2FycmVnYXIgb3MgZGFkb3NcbiAgICAgICBlIHF1ZSB2YWkgc2VyIGNoYW1hZGEgcXVhbmRvIG8gdXN1w6FyaW8gY2xpY2FyIGVtIHVtYSBww6FnaW5hXG4gICAgICogQHBhcmFtIHtpbnR9IHBlclBhZ2UgLSBOw7ptZXJvIGRlIGl0ZW5zIHBvciBww6FnaW5hLiBQYWRyw6NvIMOpIDEwLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBfb3B0aW9ucyAtIE9iamV0byBjb250ZW5kbyBhcyBkZW1haXMgY29uZmlndXJhw6fDtWVzXG4gICAgICovXG4gICAgdmFyIFByUGFnaW5hY2FvID0gZnVuY3Rpb24gUHJQYWdpbmFjYW8oc2VhcmNoTWV0aG9kLCBwZXJQYWdlLCBfb3B0aW9ucykge1xuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIG1heFBhZ2VzOiAxMCxcbiAgICAgICAgbGFiZWxzOiB7XG4gICAgICAgICAgZmlyc3Q6ICfCq8KrJyxcbiAgICAgICAgICBwcmV2aW91czogJ8KrJyxcbiAgICAgICAgICBuZXh0OiAnwrsnLFxuICAgICAgICAgIGxhc3Q6ICfCu8K7J1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvL3NvYnJlZXNjcmV2ZSBvcyBwYXJhbWV0cm9zIHBhZHLDtWVzXG4gICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChwZXJQYWdlKSkge1xuICAgICAgICBwZXJQYWdlID0gMTA7XG4gICAgICB9XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChfb3B0aW9ucykpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKF9vcHRpb25zLm1heFBhZ2VzKSkge1xuICAgICAgICAgIG9wdGlvbnMubWF4UGFnZXMgPSBfb3B0aW9ucy5tYXhQYWdlcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoX29wdGlvbnMubGFiZWxzKSkge1xuICAgICAgICAgIG9wdGlvbnMubGFiZWxzID0gX29wdGlvbnMubGFiZWxzO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vY2FsY3VsYSBxdWFudGFzIHDDoWdpbmFzIHbDo28gc2VyIGV4aWJpZGFzIG5hIHBhcnRlIGludGVybWVkaWFyaWEgZGEgcGFnaW5hw6fDo29cbiAgICAgIG9wdGlvbnMubWF4UGFnZXNJbm5lciA9IE1hdGguZmxvb3Iob3B0aW9ucy5tYXhQYWdlcyAvIDIpO1xuXG4gICAgICAvL0NyaWEgbyBvYmpldG8gcGFnaW5hZG9yIGNvbSBvcyBwYXJhbWV0cm9zIGluaWNpYWlzXG4gICAgICB0aGlzLnNlYXJjaE1ldGhvZCA9IHNlYXJjaE1ldGhvZDtcbiAgICAgIHRoaXMubnVtYmVyT2ZQYWdlcyA9IDE7XG4gICAgICB0aGlzLnRvdGFsID0gMDtcbiAgICAgIHRoaXMucGVyUGFnZSA9IHBlclBhZ2U7XG4gICAgICB0aGlzLmN1cnJlbnRQYWdlID0gMDtcbiAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENhbGN1bGEgbyBuw7ptZXJvIGRlIHDDoWdpbmFzIHF1ZSB2YWkgc2VyIGV4aWJpZGEgYmFzZWFkbyBubyB0b3RhbCBkZVxuICAgICAqIGl0ZW5zIGNvbSBhIHBlclBhZ2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW50fSB0b3RhbCAtIHRvdGFsIGRlIGl0ZW5zXG4gICAgICovXG4gICAgUHJQYWdpbmFjYW8ucHJvdG90eXBlLmNhbGNOdW1iZXJPZlBhZ2VzID0gZnVuY3Rpb24gKHRvdGFsKSB7XG4gICAgICB0aGlzLnRvdGFsID0gdG90YWw7XG5cbiAgICAgIGlmICh0b3RhbCA8PSAwKSB7XG4gICAgICAgIHRoaXMubnVtYmVyT2ZQYWdlcyA9IDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm51bWJlck9mUGFnZXMgPSBNYXRoLmZsb29yKHRvdGFsIC8gdGhpcy5wZXJQYWdlKSArICh0b3RhbCAlIHRoaXMucGVyUGFnZSA+IDAgPyAxIDogMCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFZlcmlmaWNhIGFzIHDDoWdpbmFzIHF1ZSBkZXZlbSBzZXIgZXhpYmlkYXNcbiAgICAgKi9cbiAgICBQclBhZ2luYWNhby5wcm90b3R5cGUucGFnZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgcmV0ID0gW107XG5cbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IHRoaXMubnVtYmVyT2ZQYWdlczsgaSsrKSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlID09PSBpKSB7XG4gICAgICAgICAgcmV0LnB1c2goaSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPD0gdGhpcy5vcHRpb25zLm1heFBhZ2VzSW5uZXIgKyAxKSB7XG4gICAgICAgICAgICBpZiAoaSA8PSB0aGlzLm9wdGlvbnMubWF4UGFnZXMpIHtcbiAgICAgICAgICAgICAgcmV0LnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpID49IHRoaXMuY3VycmVudFBhZ2UgLSB0aGlzLm9wdGlvbnMubWF4UGFnZXNJbm5lciAmJiBpIDw9IHRoaXMuY3VycmVudFBhZ2UgKyB0aGlzLm9wdGlvbnMubWF4UGFnZXNJbm5lcikge1xuICAgICAgICAgICAgICByZXQucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXQ7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENhcnJlZ2Egb3MgZGFkb3MgZGEgcMOhZ2luYSBhbnRlcmlvclxuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5wcmV2aW91c1BhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA+IDEpIHtcbiAgICAgICAgdGhpcy5zZWFyY2hNZXRob2QodGhpcy5jdXJyZW50UGFnZSAtIDEpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDYXJyZWdhIG9zIGRhZG9zIGRhIHByw7N4aW1hIHDDoWdpbmFcbiAgICAgKi9cbiAgICBQclBhZ2luYWNhby5wcm90b3R5cGUubmV4dFBhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA8IHRoaXMubnVtYmVyT2ZQYWdlcykge1xuICAgICAgICB0aGlzLnNlYXJjaE1ldGhvZCh0aGlzLmN1cnJlbnRQYWdlICsgMSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENhcnJlZ2Egb3MgZGFkb3MgZGEgcMOhZ2luYSBpbmZvcm1hZGFcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW50fSBwYWdlIC0gcGFnaW5hIHF1ZSBkZXZlIHNlciBjYXJyZWdhZGFcbiAgICAgKi9cbiAgICBQclBhZ2luYWNhby5wcm90b3R5cGUuZ29Ub1BhZ2UgPSBmdW5jdGlvbiAocGFnZSkge1xuICAgICAgaWYgKHBhZ2UgPj0gMSAmJiBwYWdlIDw9IHRoaXMubnVtYmVyT2ZQYWdlcykge1xuICAgICAgICB0aGlzLnNlYXJjaE1ldGhvZChwYWdlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGdldEluc3RhbmNlOiBmdW5jdGlvbiBnZXRJbnN0YW5jZShzZWFyY2hNZXRob2QsIHBlclBhZ2UsIF9vcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJQYWdpbmFjYW8oc2VhcmNoTWV0aG9kLCBwZXJQYWdlLCBfb3B0aW9ucyk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICogRGlyZXRpdmEgcXVlIGV4aWJlIHVtIHNwaW5uZXIgc2VtcHJlIHF1ZSB1bSBicm9hZGNhc3QsIG1hbnVhbG1lbnRlLCDDqSBkaXNwYXJhZG9cbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5jb21wb25lbnQoJ3ByU3Bpbm5lcicsIHtcbiAgICB0ZW1wbGF0ZTogJ1xcbiAgICAgICAgPG1kLXByb2dyZXNzLWxpbmVhciBjbGFzcz1cInNwaW4tbGFiZWwtY29tcG9uZW50IHt7OjokY3RybC5jb2xvcn19XCJcXG4gICAgICAgICAgbmctc3R5bGU9XCIkY3RybC5zdHlsZVwiXFxuICAgICAgICAgIG1kLW1vZGU9XCJpbmRldGVybWluYXRlXCJcXG4gICAgICAgICAgbmctc2hvdz1cIiRjdHJsLnNwaW5uZXIgJiYgJGN0cmwuc3Bpbm5lci5zaG93XCI+PC9tZC1wcm9ncmVzcy1saW5lYXI+XFxuICAgICAgICAnLFxuICAgIGJpbmRpbmdzOiB7XG4gICAgICBwb3NpdGlvbjogJ0AnLFxuICAgICAgY29sb3I6ICdAJ1xuICAgIH0sXG4gICAgY29udHJvbGxlcjogWyckc2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlKSB7XG4gICAgICB2YXIgY3RybCA9IHRoaXM7XG5cbiAgICAgIGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9EZWZpbmUgYSBwb3Npw6fDo29cbiAgICAgICAgY3RybC5zdHlsZSA9IHsgcG9zaXRpb246IGFuZ3VsYXIuaXNEZWZpbmVkKGN0cmwucG9zaXRpb24pID8gY3RybC5wb3NpdGlvbiA6ICdmaXhlZCcgfTtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoY3RybC5jb2xvcikpIGN0cmwuY29sb3IgPSAnbWQtcHJpbWFyeSc7XG4gICAgICB9O1xuICAgICAgLy9jb21wb3J0YW1lbnRvIHBhZHLDo29cbiAgICAgIGN0cmwuc3Bpbm5lciA9IHtcbiAgICAgICAgc2hvdzogZmFsc2VcbiAgICAgIH07XG5cbiAgICAgIC8vRXNjdXRhIG8gY2FuYWwgZW1pdGlkbyB2aWEgYnJvYWRjYXN0XG4gICAgICAvL3BhcmEgZXhpYmlyL2VzY29uZGVyIG8gY29tcG9uZW50ZVxuICAgICAgJHNjb3BlLiRvbignc2hvdy1zcGlubmVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBjdHJsLnNwaW5uZXIgPSB7XG4gICAgICAgICAgc2hvdzogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgICRzY29wZS4kb24oJ2hpZGUtc3Bpbm5lcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY3RybC5zcGlubmVyID0ge1xuICAgICAgICAgIHNob3c6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9XVxuICB9KTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBzcGlubmVyU2VydmljZS4kaW5qZWN0ID0gW1wiJHJvb3RTY29wZVwiXTtcbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmFjdG9yeSgnUHJTcGlubmVyJywgc3Bpbm5lclNlcnZpY2UpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gc3Bpbm5lclNlcnZpY2UoJHJvb3RTY29wZSkge1xuICAgIHJldHVybiB7XG4gICAgICBzaG93OiBzaG93LFxuICAgICAgaGlkZTogaGlkZVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBFeGliZSBvIHNwaW5uZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzaG93KCkge1xuICAgICAgLy9lbWl0ZSBvIHNpbmFsIHBhcmEgYSBkaXJldGl2YSBpbmZvcm1hbmRvIHF1ZSBvIGNvbXBvbmVudGUgc3Bpbm5lciBkZXZlIHNlciBleGliaWRvXG4gICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3Nob3ctc3Bpbm5lcicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVzY29uZGUgbyBzcGlubmVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gaGlkZSgpIHtcbiAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnaGlkZS1zcGlubmVyJyk7XG4gICAgfVxuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIFRvYXN0LiRpbmplY3QgPSBbXCIkbWRUb2FzdFwiLCBcImxvZGFzaFwiLCBcIiRsb2dcIiwgXCJQckRpYWxvZ1wiXTtcbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmFjdG9yeSgnUHJUb2FzdCcsIFRvYXN0KTtcblxuICAvKipcbiAgICogU2VydmnDp28gcXVlIGVuY2Fwc3VsYSBlIGFtcGxpYSBvcyBzZXJ2acOnb3MgZG8gYW5ndWxhciB0b2FzdHJcbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gVG9hc3QoJG1kVG9hc3QsIGxvZGFzaCwgJGxvZywgUHJEaWFsb2cpIHtcbiAgICB2YXIgb2JqID0ge1xuICAgICAgc3VjY2Vzczogc3VjY2VzcyxcbiAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgIGVycm9yVmFsaWRhdGlvbjogZXJyb3JWYWxpZGF0aW9uLFxuICAgICAgaW5mbzogaW5mbyxcbiAgICAgIHdhcm46IHdhcm4sXG4gICAgICBoaWRlOiBoaWRlXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEV4aWJlIHVtYSBub3RpZmljYcOnw6NvXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbXNnIC0gTWVuc2FnZW0gZGEgbm90aWZpY2HDp8Ojb1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjb2xvciAtIENvciBkZSBmdW5kbyBkYSBub3RpZmljYcOnw6NvXG4gICAgICpcbiAgICAgIEByZXR1cm5zIHtwcm9taXNzZX0gLSBSZXRvcm5hIHVtYSBwcm9taXNzZSBxdWUgcG9kZSBvdSBuw6NvIHNlciByZXNvbHZpZGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0b2FzdChtc2csIGNvbG9yLCBvcHRpb25zKSB7XG4gICAgICBpZiAobXNnKSB7XG4gICAgICAgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAgICAgICB0ZW1wbGF0ZTogJ1xcbiAgICAgICAgICAgIDxtZC10b2FzdD5cXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC10b2FzdC1jb250ZW50XCIgbWQtY29sb3JzPVwiOjp7YmFja2dyb3VuZDpcXCcnICsgY29sb3IgKyAnXFwnfVwiPlxcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1kLXRvYXN0LXRleHRcIiBmbGV4PicgKyBtc2cgKyAnPC9zcGFuPlxcbiAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9tZC10b2FzdD5cXG4gICAgICAgICAgJyxcbiAgICAgICAgICBwb3NpdGlvbjogJ3RvcCByaWdodCdcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoYW5ndWxhci5pc09iamVjdChvcHRpb25zKSkgZGVmYXVsdE9wdGlvbnMgPSBhbmd1bGFyLm1lcmdlKGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuICAgICAgICByZXR1cm4gJG1kVG9hc3Quc2hvdyhkZWZhdWx0T3B0aW9ucyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkbG9nLmRlYnVnKCdNZW5zYWdlbSBwYXJhIHNlciBleGliaWRhIG5vIFRvYXN0IG7Do28gZm9pIGluZm9ybWFkYScpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVzY29uZGUgdW1hIG5vdGlmaWNhw6fDo29cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvYmplY3QgLSBVbSBhcmd1bWVudG8gb3BjaW9uYWwgcGFyYSBhIHByb21pc2UgYSBzZXIgcmVzb2x2aWRhXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7cHJvbWlzc2V9IC0gUmV0b3JuYSB1bWEgcHJvbWlzc2UgcXVlIMOpIGV4ZWN1dGFkYSBxdWFuZG8gYSBub3RpZmljYcOnw6NvIMOpIHJlbW92aWRhIGRvIERPTVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhpZGUob2JqZWN0KSB7XG4gICAgICByZXR1cm4gJG1kVG9hc3QuaGlkZShvYmplY3QpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Y2Nlc3MobXNnLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gdG9hc3QobXNnLCAnZ3JlZW4nLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGliZSB1bSB0b2FzdCBjb20gYXMgbWVuc2FnZW5zIGRlIGVycm8gcmVmZXJlbnRlIGEgdmFsaWRhw6fDo28uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZyB8IG9iamVjdCB8IGFycmF5fSBlcnJvcnMgLSBTdHJpbmcsIE9iamV0byBvdSBBcnJheSBjb250ZW5kbyBhcyBtZW5zYWdlbnMgZGUgZXJyby5cbiAgICAgKiBTdXBvcnRhIGRpZmVyZW50ZSBmb3JtYXRvczpcbiAgICAgKlxuICAgICAqIFBhcmEgdmFsaWRhw6fDtWVzIGRlIGF0cmlidXRvc1xuICAgICAqICAge1xuICAgICAqICAgIFwibm9tZS1kby1hdHJpYnV0bzFcIjogW1wibWVuc2FnZW0gZGUgZXJybyAxXCIsIFwibWVuc2FnZW0gZGUgZXJybyAyXCJdLFxuICAgICAqICAgIFwibm9tZS1kby1hdHJpYnV0bzJcIjogW1wibWVuc2FnZW0gZGUgZXJybyAxXCJdXG4gICAgICogICB9XG4gICAgICpcbiAgICAgKiBvdSAtIFBhcmEgdsOhcmlhcyBtZW5zYWdlbnMgc2ltcGxlc1xuICAgICAqICAgW1xuICAgICAqICAgICdNZW5zYWdlbSAxJyxcbiAgICAgKiAgICAnTWVuc2FnZW0gMidcbiAgICAgKiAgIF1cbiAgICAgKlxuICAgICAqICBvdSAtIFBhcmEgMSDDum5pY2EgbWVuc2FnZW1cbiAgICAgKiAgIFwiTWVuc2FnZW0gMVwiXG4gICAgICpcbiAgICAgKiAgb3UgLSBQYXJhIGV4Y2VwdGlvbnMgLSBOZXN0ZSBjYXNvIHVzYSB1bSBQckRpYWxvZ1xuICAgICAqICAge1xuICAgICAqICAgICBtZXNzYWdlOiAnRXhjZXB0aW9uIERlc2NvbmhlY2lkYScsXG4gICAgICogICAgIHNvdXJjZTogJ1N0YXJ0ZXJQYWNrLkNvbnRyb2xsZXJzLlN1cHBvcnRDb250cm9sbGVyLmxhbmdzKCknLFxuICAgICAqICAgICBsaW5lOiAyMSxcbiAgICAgKiAgICAgc3RhY2t0cmFjZTogJ2F0IFN0YXJ0ZXJQYWNrLkNvbnRyb2xsZXJzLlN1cHBvcnRDb250cm9sbGVyLmxhbmdzKCkgaW4gL2hvbWUvd29ya3NwYS4uLidcbiAgICAgKiAgIH1cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbXNnIC0gT3BjaW9uYWwuIE1lbnNhZ2VtIGRlIGVycm8uXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXJyb3IoZXJyb3JzKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICAgIC8vc2UgZm9yIHVtIG9iamV0byBjb250ZW5kbyBvcyBlcnJvcywgaXRlcmEgc29icmUgb3MgYXRyaWJ1dG9zIGRvIG1lc21vXG4gICAgICAvL3BhcmEgZXhpYmlyIGEocykgbWVuc2FnZW0obnMpIGRlIGVycm8gYXRyaWJ1aWRhc1xuICAgICAgaWYgKGFuZ3VsYXIuaXNPYmplY3QoZXJyb3JzKSkge1xuICAgICAgICB2YXIgZXJyb3JTdHIgPSAnJztcblxuICAgICAgICBpZiAoY2hlY2tFcnJvcklzVW5rbm93bkV4Y2VwdGlvbihlcnJvcnMpKSB7XG4gICAgICAgICAgZXJyb3JTdHIgKz0gJ01lc3NhZ2U6ICcgKyBlcnJvcnMubWVzc2FnZSArICc8YnIvPlNvdXJjZTogJyArIGVycm9ycy5zb3VyY2UgKyAnPGJyLz5MaW5lOiAnICsgZXJyb3JzLmxpbmUgKyAnPGJyLz48YnIvPlN0YWNrVHJhY2U6ICc7XG5cbiAgICAgICAgICB2YXIgc3RlcHMgPSBlcnJvcnMuc3RhY2t0cmFjZS5zcGxpdCgnIGF0ICcpO1xuXG4gICAgICAgICAgaWYgKHN0ZXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHN0ZXBzLmZvckVhY2goZnVuY3Rpb24gKHN0ZXAsIGluZGV4KSB7XG4gICAgICAgICAgICAgIGVycm9yU3RyICs9ICc8YnIvPlN0ZXAgJyArIChpbmRleCArIDEpICsgJzogJyArIHN0ZXA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXJyb3JTdHIgKz0gZXJyb3JzLnN0YWNrdHJhY2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIFByRGlhbG9nLmFsZXJ0KHtcbiAgICAgICAgICAgIHRpdGxlOiAnRXhjZXB0aW9uJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBlcnJvclN0clxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGV4aWJlIGFzIG1lbnNhZ2VtIGRlIGVycm8gY29udGlkYXMgbm8gb2JqZXRvXG4gICAgICAgICAgLy8gIHtcbiAgICAgICAgICAvLyAgICBcIm5hbWVcIjogW1wibyBjYW1wbyBub21lIMOpIG9icmlnYXTDs3Jpb1wiXSxcbiAgICAgICAgICAvLyAgICBcInBhc3N3b3JkXCI6IFtcbiAgICAgICAgICAvLyAgICAgIFwiQSBjb25maXJtYcOnw6NvIGRlIHNlbmhhIG7Do28gY29uZmVyZS5cIixcbiAgICAgICAgICAvLyAgICAgIFwic2VuaGEgZGV2ZSB0ZXIgbm8gbcOtbmltbyA2IGNhcmFjdGVyZXMuXCJcbiAgICAgICAgICAvLyAgICBdXG4gICAgICAgICAgLy8gIH1cbiAgICAgICAgICBsb2Rhc2guZm9ySW4oZXJyb3JzLCBmdW5jdGlvbiAoa2V5RXJyb3JzKSB7XG4gICAgICAgICAgICBlcnJvclN0ciArPSBidWlsZEFycmF5TWVzc2FnZShrZXlFcnJvcnMpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZXJyb3JzID0gZXJyb3JTdHI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGVycm9ycykpIHtcbiAgICAgICAgICBlcnJvcnMgPSBidWlsZEFycmF5TWVzc2FnZShlcnJvcnMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0b2FzdChlcnJvcnMsICdyZWQtQTcwMCcsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJ1aWxkQXJyYXlNZXNzYWdlKGFyck1zZykge1xuICAgICAgdmFyIG1zZyA9ICcnO1xuXG4gICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGFyck1zZykpIHtcbiAgICAgICAgLy9pdGVyYSBzb2JyZSBvcyBlcnJvcyBkZSB1bSBhdHJpYnV0b1xuICAgICAgICBhcnJNc2cuZm9yRWFjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICBtc2cgKz0gZXJyb3IgKyAnPGJyLz4nO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1zZyArPSBhcnJNc2cgKyAnPGJyLz4nO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbXNnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4aWJlIHVtIHRvYXN0IGNvbSBhcyBtZW5zYWdlbnMgZGUgZXJybyByZWZlcmVudGUgYSB2YWxpZGHDp8Ojby5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0IHwgYXJyYXl9IGVycm9ycyAtIE9iamV0byBvdSBBcnJheSBjb250ZW5kbyBhcyBtZW5zYWdlbnMgZGUgZXJyby4gRGV2ZSBlc3RhclxuICAgICAqIG5vIHNlZ3VpbnRlIGZvcm1hdG8uXG4gICAgICogICB7XG4gICAgICogICAgXCJub21lLWRvLWF0cmlidXRvMVwiOiBbXCJtZW5zYWdlbSBkZSBlcnJvIDFcIiwgXCJtZW5zYWdlbSBkZSBlcnJvIDJcIl0sXG4gICAgICogICAgXCJub21lLWRvLWF0cmlidXRvMlwiOiBbXCJtZW5zYWdlbSBkZSBlcnJvIDFcIl1cbiAgICAgKiAgIH1cbiAgICAgKiBvdVxuICAgICAqICAgW1xuICAgICAqICAgICdNZW5zYWdlbSAxJyxcbiAgICAgKiAgICAnTWVuc2FnZW0gMidcbiAgICAgKiAgIF1cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbXNnIC0gT3BjaW9uYWwuIE1lbnNhZ2VtIGRlIGVycm8uXG4gICAgICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgLSBPcHRpb25zIGRhIGRvY3VtZW50YcOnw6NvIGRvICRtZFRvYXN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gZXJyb3JWYWxpZGF0aW9uKGVycm9ycywgbXNnLCBvcHRpb25zKSB7XG4gICAgICBvYmouZXJyb3IoYW5ndWxhci5pc0FycmF5KGVycm9ycykgfHwgYW5ndWxhci5pc09iamVjdChlcnJvcnMpID8gZXJyb3JzIDogbXNnLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbmZvKG1zZywgb3B0aW9ucykge1xuICAgICAgcmV0dXJuIHRvYXN0KG1zZywgJ3RlYWwnLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB3YXJuKG1zZywgb3B0aW9ucykge1xuICAgICAgcmV0dXJuIHRvYXN0KG1zZywgJ3dhcm4nLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGVja0Vycm9ySXNVbmtub3duRXhjZXB0aW9uKGVycm9ycykge1xuICAgICAgcmV0dXJuIGFuZ3VsYXIuaXNPYmplY3QoZXJyb3JzKSAmJiBhbmd1bGFyLmlzRGVmaW5lZChlcnJvcnMubGluZSkgJiYgYW5ndWxhci5pc0RlZmluZWQoZXJyb3JzLnNvdXJjZSkgJiYgYW5ndWxhci5pc0RlZmluZWQoZXJyb3JzLnN0YWNrdHJhY2UpO1xuICAgIH1cblxuICAgIHJldHVybiBvYmo7XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZGlyZWN0aXZlKCdwclVwbG9hZGVyQmFzZTY0JywgW1wiJHFcIiwgZnVuY3Rpb24gKCRxKSB7XG4gICAgdmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxuICAgICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcbiAgICAgICAgaWYgKCFuZ01vZGVsKSByZXR1cm47XG5cbiAgICAgICAgbmdNb2RlbC4kcmVuZGVyID0gZnVuY3Rpb24gKCkge307XG5cbiAgICAgICAgZWxlbWVudC5iaW5kKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQ7XG5cbiAgICAgICAgICAkcS5hbGwoc2xpY2UuY2FsbChlbGVtZW50LmZpbGVzLCAwKS5tYXAocmVhZEZpbGUpKS50aGVuKGZ1bmN0aW9uICh2YWx1ZXMpIHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50Lm11bHRpcGxlKSBuZ01vZGVsLiRzZXRWaWV3VmFsdWUodmFsdWVzKTtlbHNlIG5nTW9kZWwuJHNldFZpZXdWYWx1ZSh2YWx1ZXMubGVuZ3RoID8gdmFsdWVzWzBdIDogbnVsbCk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBmdW5jdGlvbiByZWFkRmlsZShmaWxlKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZS50YXJnZXQucmVzdWx0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICB9XSk7XG59KSgpOyIsIi8qZXNsaW50IGFuZ3VsYXIvZmlsZS1uYW1lOiAwLCBuby11bmRlZjogMCovXG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vZW5jYXBzdWxhIGFzIGJpYmxpb3RlY2FzIGV4dGVybmFzIHBhcmEgc2VyZW0gY2FycmVnYWRhcyBjb21vIHVtYSBkZXBlbmTDqm5jaWFcbiAgLy9kbyBhbmd1bGFyLlxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5jb25zdGFudCgnbG9kYXNoJywgXylcbiAgICAuY29uc3RhbnQoJ18nLCBfKVxuICAgIC5jb25zdGFudCgnYWxhc3FsJywgYWxhc3FsKVxuICAgIC5jb25zdGFudCgnbW9tZW50JywgbW9tZW50KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ25nUHJvZGViJylcbiAgICAucnVuKHJ1bik7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LXBhcmFtc1xuICBmdW5jdGlvbiBydW4oJHRlbXBsYXRlQ2FjaGUsIFBySWNvbnMpIHtcbiAgICBhbmd1bGFyLmZvckVhY2goUHJJY29ucywgZnVuY3Rpb24oaWNvbikge1xuICAgICAgJHRlbXBsYXRlQ2FjaGUucHV0KGljb24udXJsLCBpY29uLnN2Zyk7XG4gICAgfSk7XG4gIH1cbn0oKSk7XG5cblxuIiwiLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qKlxuICAgKiBEaXJldGl2YSBxdWUgZXhpYmUgdW0gc3Bpbm5lciBzZW1wcmUgcXVlIHVtIGJyb2FkY2FzdCwgbWFudWFsbWVudGUsIMOpIGRpc3BhcmFkb1xuICAgKi9cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5jb21wb25lbnQoJ3ByRGF0ZVRpbWVQaWNrZXInLCB7XG4gICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICAgIDxtZC1pbnB1dC1jb250YWluZXIgY2xhc3M9XCJtZC1ibG9ja1wiIGZsZXg9XCIkY3RybC5mbGV4XCI+XG4gICAgICAgICAgICA8bGFiZWwgZm9yPVwiJGN0cmwuaWRcIj57eyRjdHJsLmxhYmVsfX08L2xhYmVsPlxuICAgICAgICAgICAgPG1kLWljb24gbWQtZm9udC1zZXQ9XCJtYXRlcmlhbC1pY29uc1wiIGNsYXNzPVwibWQtd2FyblwiXG4gICAgICAgICAgICAgIG5nLXN0eWxlPVwiJGN0cmwuc3R5bGUubGFiZWxcIlxuICAgICAgICAgICAgICBuZy1jbGljaz1cIiRjdHJsLnNob3codHJ1ZSlcIlxuICAgICAgICAgICAgICBtZC1jb2xvcnM9XCIkY3RybC5jb2xvcnMuaWNvblwiPmRhdGVfcmFuZ2U8L21kLWljb24+XG4gICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgaWQ9XCIkY3RybC5pZFwiXG4gICAgICAgICAgICAgIG5nLW1vZGVsPVwiJGN0cmwubmdNb2RlbFwiXG4gICAgICAgICAgICAgIG5nLWNsaWNrPVwiJGN0cmwuc2hvdyhmYWxzZSlcIlxuICAgICAgICAgICAgICBuZy1yZWFkb25seT1cIiRjdHJsLmNsaWNrVG9TaG93SW5GaWVsZFwiXG4gICAgICAgICAgICAgIHRleHQtbWFzaz1cIiRjdHJsLm1hc2tDb25maWdcIlxuICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiPlxuICAgICAgICAgICAgPC9pbnB1dD5cbiAgICAgICAgICA8L21kLWlucHV0LWNvbnRhaW5lcj5cbiAgICAgICAgYCxcbiAgICAgIGNvbnRyb2xsZXI6IFsnbWRjRGF0ZVRpbWVEaWFsb2cnLCAnbW9tZW50JywgZnVuY3Rpb24obWRjRGF0ZVRpbWVEaWFsb2csIG1vbWVudCkge1xuICAgICAgICB2YXIgY3RybCA9IHRoaXM7XG5cbiAgICAgICAgY3RybC4kb25Jbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY3RybC5zdHlsZSA9IHtcbiAgICAgICAgICAgIGxhYmVsOiB7XG4gICAgICAgICAgICAgIGN1cnNvcjogJ3BvaW50ZXInXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY3RybC5hdXRvT2sgPSBzZXREZWZhdWx0VG9UcnVlKGN0cmwuYXV0b09rKTtcbiAgICAgICAgICBjdHJsLndpdGhNaW51dGVzUGlja2VyID0gc2V0RGVmYXVsdFRvVHJ1ZShjdHJsLndpdGhNaW51dGVzUGlja2VyKTtcbiAgICAgICAgICBjdHJsLmNsaWNrVG9TaG93SW5GaWVsZCA9IHNldERlZmF1bHRUb1RydWUoY3RybC5jbGlja1RvU2hvd0luRmllbGQpO1xuICAgICAgICAgIGN0cmwuZm9ybWF0ID0gKGN0cmwuZm9ybWF0IHx8ICgoY3RybC53aXRoVGltZSkpID8gJ0REL01NL1lZWVkgSEg6bW0nIDogJ0REL01NL1lZWVknKTtcblxuICAgICAgICAgIGN0cmwuZGVmaW5lTWFzaygpO1xuICAgICAgICAgIGN0cmwuZGVmaW5lQ29sb3JzKCk7XG4gICAgICAgIH1cblxuICAgICAgICBjdHJsLmRlZmluZUNvbG9ycyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGN0cmwuY29sb3JzID0ge1xuICAgICAgICAgICAgaWNvbjoge1xuICAgICAgICAgICAgICBjb2xvcjogKGN0cmwuaWNvbkNvbG9yKSA/IGN0cmwuaWNvbkNvbG9yIDogJ2RlZmF1bHQtZ3JleS05MDAnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICBjdHJsLmRlZmluZU1hc2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChjdHJsLm1hc2spKSB7XG4gICAgICAgICAgICBjdHJsLm1hc2sgPSBbL1xcZC8sIC9cXGQvLCAnLycsIC9cXGQvLCAvXFxkLywgJy8nLCAvXFxkLywgL1xcZC8sIC9cXGQvLCAvXFxkL107XG5cbiAgICAgICAgICAgIGlmIChjdHJsLndpdGhUaW1lKSB7XG4gICAgICAgICAgICAgIGN0cmwubWFzayA9IGN0cmwubWFzay5jb25jYXQoWycgJywgL1xcZC8sIC9cXGQvLCAnOicsIC9cXGQvLCAvXFxkL10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGN0cmwubWFza0NvbmZpZyA9IHtcbiAgICAgICAgICAgIG1hc2s6IGN0cmwubWFzayxcbiAgICAgICAgICAgIGd1aWRlOiBmYWxzZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldERlZmF1bHRUb1RydWUodmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gKGFuZ3VsYXIuaXNVbmRlZmluZWQodmFsdWUpIHx8IHZhbHVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGN0cmwuc2hvdyA9IGZ1bmN0aW9uKGZyb21JY29uKSB7XG4gICAgICAgICAgaWYgKGN0cmwuY2xpY2tUb1Nob3dJbkZpZWxkIHx8IGZyb21JY29uKSB7XG4gICAgICAgICAgICBtZGNEYXRlVGltZURpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgbWF4RGF0ZTogKGFuZ3VsYXIuaXNVbmRlZmluZWQoY3RybC5tYXhEYXRlKSkgPyBudWxsIDogY3RybC5tYXhEYXRlLFxuICAgICAgICAgICAgICBmb3JtYXQ6IGN0cmwuZm9ybWF0LFxuICAgICAgICAgICAgICBtaW51dGVzOiBjdHJsLndpdGhNaW51dGVzUGlja2VyLFxuICAgICAgICAgICAgICBjdXJyZW50RGF0ZTogY3RybC5uZ01vZGVsLFxuICAgICAgICAgICAgICBhdXRvT2s6IGN0cmwuYXV0b09rLFxuICAgICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsYXInLFxuICAgICAgICAgICAgICB0b2RheVRleHQ6ICdIb2plJyxcbiAgICAgICAgICAgICAgdGltZTogY3RybC53aXRoVGltZSxcbiAgICAgICAgICAgICAgZGF0ZTogdHJ1ZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRlKSB7XG4gICAgICAgICAgICAgIGN0cmwubmdNb2RlbCA9IG1vbWVudChkYXRlKS5mb3JtYXQoY3RybC5mb3JtYXQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XSxcbiAgICAgIHJlcXVpcmU6IHtcbiAgICAgICAgbmdNb2RlbEN0cmw6ICduZ01vZGVsJ1xuICAgICAgfSxcbiAgICAgIGJpbmRpbmdzOiB7XG4gICAgICAgIGxhYmVsOiAnPScsXG4gICAgICAgIG1pbkRhdGU6ICc9JyxcbiAgICAgICAgbWF4RGF0ZTogJz0nLFxuICAgICAgICBuZ01vZGVsOiAnPCcsXG4gICAgICAgIGlkOiAnPCcsXG4gICAgICAgIGljb25Db2xvcjogJzwnLFxuICAgICAgICB3aXRoVGltZTogJzwnLFxuICAgICAgICB3aXRoTWFzazogJzwnLFxuICAgICAgICB3aXRoTWludXRlc1BpY2tlcjogJzwnLFxuICAgICAgICBjbGlja1RvU2hvd0luRmllbGQ6ICc8JyxcbiAgICAgICAgYXV0b09rOiAnPCcsXG4gICAgICAgIGZvcm1hdDogJzwnLFxuICAgICAgICBmbGV4OiAnPCcsXG4gICAgICAgIG1hc2s6ICc8J1xuICAgICAgfVxuICAgIH0pO1xufSkoKTtcblxuIiwiLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5mYWN0b3J5KCdQckRpYWxvZycsIGRpYWxvZ1NlcnZpY2UpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gZGlhbG9nU2VydmljZSgkbG9nLCAkbWREaWFsb2csICRtZFV0aWwsICRyb290U2NvcGUsICRhbmltYXRlLCAkZG9jdW1lbnQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY3VzdG9tOiBjdXN0b20sXG4gICAgICBjb25maXJtOiBjb25maXJtLFxuICAgICAgY2xvc2U6IGNsb3NlLFxuICAgICAgYWxlcnQ6IGFsZXJ0XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcXVlIGNvbmZpZ3VyYSBlIHJlYWxpemEgbyBtZXJnZSBkbyBvYmpldG8gcmVjZWJpZG8gdmlhIHBhcsOibWV0cm9cbiAgICAgKiBjb20gYSBjb25maWd1cmHDp8OjbyBwYWRyw6NvIHBhcmEgYSBleGliacOnw6NvIGRvIGRpYWxvZ1xuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWcgLSBPYmpldG8gY29udGVuZG8gYXMgY29uZmlndXJhw6fDtWVzXG4gICAgICogQHJldHVybnMge2RpYWxvZ1NlcnZpY2V9IC0gUmV0b3JuYSBvIHNlcnZpY2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBidWlsZChjb25maWcpIHtcblxuICAgICAgaWYgKCFhbmd1bGFyLmlzT2JqZWN0KGNvbmZpZykpIHtcbiAgICAgICAgJGxvZy5lcnJvcignUHJEaWFsb2c6IFBhcsOibWV0cm8gaW52w6FsaWRvLCDDqSBlc3BlcmFuZG8gdW0gb2JqZXRvIGNvbW8gcGFyw6JtZXRyby4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgICAgIGhhc0JhY2tkcm9wOiBmYWxzZSxcbiAgICAgICAgZXNjYXBlVG9DbG9zZTogZmFsc2UsXG4gICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgIGF1dG9XcmFwOiB0cnVlLFxuICAgICAgICBza2lwSGlkZTogdHJ1ZSxcbiAgICAgICAgbG9jYWxzOiB7fSxcbiAgICAgICAgekluZGV4OiA3NSxcbiAgICAgICAgZnVsbHNjcmVlbjogZmFsc2VcbiAgICAgIH07XG5cbiAgICAgIC8vbsOjbyBmYXplbW9zIG1lcmdlIGRhIHByb3ByaWVkYWRlIGxvY2FscyBwYXJhIG7Do28gZXN0b3VyYXIgbyBsaW1pdGUgZGUgcmVjdXJzaXZpZGFkZVxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGNvbmZpZy5sb2NhbHMpKSB7XG4gICAgICAgIGRlZmF1bHRPcHRpb25zLmxvY2FscyA9IGNvbmZpZy5sb2NhbHM7XG4gICAgICAgIGRlbGV0ZSBjb25maWcubG9jYWxzO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYW5ndWxhci5tZXJnZShkZWZhdWx0T3B0aW9ucywgY29uZmlnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBleGliZSBvIGRpYWxvZyBkZSBjb25maXJtYcOnw6NvIG5hIHRlbGEgZGVwb2lzIHF1ZSBvIGJ1aWxkIGUgaW52b2NhZG9cbiAgICAgKiBkZSB1bWEgZGV0ZXJtaW5hZGEgYcOnw6NvXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFsZXJ0KGNvbmZpZykge1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IGJ1aWxkKGNvbmZpZyk7XG5cbiAgICAgIG9wdGlvbnMubG9jYWxzID0ge1xuICAgICAgICB0aXRsZTogKGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMudGl0bGUpID8gb3B0aW9ucy50aXRsZSA6ICdFeGNlcHRpb24nKSxcbiAgICAgICAgZGVzY3JpcHRpb246IChhbmd1bGFyLmlzRGVmaW5lZChvcHRpb25zLmRlc2NyaXB0aW9uKSA/IG9wdGlvbnMuZGVzY3JpcHRpb24gOiAnJyksXG4gICAgICAgIG9rQmdDb2xvcjogKGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMub2tCZ0NvbG9yKSA/IG9wdGlvbnMub2tCZ0NvbG9yIDogJ3JlZC1BNzAwJyksXG4gICAgICAgIHRvb2xiYXJCZ0NvbG9yOiAoYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy50b29sYmFyQmdDb2xvcikgPyBvcHRpb25zLnRvb2xiYXJCZ0NvbG9yIDogJ3JlZC1BNzAwJylcbiAgICAgIH07XG5cbiAgICAgIG9wdGlvbnMudGVtcGxhdGUgPVxuICAgICAgICAgIGAgPG1kLWRpYWxvZyBmbGV4PTUwIGFyaWEtbGFiZWw9XCIke29wdGlvbnMubG9jYWxzLnRpdGxlfVwiPlxuICAgICAgICAgICAgICA8bWQtdG9vbGJhciBtZC1zY3JvbGwtc2hyaW5rIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6J2RlZmF1bHQte3tjdHJsLnRvb2xiYXJCZ0NvbG9yfX0nfVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC10b29sYmFyLXRvb2xzXCI+XG4gICAgICAgICAgICAgICAgICA8aDM+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuPiR7b3B0aW9ucy5sb2NhbHMudGl0bGV9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9tZC10b29sYmFyPlxuICAgICAgICAgICAgICA8bWQtZGlhbG9nLWNvbnRlbnQgbGF5b3V0LW1hcmdpbj5cbiAgICAgICAgICAgICAgICA8cD4ke29wdGlvbnMubG9jYWxzLmRlc2NyaXB0aW9ufTwvcD5cbiAgICAgICAgICAgICAgPC9tZC1kaWFsb2ctY29udGVudD5cbiAgICAgICAgICAgICAgPG1kLWRpYWxvZy1hY3Rpb25zPlxuICAgICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxuICAgICAgICAgICAgICAgICAgbWQtY29sb3JzPVwiOjp7YmFja2dyb3VuZDonZGVmYXVsdC17e2N0cmwub2tCZ0NvbG9yfX0nfVwiXG4gICAgICAgICAgICAgICAgICBuZy1jbGljaz1cImN0cmwub2tBY3Rpb24oKVwiPk9rPC9tZC1idXR0b24+XG4gICAgICAgICAgICAgIDwvbWQtZGlhbG9nLWFjdGlvbnM+XG4gICAgICAgICAgICA8L21kLWRpYWxvZz5cbiAgICAgICAgICBgO1xuXG4gICAgICBvcHRpb25zLmNvbnRyb2xsZXIgPSBbJyRtZERpYWxvZycsIGZ1bmN0aW9uKCRtZERpYWxvZykge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIHZtLm9rQWN0aW9uID0gb2tBY3Rpb247XG5cbiAgICAgICAgZnVuY3Rpb24gb2tBY3Rpb24oKSB7XG4gICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgfV07XG5cbiAgICAgIG9wdGlvbnMuY29udHJvbGxlckFzID0gJ2N0cmwnO1xuICAgICAgb3B0aW9ucy5jbGlja091dHNpZGVUb0Nsb3NlID0gZmFsc2U7XG4gICAgICBvcHRpb25zLmhhc0JhY2tkcm9wID0gdHJ1ZTtcblxuICAgICAgcmV0dXJuICRtZERpYWxvZy5zaG93KG9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcXVlIGV4aWJlIG8gZGlhbG9nIGRlIGNvbmZpcm1hw6fDo28gbmEgdGVsYSBkZXBvaXMgcXVlIG8gYnVpbGQgZSBpbnZvY2Fkb1xuICAgICAqIGRlIHVtYSBkZXRlcm1pbmFkYSBhw6fDo29cbiAgICAgKiBAcmV0dXJucyB7cHJvbWlzc2V9IC0gUmV0b3JuYSB1bWEgcHJvbWlzc2UgcXVlIHBvZGUgb3UgbsOjbyBzZXIgcmVzb2x2aWRhXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29uZmlybShjb25maWcpIHtcblxuICAgICAgdmFyIG9wdGlvbnMgPSBidWlsZChjb25maWcpO1xuXG4gICAgICBvcHRpb25zLnRlbXBsYXRlID1cbiAgICAgICAgICBgIDxtZC1kaWFsb2cgZmxleD01MCBhcmlhLWxhYmVsPVwie3s6OmN0cmwudGl0bGV9fVwiPlxuICAgICAgICAgICAgICA8bWQtdG9vbGJhciBtZC1zY3JvbGwtc2hyaW5rPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC10b29sYmFyLXRvb2xzXCI+XG4gICAgICAgICAgICAgICAgICA8aDM+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuPnt7OjpjdHJsLnRpdGxlfX08L3NwYW4+XG4gICAgICAgICAgICAgICAgICA8L2gzPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L21kLXRvb2xiYXI+XG4gICAgICAgICAgICAgIDxtZC1kaWFsb2ctY29udGVudCBsYXlvdXQtbWFyZ2luPlxuICAgICAgICAgICAgICAgIDxwPnt7OjpjdHJsLmRlc2NyaXB0aW9ufX08L3A+XG4gICAgICAgICAgICAgIDwvbWQtZGlhbG9nLWNvbnRlbnQ+XG4gICAgICAgICAgICAgIDxtZC1kaWFsb2ctYWN0aW9ucz5cbiAgICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcbiAgICAgICAgICAgICAgICAgIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6J2RlZmF1bHQte3tjdHJsLnllc0JnQ29sb3J9fSd9XCJcbiAgICAgICAgICAgICAgICAgIG5nLWNsaWNrPVwiY3RybC55ZXNBY3Rpb24oKVwiPlNpbTwvbWQtYnV0dG9uPlxuICAgICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxuICAgICAgICAgICAgICAgICAgbWQtY29sb3JzPVwiOjp7YmFja2dyb3VuZDonZGVmYXVsdC17e2N0cmwubm9CZ0NvbG9yfX0nfVwiXG4gICAgICAgICAgICAgICAgICBuZy1jbGljaz1cImN0cmwubm9BY3Rpb24oKVwiPk7Do288L21kLWJ1dHRvbj5cbiAgICAgICAgICAgICAgPC9tZC1kaWFsb2ctYWN0aW9ucz5cbiAgICAgICAgICAgIDwvbWQtZGlhbG9nPlxuICAgICAgICAgIGA7XG4gICAgICBvcHRpb25zLmxvY2FscyA9IHtcbiAgICAgICAgdGl0bGU6IChhbmd1bGFyLmlzRGVmaW5lZChvcHRpb25zLnRpdGxlKSA/IG9wdGlvbnMudGl0bGUgOiAnJyksXG4gICAgICAgIGRlc2NyaXB0aW9uOiAoYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy5kZXNjcmlwdGlvbikgPyBvcHRpb25zLmRlc2NyaXB0aW9uIDogJycpLFxuICAgICAgICB5ZXNCZ0NvbG9yOiAoYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy55ZXNCZ0NvbG9yKSA/IG9wdGlvbnMueWVzQmdDb2xvciA6ICdwcmltYXJ5JyksXG4gICAgICAgIG5vQmdDb2xvcjogKGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMubm9CZ0NvbG9yKSA/IG9wdGlvbnMubm9CZ0NvbG9yIDogJ2FjY2VudCcpXG4gICAgICB9O1xuXG4gICAgICBvcHRpb25zLmNvbnRyb2xsZXIgPSBbJyRtZERpYWxvZycsIGZ1bmN0aW9uKCRtZERpYWxvZykge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIHZtLm5vQWN0aW9uID0gbm9BY3Rpb247XG4gICAgICAgIHZtLnllc0FjdGlvbiA9IHllc0FjdGlvbjtcblxuICAgICAgICBmdW5jdGlvbiBub0FjdGlvbigpIHtcbiAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24geWVzQWN0aW9uKCkge1xuICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgIH1dO1xuXG4gICAgICBvcHRpb25zLmNvbnRyb2xsZXJBcyA9ICdjdHJsJztcbiAgICAgIG9wdGlvbnMuY2xpY2tPdXRzaWRlVG9DbG9zZSA9IGZhbHNlO1xuICAgICAgb3B0aW9ucy5oYXNCYWNrZHJvcCA9IHRydWU7XG5cbiAgICAgIHJldHVybiAkbWREaWFsb2cuc2hvdyhvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBleGliZSBvIGRpYWxvZyBjdXN0b21pemFkbyBuYSB0ZWxhIGRlcG9pcyBxdWUgbyBidWlsZCBlIGludm9jYWRvXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGN1c3RvbShjb25maWcpIHtcblxuICAgICAgdmFyIG9wdGlvbnMgPSBidWlsZChjb25maWcpO1xuXG4gICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChvcHRpb25zLnRlbXBsYXRlVXJsKSAmJiBhbmd1bGFyLmlzVW5kZWZpbmVkKG9wdGlvbnMudGVtcGxhdGUpKSB7XG4gICAgICAgICRsb2cuZXJyb3IoXG4gICAgICAgICAgJ1ByRGlhbG9nOiB0ZW1wbGF0ZVVybCBvdSB0ZW1wbGF0ZSBpbmRlZmluaWRvLCDDqSBlc3BlcmFuZG8gdW0gdGVtcGxhdGVVcmwgb3UgdW0gdGVtcGxhdGUgY29tbyBhdHJpYnV0by4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvL0NyaWFkbyBvIGJhY2tkcm9wIG1hbnVhbG1lbnRlIHBhcmEgZGltaW51aXIgbyB6LWluZGV4IGF0cmF2w6lzIGRlIHVtYSBjbGFzc2UgY3NzXG4gICAgICAvL28gei1pbmRleCB0ZW0gcXVlIGZpY2FyIG1lbm9yIGRldmlkbyBhbyBkaWFsb2cuY29uZmlybSB1c2FyIG8gei1pbmRleCBvcmlnaW5hbCBkZSA4MFxuICAgICAgb3B0aW9ucyA9IGFkZEJhY2tkcm9wKG9wdGlvbnMpO1xuXG4gICAgICBvcHRpb25zLmhhc0JhY2tkcm9wID0gZmFsc2U7XG5cbiAgICAgIHJldHVybiAkbWREaWFsb2cuc2hvdyhvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBjcmlhIG8gYmFja2Ryb3AgZSBtb3N0cmEgbmEgdGVsYSBjb20gbyB6LWluZGV4IGNvbmZpZ3VyYXbDqWxcbiAgICAgKiBwYXJhIHNvYnJlcG9yIG9zIGVsZW1lbnRvcyBkYSB0ZWxhXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWRkQmFja2Ryb3Aob3B0aW9ucykge1xuICAgICAgaWYgKG9wdGlvbnMuaGFzQmFja2Ryb3ApIHtcbiAgICAgICAgdmFyIGJhY2tkcm9wID0gJG1kVXRpbC5jcmVhdGVCYWNrZHJvcCgkcm9vdFNjb3BlLCAnbWQtZGlhbG9nLWJhY2tkcm9wIG1kLW9wYXF1ZSBtZC1iYWNrZHJvcC1jdXN0b20nKTtcblxuICAgICAgICAkYW5pbWF0ZS5lbnRlcihiYWNrZHJvcCwgYW5ndWxhci5lbGVtZW50KCRkb2N1bWVudC5maW5kKCdib2R5JykpKTtcblxuICAgICAgICB2YXIgb3JpZ2luYWxPblJlbW92aW5nID0gb3B0aW9ucy5vblJlbW92aW5nO1xuXG4gICAgICAgIC8vTcOpdG9kbyBleGVjdXRhZG8gcXVhbmRvIGEgYW5pbWHDp8OjbyBkZSBmZWNoYW1lbnRvIGRvIGRpYWxvZyB0ZXJtaW5hXG4gICAgICAgIG9wdGlvbnMub25SZW1vdmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBiYWNrZHJvcC5yZW1vdmUoKTtcbiAgICAgICAgICBpZiAoYW5ndWxhci5pc0Z1bmN0aW9uKG9yaWdpbmFsT25SZW1vdmluZykpIG9yaWdpbmFsT25SZW1vdmluZy5jYWxsKCk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgb3JpZ2luYWxPbkNvbXBsZXRlID0gb3B0aW9ucy5vbkNvbXBsZXRlO1xuXG4gICAgICAgIC8vTcOpdG9kbyBleGVjdXRhZG8gcXVhbmRvIGEgYW5pbWHDp8OjbyBkZSBhYmVydHVyYSBkbyBkaWFsb2cgdGVybWluYVxuICAgICAgICBvcHRpb25zLm9uQ29tcGxldGUgPSBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgICAgICB2YXIgekluZGV4ID0gcGFyc2VJbnQob3B0aW9ucy56SW5kZXgsIDEwKTtcblxuICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgkZG9jdW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLWJhY2tkcm9wLWN1c3RvbScpKS5jc3MoJ3otaW5kZXgnLCB6SW5kZXgpO1xuICAgICAgICAgIGVsZW1lbnQuY3NzKCd6LWluZGV4JywgekluZGV4ICsgMSk7XG4gICAgICAgICAgaWYgKGFuZ3VsYXIuaXNGdW5jdGlvbihvcmlnaW5hbE9uQ29tcGxldGUpKSBvcmlnaW5hbE9uQ29tcGxldGUuY2FsbCgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBvcHRpb25zO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcXVlIHNlcnZlIHBhcmEgZmVjaGFyIG8gZGlhbG9nXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgIH1cblxuICB9XG5cbn0pKCk7XG4iLCIvKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ25nUHJvZGViJylcbiAgICAuZmFjdG9yeSgnUHJGaWxlJywgUHJGaWxlKTtcblxuICAvKipcbiAgICogU2VydmljZSBxdWUgZW5jYXBzdWxhIG9zIHNlcnZpw6dvc1xuICAgKiBkZSBleHBvcnRhw6fDo28gZSBpbXBvcnRhw6fDo28gZGUgYXJxdWl2b3NcbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gUHJGaWxlKGFsYXNxbCwgbG9kYXNoLCAkZmlsdGVyKSB7XG4gICAgdmFyIG9iaiA9IHtcbiAgICAgIGV4cG9ydFRvRXhjZWw6IGV4cG9ydFRvRXhjZWwsXG4gICAgICBleHBvcnRUb0NTVjogZXhwb3J0VG9DU1ZcbiAgICB9O1xuXG4gICAgLy9EZWZpbmVkIGZpbHRlcnNcblxuICAgIGFsYXNxbC5mbi5mb3JtYXREYXRlID0gZnVuY3Rpb24oZGF0ZSwgZm9ybWF0KSB7XG4gICAgICByZXR1cm4gJGZpbHRlcigncHJEYXRlJykoZGF0ZSwgZm9ybWF0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnRhIG9zIGRhZG9zIGVudmlhZG9zIHBhcmEgbyBmb3JtYXRvIGluZm9ybWFkby5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfGFycmF5fSBmaWVsZHNcbiAgICAgKiAgU3RyaW5nIGNvbnRlbmRvIG9zIGNhbXBvcyBzZXBhcmFkbyBwb3IgdmlyZ3VsYVxuICAgICAqICAgIGV4OiBuYW1lLCBkZXNjcmlwdGlvblxuICAgICAqICAgIGV4OiBuYW1lIGFzIE5vbWUsIGRlc2NyaXB0aW9uIGFzICdEZXNjcmnDp8OjbydcbiAgICAgKiAgICBleDogKiAgKHBhcmEgdG9kb3Mgb3MgY2FtcG9zKVxuICAgICAqICBBcnJheSBkZSBvYmpldG9zIGNvbSBvcyBjYW1wb3NcbiAgICAgKiAgICBleDogW1xuICAgICAqICAgICAgeyBuYW1lOiAnbmFtZScsIGxhYmVsOiAnTm9tZScgfSxcbiAgICAgKiAgICAgIHsgbmFtZTogJ2Rlc2NyaXB0aW9uJywgbGFiZWw6ICdEZXNjcmnDp8OjbycgfSxcbiAgICAgKiAgICAgIHsgbmFtZTogJ3JvbGUubmFtZScsIGxhYmVsOiAnUGVyZmlsJyB9LFxuICAgICAqICAgICAgeyBuYW1lOiAnZm9ybWF0RGF0ZShkYXRlKScsIGxhYmVsOiAnRGF0YScgfSwqXG4gICAgICogICAgXVxuICAgICAqIEBwYXJhbSB7YXJyYXl9IGRhdGEgLSBBcnJheSBxdWUgdmFpIHNlcnZpciBjb21vIGZvbnRlIGRlIGRhZG9zXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZpbGVOYW1lIC0gTm9tZSBkbyBhcnF1aXZvIHNlbSBhIGV4dGVuc8Ojb1xuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWdcbiAgICAgKiBDb25maWd1cmHDp8O1ZXMgZGEgZG9jdW1lbnRhw6fDo28gZG8gYWxhc3FsIGNvbW86XG4gICAgICogIC0gKGJvb2xlYW4pIGhlYWRlcnNcbiAgICAgKiBtYWlzIGFzIGRlc3RhY2FkYXMgYWJhaXhvXG4gICAgICogIC0gKHN0cmluZykgd2hlcmVcbiAgICAgKiAgLSAoc3RyaW5nKSBvcmRlckJ5XG4gICAgICpcbiAgICAgKiBmaWx0ZXJzIGRlZmluaWRvc1xuICAgICAqXG4gICAgICogZm9ybWF0RGF0ZShjYW1wbywgW2Zvcm1hdG9dKVxuICAgICAqXG4gICAgICogRXhlbXBsbzpcbiAgICAgKlxuICAgICAqIHZhciBjYXJzID0gW1xuICAgICAqICB7IG5hbWU6ICdTdGlsbycsICBicmFuZDogJ0ZpYXQnLCBkYXRlOiBtb21lbnQoKS5zdWJ0cmFjdCgxLCAneWVhcnMnKSB9LFxuICAgICAqICB7IG5hbWU6ICdQdW50bycsICBicmFuZDogJ0ZpYXQnLCBkYXRlOiBtb21lbnQoKS5zdWJ0cmFjdCgzLCAneWVhcnMnKSB9LFxuICAgICAqICB7IG5hbWU6ICdGaWVzdGEnLCBicmFuZDogJ0ZvcmQnLCBkYXRlOiAnMDQtMDEtMjAxNycgfVxuICAgICAqIF1cbiAgICAgKlxuICAgICAqIFByRmlsZS5leHBvcnRUb0V4Y2VsKFtcbiAgICAgKiAgeyBuYW1lOiAnYnJhbmQnLCBsYWJlbDogJ01hcmNhJyB9LFxuICAgICAqICB7IG5hbWU6ICduYW1lJywgbGFiZWw6ICdOb21lJyB9LFxuICAgICAqICB7IG5hbWU6ICdmb3JtYXREYXRlKGRhdGUsIFxcJ0RELU1NLVlZWVlcXCcpJywgbGFiZWw6ICdDb21wcmFkbyBlbT8nIH1cbiAgICAgKiBdLCBjYXJzLCAnZGF0YS1leHBvcnQnLCB7XG4gICAgICogIG9yZGVyQnk6ICdicmFuZCBBU0MsIG5hbWUgQVNDJyxcbiAgICAgKiAgd2hlcmU6ICdicmFuZCBsaWtlIFwiJUZpJVwiJ1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4cG9ydFRvKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZykge1xuICAgICAgdmFyIGRlZmF1bHRDb25maWcgPSB7XG4gICAgICAgIGhlYWRlcnM6IHRydWVcbiAgICAgIH1cblxuICAgICAgaWYgKGFuZ3VsYXIuaXNPYmplY3QoY29uZmlnKSkgYW5ndWxhci5tZXJnZShkZWZhdWx0Q29uZmlnLCBjb25maWcpO1xuICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoZmlsZU5hbWUpKSBmaWxlTmFtZSA9ICdleHBvcnQnXG5cbiAgICAgIGRlZmF1bHRDb25maWcud2hlcmUgPSAoYW5ndWxhci5pc0RlZmluZWQoZGVmYXVsdENvbmZpZy53aGVyZSkpID8gJyBXSEVSRSAnICsgZGVmYXVsdENvbmZpZy53aGVyZSA6ICcgJztcbiAgICAgIGRlZmF1bHRDb25maWcub3JkZXJCeSA9IChhbmd1bGFyLmlzRGVmaW5lZChkZWZhdWx0Q29uZmlnLm9yZGVyQnkpKSA/ICcgT1JERVIgQlkgJyArIGRlZmF1bHRDb25maWcub3JkZXJCeSA6ICcgJztcblxuICAgICAgZmlsZU5hbWUgPSBmaWxlTmFtZSArICcuJyArIGRlZmF1bHRDb25maWcuZm9ybWF0VG87XG5cbiAgICAgIHJldHVybiBhbGFzcWwucHJvbWlzZSgnU0VMRUNUICcgKyBidWlsZEZpZWxkcyhmaWVsZHMpXG4gICAgICAgICsgJyBJTlRPICcgKyBkZWZhdWx0Q29uZmlnLmZvcm1hdFRvLnRvVXBwZXJDYXNlKCkgKyAnKD8sID8pIEZST00gPyAnXG4gICAgICAgICsgZGVmYXVsdENvbmZpZy53aGVyZVxuICAgICAgICArIGRlZmF1bHRDb25maWcub3JkZXJCeSwgW2ZpbGVOYW1lLCBkZWZhdWx0Q29uZmlnLCBkYXRhXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0YSBvcyBkYWRvcyBlbnZpYWRvcyBwYXJhIGNzdlxuICAgICAqXG4gICAgICogQHNlZSBleHBvcnRUb1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4cG9ydFRvQ1NWKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZykge1xuICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoY29uZmlnKSkgY29uZmlnID0ge307XG5cbiAgICAgIGNvbmZpZy5mb3JtYXRUbyA9ICdjc3YnO1xuXG4gICAgICByZXR1cm4gZXhwb3J0VG8oZmllbGRzLCBkYXRhLCBmaWxlTmFtZSwgY29uZmlnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnRhIG9zIGRhZG9zIGVudmlhZG9zIHBhcmEgZXhjZWxcbiAgICAgKlxuICAgICAqIEBzZWUgZXhwb3J0VG9cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleHBvcnRUb0V4Y2VsKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZykge1xuICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoY29uZmlnKSkgY29uZmlnID0ge307XG5cbiAgICAgIGNvbmZpZy5mb3JtYXRUbyA9ICd4bHN4JztcblxuICAgICAgcmV0dXJuIGV4cG9ydFRvKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTW9udGEgdW1hIHN0cmluZyBjb250ZW5kbyBvcyBjYW1wb3MgcGFyYSBvIFNFTEVDVCBkYSBRdWVyeS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBidWlsZEZpZWxkcyhmaWVsZHMpIHtcbiAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZmllbGRzKSkge1xuICAgICAgICBmaWVsZHMgPSBsb2Rhc2gubWFwKGZpZWxkcywgZnVuY3Rpb24oZmllbGQpIHtcbiAgICAgICAgICByZXR1cm4gZmllbGQubmFtZSArICcgYXMgWycgKyBmaWVsZC5sYWJlbCArICddJztcbiAgICAgICAgfSkuam9pbignLCAnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZpZWxkcztcbiAgICB9XG5cbiAgICByZXR1cm4gb2JqO1xuICB9XG5cbn0oKSk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCduZ1Byb2RlYicpXG4gICAgLmZpbHRlcigncHJEYXRlJywgcHJEYXRlKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIHByRGF0ZShtb21lbnQpIHtcbiAgICAvKipcbiAgICAgKiBGb3JtYXRhIHVtYSBkYXRhIG5vIHBhZHLDo28gYnJhc2lsZWlyb1xuICAgICAqL1xuICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5wdXRGb3JtYXQpIHtcbiAgICAgIHZhciBvdXRwdXRGb3JtYXQgPSAnREQvTU0vWVlZWSc7XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChpbnB1dEZvcm1hdCkpIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh2YWx1ZSwgaW5wdXRGb3JtYXQpLmZvcm1hdChvdXRwdXRGb3JtYXQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh2YWx1ZSkuZm9ybWF0KG91dHB1dEZvcm1hdCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCduZ1Byb2RlYicpXG4gICAgLmZpbHRlcigncHJEYXRldGltZScsIHByRGF0ZXRpbWUpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gcHJEYXRldGltZShtb21lbnQpIHtcbiAgICAvKipcbiAgICAgKiBGb3JtYXRhIHVtYSBkYXRhIGNvbSBob3LDoXJpbyBubyBwYWRyw6NvIGJyYXNpbGVpcm9cbiAgICAgKi9cbiAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiBtb21lbnQodmFsdWUpLmZvcm1hdCgnREQvTU0vWVlZWSBISDptbScpO1xuICAgIH1cbiAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5maWx0ZXIoJ3JlYWwnLCByZWFsKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIHJlYWwoJGZpbHRlcikge1xuICAgIC8qKlxuICAgICAqIEZvcm1hdGEgdW0gdmFsb3IgcGFyYSBvIHBhZHLDo28gYnJhc2lsZWlyb1xuICAgICAqL1xuICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuICRmaWx0ZXIoJ2N1cnJlbmN5JykodmFsdWUsICdSJCAnKTtcbiAgICB9XG4gIH1cblxufSkoKTtcbiIsIi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKiBlc2xpbnQtZGlzYWJsZSBtYXgtbGVuICovXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCduZ1Byb2RlYicpXG4gICAgLmNvbnN0YW50KCdQckljb25zJywgW1xuICAgICAge1xuICAgICAgICBpZDogJ3ByLWV4Y2VsJyxcbiAgICAgICAgdXJsOiAncHItZXhjZWwuc3ZnJyxcbiAgICAgICAgc3ZnOiAnPHN2ZyBoZWlnaHQ9XCIyNFwiIHdpZHRoPVwiMjRcIiBzdHlsZT1cImZpbGw6IzJFN0QzMlwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj48cGF0aCBkPVwiTTYsMkgxNEwyMCw4VjIwQTIsMiAwIDAsMSAxOCwyMkg2QTIsMiAwIDAsMSA0LDIwVjRBMiwyIDAgMCwxIDYsMk0xMywzLjVWOUgxOC41TDEzLDMuNU0xNywxMUgxM1YxM0gxNEwxMiwxNC42N0wxMCwxM0gxMVYxMUg3VjEzSDhMMTEsMTUuNUw4LDE4SDdWMjBIMTFWMThIMTBMMTIsMTYuMzNMMTQsMThIMTNWMjBIMTdWMThIMTZMMTMsMTUuNUwxNiwxM0gxN1YxMVpcIiAvPjwvc3ZnPidcbiAgICAgIH1cbiAgICBdKTtcblxufSgpKTtcbiIsIi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5kaXJlY3RpdmUoJ3ByUGFnaW5hdGlvbicsIHBhZ2luYXRpb25EaXJlY3RpdmUpO1xuXG4gIC8qKlxuICAgKiBEaXJldGl2YSBxdWUgZXhpYmUgdW1hIHBhZ2luYcOnw6NvLlxuICAgKiBBZG90YSBvIGVzdGlsbyBkZSBwYWdpbmHDp8OjbyBkYSBCdXNjYSBkbyBHb29nbGUuXG4gICAqIFV0aWxpemEgb3MgZXN0aWxvcyBkbyBib290c3RyYXBcbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gcGFnaW5hdGlvbkRpcmVjdGl2ZSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdBRScsXG4gICAgICBzY29wZToge1xuICAgICAgICBwYWdpbmF0b3I6ICc9J1xuICAgICAgfSxcbiAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxzZWN0aW9uIGNsYXNzPVwicHItcGFnaW5hdGlvblwiIGxheW91dD1cInJvd1wiPlxuICAgICAgICAgIDxzZWN0aW9uIGxheW91dD1cInJvd1wiIGxheW91dC1hbGlnbj1cImNlbnRlciBjZW50ZXJcIiBsYXlvdXQtd3JhcFxuICAgICAgICAgICAgc3R5bGU9XCJtYXJnaW4tcmlnaHQ6IDEwcHhcIlxuICAgICAgICAgICAgbmctc2hvdz1cInBhZ2luYXRvci5udW1iZXJPZlBhZ2VzID4gMVwiPlxuICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcbiAgICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cInBhZ2luYXRvci5jdXJyZW50UGFnZSA9PT0gMVwiXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCJwYWdpbmF0b3IuZ29Ub1BhZ2UoMSlcIj57e3BhZ2luYXRvci5vcHRpb25zLmxhYmVscy5maXJzdH19PC9tZC1idXR0b24+XG4gICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxuICAgICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwicGFnaW5hdG9yLmN1cnJlbnRQYWdlID09PSAxXCJcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5wcmV2aW91c1BhZ2UoKVwiPnt7cGFnaW5hdG9yLm9wdGlvbnMubGFiZWxzLnByZXZpb3VzfX08L21kLWJ1dHRvbj5cbiAgICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXG4gICAgICAgICAgICAgICAgbmctcmVwZWF0PVwibiBpbiBwYWdpbmF0b3IucGFnZXMocylcIlxuICAgICAgICAgICAgICAgIG5nLWNsYXNzPVwieydtZC1wcmltYXJ5JzogbiA9PSBwYWdpbmF0b3IuY3VycmVudFBhZ2V9XCJcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5nb1RvUGFnZShuKVwiXG4gICAgICAgICAgICAgICAgbmctYmluZD1cIm5cIj4xPC9tZC1idXR0b24+XG4gICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcbiAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCJwYWdpbmF0b3IuY3VycmVudFBhZ2UgPT0gcGFnaW5hdG9yLm51bWJlck9mUGFnZXNcIlxuICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5uZXh0UGFnZSgpXCI+e3twYWdpbmF0b3Iub3B0aW9ucy5sYWJlbHMubmV4dH19PC9tZC1idXR0b24+XG4gICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcbiAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCJwYWdpbmF0b3IuY3VycmVudFBhZ2UgPT0gcGFnaW5hdG9yLm51bWJlck9mUGFnZXNcIlxuICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5nb1RvUGFnZShwYWdpbmF0b3IubnVtYmVyT2ZQYWdlcylcIj57e3BhZ2luYXRvci5vcHRpb25zLmxhYmVscy5sYXN0fX08L21kLWJ1dHRvbj5cbiAgICAgICAgICA8L3NlY3Rpb24+XG4gICAgICAgICAgPHNlY3Rpb24gbGF5b3V0PVwicm93XCIgbGF5b3V0LWFsaWduPVwiY2VudGVyIGNlbnRlclwiXG4gICAgICAgICAgICBuZy1zaG93PVwicGFnaW5hdG9yLnRvdGFsID4gMFwiPlxuICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiIHN0eWxlPVwiY3Vyc29yOiBkZWZhdWx0O1wiXG4gICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwidHJ1ZVwiIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6J2RlZmF1bHQtYWNjZW50J31cIj5Ub3RhbDoge3twYWdpbmF0b3IudG90YWx9fSByZWdpc3RybyhzKTwvbWQtYnV0dG9uPlxuICAgICAgICAgIDwvc2VjdGlvbj5cbiAgICAgICAgPC9zZWN0aW9uPmBcbiAgICB9O1xuICB9XG5cbn0pKCk7XG4iLCIvKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJylcbiAgICAuZmFjdG9yeSgnUHJQYWdpbmF0aW9uJywgcGFnaW5hdGlvblNlcnZpY2UpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gcGFnaW5hdGlvblNlcnZpY2UoKSB7XG5cbiAgICAvKipcbiAgICAgKiBDcmlhIGUgcmV0b3JuYSB1bWEgaW5zdGFuY2lhIGRvIG9iamV0byBwYWdpbmFkb3IuXG4gICAgICpcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBzZWFyY2hNZXRob2QgLSBmdW7Dp8OjbyByZXNwb25zw6F2ZWwgcG9yIGNhcnJlZ2FyIG9zIGRhZG9zXG4gICAgICAgZSBxdWUgdmFpIHNlciBjaGFtYWRhIHF1YW5kbyBvIHVzdcOhcmlvIGNsaWNhciBlbSB1bWEgcMOhZ2luYVxuICAgICAqIEBwYXJhbSB7aW50fSBwZXJQYWdlIC0gTsO6bWVybyBkZSBpdGVucyBwb3IgcMOhZ2luYS4gUGFkcsOjbyDDqSAxMC5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gX29wdGlvbnMgLSBPYmpldG8gY29udGVuZG8gYXMgZGVtYWlzIGNvbmZpZ3VyYcOnw7Vlc1xuICAgICAqL1xuICAgIHZhciBQclBhZ2luYWNhbyA9IGZ1bmN0aW9uKHNlYXJjaE1ldGhvZCwgcGVyUGFnZSwgX29wdGlvbnMpIHtcbiAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICBtYXhQYWdlczogMTAsXG4gICAgICAgIGxhYmVsczoge1xuICAgICAgICAgIGZpcnN0OiAnwqvCqycsXG4gICAgICAgICAgcHJldmlvdXM6ICfCqycsXG4gICAgICAgICAgbmV4dDogJ8K7JyxcbiAgICAgICAgICBsYXN0OiAnwrvCuydcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvL3NvYnJlZXNjcmV2ZSBvcyBwYXJhbWV0cm9zIHBhZHLDtWVzXG4gICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChwZXJQYWdlKSkge1xuICAgICAgICBwZXJQYWdlID0gMTA7XG4gICAgICB9XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChfb3B0aW9ucykpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKF9vcHRpb25zLm1heFBhZ2VzKSkge1xuICAgICAgICAgIG9wdGlvbnMubWF4UGFnZXMgPSBfb3B0aW9ucy5tYXhQYWdlcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoX29wdGlvbnMubGFiZWxzKSkge1xuICAgICAgICAgIG9wdGlvbnMubGFiZWxzID0gX29wdGlvbnMubGFiZWxzO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vY2FsY3VsYSBxdWFudGFzIHDDoWdpbmFzIHbDo28gc2VyIGV4aWJpZGFzIG5hIHBhcnRlIGludGVybWVkaWFyaWEgZGEgcGFnaW5hw6fDo29cbiAgICAgIG9wdGlvbnMubWF4UGFnZXNJbm5lciA9IE1hdGguZmxvb3Iob3B0aW9ucy5tYXhQYWdlcyAvIDIpO1xuXG4gICAgICAvL0NyaWEgbyBvYmpldG8gcGFnaW5hZG9yIGNvbSBvcyBwYXJhbWV0cm9zIGluaWNpYWlzXG4gICAgICB0aGlzLnNlYXJjaE1ldGhvZCA9IHNlYXJjaE1ldGhvZDtcbiAgICAgIHRoaXMubnVtYmVyT2ZQYWdlcyA9IDE7XG4gICAgICB0aGlzLnRvdGFsID0gMDtcbiAgICAgIHRoaXMucGVyUGFnZSA9IHBlclBhZ2U7XG4gICAgICB0aGlzLmN1cnJlbnRQYWdlID0gMDtcbiAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYSBvIG7Dum1lcm8gZGUgcMOhZ2luYXMgcXVlIHZhaSBzZXIgZXhpYmlkYSBiYXNlYWRvIG5vIHRvdGFsIGRlXG4gICAgICogaXRlbnMgY29tIGEgcGVyUGFnZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbnR9IHRvdGFsIC0gdG90YWwgZGUgaXRlbnNcbiAgICAgKi9cbiAgICBQclBhZ2luYWNhby5wcm90b3R5cGUuY2FsY051bWJlck9mUGFnZXMgPSBmdW5jdGlvbih0b3RhbCkge1xuICAgICAgdGhpcy50b3RhbCA9IHRvdGFsO1xuXG4gICAgICBpZiAodG90YWwgPD0gMCkge1xuICAgICAgICB0aGlzLm51bWJlck9mUGFnZXMgPSAxXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm51bWJlck9mUGFnZXMgPSBNYXRoLmZsb29yKHRvdGFsIC8gdGhpcy5wZXJQYWdlKSArICh0b3RhbCAlIHRoaXMucGVyUGFnZSA+IDAgPyAxIDogMCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFZlcmlmaWNhIGFzIHDDoWdpbmFzIHF1ZSBkZXZlbSBzZXIgZXhpYmlkYXNcbiAgICAgKi9cbiAgICBQclBhZ2luYWNhby5wcm90b3R5cGUucGFnZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciByZXQgPSBbXTtcblxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gdGhpcy5udW1iZXJPZlBhZ2VzOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPT09IGkpIHtcbiAgICAgICAgICByZXQucHVzaChpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA8PSAodGhpcy5vcHRpb25zLm1heFBhZ2VzSW5uZXIgKyAxKSkge1xuICAgICAgICAgICAgaWYgKGkgPD0gdGhpcy5vcHRpb25zLm1heFBhZ2VzKSB7XG4gICAgICAgICAgICAgIHJldC5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoKGkgPj0gdGhpcy5jdXJyZW50UGFnZSAtIHRoaXMub3B0aW9ucy5tYXhQYWdlc0lubmVyKSAmJlxuICAgICAgICAgICAgICAoaSA8PSB0aGlzLmN1cnJlbnRQYWdlICsgdGhpcy5vcHRpb25zLm1heFBhZ2VzSW5uZXIpKSB7XG4gICAgICAgICAgICAgIHJldC5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJldDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FycmVnYSBvcyBkYWRvcyBkYSBww6FnaW5hIGFudGVyaW9yXG4gICAgICovXG4gICAgUHJQYWdpbmFjYW8ucHJvdG90eXBlLnByZXZpb3VzUGFnZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPiAxKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoTWV0aG9kKHRoaXMuY3VycmVudFBhZ2UgLSAxKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FycmVnYSBvcyBkYWRvcyBkYSBwcsOzeGltYSBww6FnaW5hXG4gICAgICovXG4gICAgUHJQYWdpbmFjYW8ucHJvdG90eXBlLm5leHRQYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA8IHRoaXMubnVtYmVyT2ZQYWdlcykge1xuICAgICAgICB0aGlzLnNlYXJjaE1ldGhvZCh0aGlzLmN1cnJlbnRQYWdlICsgMSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENhcnJlZ2Egb3MgZGFkb3MgZGEgcMOhZ2luYSBpbmZvcm1hZGFcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW50fSBwYWdlIC0gcGFnaW5hIHF1ZSBkZXZlIHNlciBjYXJyZWdhZGFcbiAgICAgKi9cbiAgICBQclBhZ2luYWNhby5wcm90b3R5cGUuZ29Ub1BhZ2UgPSBmdW5jdGlvbihwYWdlKSB7XG4gICAgICBpZiAocGFnZSA+PSAxICYmIHBhZ2UgPD0gdGhpcy5udW1iZXJPZlBhZ2VzKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoTWV0aG9kKHBhZ2UpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgZ2V0SW5zdGFuY2U6IGZ1bmN0aW9uKHNlYXJjaE1ldGhvZCwgcGVyUGFnZSwgX29wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQclBhZ2luYWNhbyhzZWFyY2hNZXRob2QsIHBlclBhZ2UsIF9vcHRpb25zKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbn0pKCk7XG4iLCIvKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLyoqXG4gICAqIERpcmV0aXZhIHF1ZSBleGliZSB1bSBzcGlubmVyIHNlbXByZSBxdWUgdW0gYnJvYWRjYXN0LCBtYW51YWxtZW50ZSwgw6kgZGlzcGFyYWRvXG4gICAqL1xuICAvKiogQG5nSW5qZWN0ICovXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCduZ1Byb2RlYicpXG4gICAgLmNvbXBvbmVudCgncHJTcGlubmVyJywge1xuICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPG1kLXByb2dyZXNzLWxpbmVhciBjbGFzcz1cInNwaW4tbGFiZWwtY29tcG9uZW50IHt7OjokY3RybC5jb2xvcn19XCJcbiAgICAgICAgICBuZy1zdHlsZT1cIiRjdHJsLnN0eWxlXCJcbiAgICAgICAgICBtZC1tb2RlPVwiaW5kZXRlcm1pbmF0ZVwiXG4gICAgICAgICAgbmctc2hvdz1cIiRjdHJsLnNwaW5uZXIgJiYgJGN0cmwuc3Bpbm5lci5zaG93XCI+PC9tZC1wcm9ncmVzcy1saW5lYXI+XG4gICAgICAgIGAsXG4gICAgICBiaW5kaW5nczoge1xuICAgICAgICBwb3NpdGlvbjogJ0AnLFxuICAgICAgICBjb2xvcjogJ0AnXG4gICAgICB9LFxuICAgICAgY29udHJvbGxlcjogWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgICAgICAgdmFyIGN0cmwgPSB0aGlzO1xuXG4gICAgICAgIGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIC8vRGVmaW5lIGEgcG9zacOnw6NvXG4gICAgICAgICAgY3RybC5zdHlsZSA9IHsgcG9zaXRpb246IGFuZ3VsYXIuaXNEZWZpbmVkKGN0cmwucG9zaXRpb24pID8gY3RybC5wb3NpdGlvbiA6ICdmaXhlZCcgfTtcbiAgICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChjdHJsLmNvbG9yKSkgY3RybC5jb2xvciA9ICdtZC1wcmltYXJ5JztcbiAgICAgICAgfTtcbiAgICAgICAgLy9jb21wb3J0YW1lbnRvIHBhZHLDo29cbiAgICAgICAgY3RybC5zcGlubmVyID0ge1xuICAgICAgICAgIHNob3c6IGZhbHNlXG4gICAgICAgIH07XG5cbiAgICAgICAgLy9Fc2N1dGEgbyBjYW5hbCBlbWl0aWRvIHZpYSBicm9hZGNhc3RcbiAgICAgICAgLy9wYXJhIGV4aWJpci9lc2NvbmRlciBvIGNvbXBvbmVudGVcbiAgICAgICAgJHNjb3BlLiRvbignc2hvdy1zcGlubmVyJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY3RybC5zcGlubmVyID0ge1xuICAgICAgICAgICAgc2hvdzogdHJ1ZVxuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kb24oJ2hpZGUtc3Bpbm5lcicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGN0cmwuc3Bpbm5lciA9IHtcbiAgICAgICAgICAgIHNob3c6IGZhbHNlXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICB9XVxuICAgIH0pO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJylcbiAgICAuZmFjdG9yeSgnUHJTcGlubmVyJywgc3Bpbm5lclNlcnZpY2UpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gc3Bpbm5lclNlcnZpY2UoJHJvb3RTY29wZSkge1xuICAgIHJldHVybiB7XG4gICAgICBzaG93OiBzaG93LFxuICAgICAgaGlkZTogaGlkZVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBFeGliZSBvIHNwaW5uZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzaG93KCkge1xuICAgICAgLy9lbWl0ZSBvIHNpbmFsIHBhcmEgYSBkaXJldGl2YSBpbmZvcm1hbmRvIHF1ZSBvIGNvbXBvbmVudGUgc3Bpbm5lciBkZXZlIHNlciBleGliaWRvXG4gICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3Nob3ctc3Bpbm5lcicpO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogRXNjb25kZSBvIHNwaW5uZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBoaWRlKCkge1xuICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdoaWRlLXNwaW5uZXInKTtcbiAgICB9XG4gIH1cblxufSkoKTtcbiIsIi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5mYWN0b3J5KCdQclRvYXN0JywgVG9hc3QpO1xuXG4gIC8qKlxuICAgKiBTZXJ2acOnbyBxdWUgZW5jYXBzdWxhIGUgYW1wbGlhIG9zIHNlcnZpw6dvcyBkbyBhbmd1bGFyIHRvYXN0clxuICAgKi9cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBUb2FzdCgkbWRUb2FzdCwgbG9kYXNoLCAkbG9nLCBQckRpYWxvZykge1xuICAgIHZhciBvYmogPSB7XG4gICAgICBzdWNjZXNzOiBzdWNjZXNzLFxuICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgZXJyb3JWYWxpZGF0aW9uOiBlcnJvclZhbGlkYXRpb24sXG4gICAgICBpbmZvOiBpbmZvLFxuICAgICAgd2Fybjogd2FybixcbiAgICAgIGhpZGU6IGhpZGVcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRXhpYmUgdW1hIG5vdGlmaWNhw6fDo29cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtc2cgLSBNZW5zYWdlbSBkYSBub3RpZmljYcOnw6NvXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbG9yIC0gQ29yIGRlIGZ1bmRvIGRhIG5vdGlmaWNhw6fDo29cbiAgICAgKlxuICAgICAgQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHRvYXN0KG1zZywgY29sb3IsIG9wdGlvbnMpIHtcbiAgICAgIGlmIChtc2cpIHtcbiAgICAgICAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgICAgICA8bWQtdG9hc3Q+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC10b2FzdC1jb250ZW50XCIgbWQtY29sb3JzPVwiOjp7YmFja2dyb3VuZDonJHtjb2xvcn0nfVwiPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibWQtdG9hc3QtdGV4dFwiIGZsZXg+JHttc2d9PC9zcGFuPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvbWQtdG9hc3Q+XG4gICAgICAgICAgYCxcbiAgICAgICAgICBwb3NpdGlvbjogJ3RvcCByaWdodCdcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoYW5ndWxhci5pc09iamVjdChvcHRpb25zKSkgZGVmYXVsdE9wdGlvbnMgPSBhbmd1bGFyLm1lcmdlKGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuICAgICAgICByZXR1cm4gJG1kVG9hc3Quc2hvdyhkZWZhdWx0T3B0aW9ucyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkbG9nLmRlYnVnKCdNZW5zYWdlbSBwYXJhIHNlciBleGliaWRhIG5vIFRvYXN0IG7Do28gZm9pIGluZm9ybWFkYScpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVzY29uZGUgdW1hIG5vdGlmaWNhw6fDo29cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvYmplY3QgLSBVbSBhcmd1bWVudG8gb3BjaW9uYWwgcGFyYSBhIHByb21pc2UgYSBzZXIgcmVzb2x2aWRhXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7cHJvbWlzc2V9IC0gUmV0b3JuYSB1bWEgcHJvbWlzc2UgcXVlIMOpIGV4ZWN1dGFkYSBxdWFuZG8gYSBub3RpZmljYcOnw6NvIMOpIHJlbW92aWRhIGRvIERPTVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhpZGUob2JqZWN0KSB7XG4gICAgICByZXR1cm4gJG1kVG9hc3QuaGlkZShvYmplY3QpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Y2Nlc3MobXNnLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gdG9hc3QobXNnLCAnZ3JlZW4nLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGliZSB1bSB0b2FzdCBjb20gYXMgbWVuc2FnZW5zIGRlIGVycm8gcmVmZXJlbnRlIGEgdmFsaWRhw6fDo28uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZyB8IG9iamVjdCB8IGFycmF5fSBlcnJvcnMgLSBTdHJpbmcsIE9iamV0byBvdSBBcnJheSBjb250ZW5kbyBhcyBtZW5zYWdlbnMgZGUgZXJyby5cbiAgICAgKiBTdXBvcnRhIGRpZmVyZW50ZSBmb3JtYXRvczpcbiAgICAgKlxuICAgICAqIFBhcmEgdmFsaWRhw6fDtWVzIGRlIGF0cmlidXRvc1xuICAgICAqICAge1xuICAgICAqICAgIFwibm9tZS1kby1hdHJpYnV0bzFcIjogW1wibWVuc2FnZW0gZGUgZXJybyAxXCIsIFwibWVuc2FnZW0gZGUgZXJybyAyXCJdLFxuICAgICAqICAgIFwibm9tZS1kby1hdHJpYnV0bzJcIjogW1wibWVuc2FnZW0gZGUgZXJybyAxXCJdXG4gICAgICogICB9XG4gICAgICpcbiAgICAgKiBvdSAtIFBhcmEgdsOhcmlhcyBtZW5zYWdlbnMgc2ltcGxlc1xuICAgICAqICAgW1xuICAgICAqICAgICdNZW5zYWdlbSAxJyxcbiAgICAgKiAgICAnTWVuc2FnZW0gMidcbiAgICAgKiAgIF1cbiAgICAgKlxuICAgICAqICBvdSAtIFBhcmEgMSDDum5pY2EgbWVuc2FnZW1cbiAgICAgKiAgIFwiTWVuc2FnZW0gMVwiXG4gICAgICpcbiAgICAgKiAgb3UgLSBQYXJhIGV4Y2VwdGlvbnMgLSBOZXN0ZSBjYXNvIHVzYSB1bSBQckRpYWxvZ1xuICAgICAqICAge1xuICAgICAqICAgICBtZXNzYWdlOiAnRXhjZXB0aW9uIERlc2NvbmhlY2lkYScsXG4gICAgICogICAgIHNvdXJjZTogJ1N0YXJ0ZXJQYWNrLkNvbnRyb2xsZXJzLlN1cHBvcnRDb250cm9sbGVyLmxhbmdzKCknLFxuICAgICAqICAgICBsaW5lOiAyMSxcbiAgICAgKiAgICAgc3RhY2t0cmFjZTogJ2F0IFN0YXJ0ZXJQYWNrLkNvbnRyb2xsZXJzLlN1cHBvcnRDb250cm9sbGVyLmxhbmdzKCkgaW4gL2hvbWUvd29ya3NwYS4uLidcbiAgICAgKiAgIH1cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbXNnIC0gT3BjaW9uYWwuIE1lbnNhZ2VtIGRlIGVycm8uXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXJyb3IoZXJyb3JzLCBvcHRpb25zID0ge30pIHtcbiAgICAgIC8vc2UgZm9yIHVtIG9iamV0byBjb250ZW5kbyBvcyBlcnJvcywgaXRlcmEgc29icmUgb3MgYXRyaWJ1dG9zIGRvIG1lc21vXG4gICAgICAvL3BhcmEgZXhpYmlyIGEocykgbWVuc2FnZW0obnMpIGRlIGVycm8gYXRyaWJ1aWRhc1xuICAgICAgaWYgKGFuZ3VsYXIuaXNPYmplY3QoZXJyb3JzKSkge1xuICAgICAgICB2YXIgZXJyb3JTdHIgPSAnJztcblxuICAgICAgICBpZiAoY2hlY2tFcnJvcklzVW5rbm93bkV4Y2VwdGlvbihlcnJvcnMpKSB7XG4gICAgICAgICAgZXJyb3JTdHIgKz0gJ01lc3NhZ2U6ICcgKyBlcnJvcnMubWVzc2FnZVxuICAgICAgICAgICAgKyAnPGJyLz5Tb3VyY2U6ICcgKyBlcnJvcnMuc291cmNlXG4gICAgICAgICAgICArICc8YnIvPkxpbmU6ICcgKyBlcnJvcnMubGluZVxuICAgICAgICAgICAgKyAnPGJyLz48YnIvPlN0YWNrVHJhY2U6ICc7XG5cbiAgICAgICAgICB2YXIgc3RlcHMgPSBlcnJvcnMuc3RhY2t0cmFjZS5zcGxpdCgnIGF0ICcpO1xuXG4gICAgICAgICAgaWYgKHN0ZXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHN0ZXBzLmZvckVhY2goZnVuY3Rpb24oc3RlcCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgZXJyb3JTdHIgKz0gICc8YnIvPlN0ZXAgJyArIChpbmRleCArIDEpICsgJzogJyArIHN0ZXA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXJyb3JTdHIgKz0gIGVycm9ycy5zdGFja3RyYWNlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBQckRpYWxvZy5hbGVydCh7XG4gICAgICAgICAgICB0aXRsZTogJ0V4Y2VwdGlvbicsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogZXJyb3JTdHJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBleGliZSBhcyBtZW5zYWdlbSBkZSBlcnJvIGNvbnRpZGFzIG5vIG9iamV0b1xuICAgICAgICAgIC8vICB7XG4gICAgICAgICAgLy8gICAgXCJuYW1lXCI6IFtcIm8gY2FtcG8gbm9tZSDDqSBvYnJpZ2F0w7NyaW9cIl0sXG4gICAgICAgICAgLy8gICAgXCJwYXNzd29yZFwiOiBbXG4gICAgICAgICAgLy8gICAgICBcIkEgY29uZmlybWHDp8OjbyBkZSBzZW5oYSBuw6NvIGNvbmZlcmUuXCIsXG4gICAgICAgICAgLy8gICAgICBcInNlbmhhIGRldmUgdGVyIG5vIG3DrW5pbW8gNiBjYXJhY3RlcmVzLlwiXG4gICAgICAgICAgLy8gICAgXVxuICAgICAgICAgIC8vICB9XG4gICAgICAgICAgbG9kYXNoLmZvckluKGVycm9ycywgZnVuY3Rpb24oa2V5RXJyb3JzKSB7XG4gICAgICAgICAgICBlcnJvclN0ciArPSBidWlsZEFycmF5TWVzc2FnZShrZXlFcnJvcnMpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZXJyb3JzID0gZXJyb3JTdHI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGVycm9ycykpIHtcbiAgICAgICAgICBlcnJvcnMgPSBidWlsZEFycmF5TWVzc2FnZShlcnJvcnMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0b2FzdChlcnJvcnMsICdyZWQtQTcwMCcsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJ1aWxkQXJyYXlNZXNzYWdlKGFyck1zZykge1xuICAgICAgdmFyIG1zZyA9ICAnJztcblxuICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShhcnJNc2cpKSB7XG4gICAgICAgIC8vaXRlcmEgc29icmUgb3MgZXJyb3MgZGUgdW0gYXRyaWJ1dG9cbiAgICAgICAgYXJyTXNnLmZvckVhY2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICBtc2cgKz0gZXJyb3IgKyAnPGJyLz4nO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1zZyArPSBhcnJNc2cgKyAnPGJyLz4nO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbXNnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4aWJlIHVtIHRvYXN0IGNvbSBhcyBtZW5zYWdlbnMgZGUgZXJybyByZWZlcmVudGUgYSB2YWxpZGHDp8Ojby5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0IHwgYXJyYXl9IGVycm9ycyAtIE9iamV0byBvdSBBcnJheSBjb250ZW5kbyBhcyBtZW5zYWdlbnMgZGUgZXJyby4gRGV2ZSBlc3RhclxuICAgICAqIG5vIHNlZ3VpbnRlIGZvcm1hdG8uXG4gICAgICogICB7XG4gICAgICogICAgXCJub21lLWRvLWF0cmlidXRvMVwiOiBbXCJtZW5zYWdlbSBkZSBlcnJvIDFcIiwgXCJtZW5zYWdlbSBkZSBlcnJvIDJcIl0sXG4gICAgICogICAgXCJub21lLWRvLWF0cmlidXRvMlwiOiBbXCJtZW5zYWdlbSBkZSBlcnJvIDFcIl1cbiAgICAgKiAgIH1cbiAgICAgKiBvdVxuICAgICAqICAgW1xuICAgICAqICAgICdNZW5zYWdlbSAxJyxcbiAgICAgKiAgICAnTWVuc2FnZW0gMidcbiAgICAgKiAgIF1cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbXNnIC0gT3BjaW9uYWwuIE1lbnNhZ2VtIGRlIGVycm8uXG4gICAgICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgLSBPcHRpb25zIGRhIGRvY3VtZW50YcOnw6NvIGRvICRtZFRvYXN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gZXJyb3JWYWxpZGF0aW9uKGVycm9ycywgbXNnLCBvcHRpb25zKSB7XG4gICAgICBvYmouZXJyb3IoKGFuZ3VsYXIuaXNBcnJheShlcnJvcnMpIHx8IGFuZ3VsYXIuaXNPYmplY3QoZXJyb3JzKSkgPyBlcnJvcnMgOiBtc2csIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluZm8obXNnLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gdG9hc3QobXNnLCAndGVhbCcsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdhcm4obXNnLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gdG9hc3QobXNnLCAnd2FybicsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNoZWNrRXJyb3JJc1Vua25vd25FeGNlcHRpb24oZXJyb3JzKSB7XG4gICAgICByZXR1cm4gKGFuZ3VsYXIuaXNPYmplY3QoZXJyb3JzKVxuICAgICAgICAmJiBhbmd1bGFyLmlzRGVmaW5lZChlcnJvcnMubGluZSlcbiAgICAgICAgJiYgYW5ndWxhci5pc0RlZmluZWQoZXJyb3JzLnNvdXJjZSlcbiAgICAgICAgJiYgYW5ndWxhci5pc0RlZmluZWQoZXJyb3JzLnN0YWNrdHJhY2UpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gb2JqO1xuICB9XG5cbn0oKSk7XG4iLCIvKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZGlyZWN0aXZlKCdwclVwbG9hZGVyQmFzZTY0JywgZnVuY3Rpb24oJHEpIHtcbiAgICB2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcbiAgICAgICAgaWYgKCFuZ01vZGVsKSByZXR1cm47XG5cbiAgICAgICAgbmdNb2RlbC4kcmVuZGVyID0gZnVuY3Rpb24oKSB7fTtcblxuICAgICAgICBlbGVtZW50LmJpbmQoJ2NoYW5nZScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICB2YXIgZWxlbWVudCA9IGUudGFyZ2V0O1xuXG4gICAgICAgICAgJHEuYWxsKHNsaWNlLmNhbGwoZWxlbWVudC5maWxlcywgMCkubWFwKHJlYWRGaWxlKSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHZhbHVlcykge1xuICAgICAgICAgICAgICBpZiAoZWxlbWVudC5tdWx0aXBsZSkgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKHZhbHVlcyk7XG4gICAgICAgICAgICAgIGVsc2UgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKHZhbHVlcy5sZW5ndGggPyB2YWx1ZXNbMF0gOiBudWxsKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgZnVuY3Rpb24gcmVhZEZpbGUoZmlsZSkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cbiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZS50YXJnZXQucmVzdWx0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICAgIH1cbiAgICB9O1xuXG4gIH0pO1xuXG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
