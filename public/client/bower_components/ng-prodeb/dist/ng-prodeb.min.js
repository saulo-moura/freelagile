"use strict";!function(){angular.module("ngProdeb",["ngMaterial","md.data.table","ngMaterialDatePicker","angularFileUpload"])}(),function(){function n(n,e,t,r,a){n.theme("default").primaryPalette("indigo").accentPalette("amber"),t.locale("pt-BR"),t.createFromInputFallback=function(n){n._d=new Date(n._i)},a.errorOnUnhandledRejections(!1),angular.forEach(r,function(n){e.icon(n.id,n.url)})}n.$inject=["$mdThemingProvider","$mdIconProvider","moment","PrIcons","$qProvider"],angular.module("ngProdeb").config(n)}(),function(){angular.module("ngProdeb").constant("lodash",_).constant("alasql",alasql).constant("moment",moment)}(),function(){function n(n,e){angular.forEach(e,function(e){n.put(e.url,e.svg)})}n.$inject=["$templateCache","PrIcons"],angular.module("ngProdeb").run(n)}(),function(){angular.module("ngProdeb").directive("prDateTimePicker",["moment",function(n){function e(e){var t=angular.isUndefined(e.autoOk)||"true"===e.autoOk,r=angular.isDefined(e.withTime)&&"true"===e.withTime,a=angular.isUndefined(e.withMinutesPicker)||"true"===e.withMinutesPicker,o=e.format||(r?"DD/MM/YYYY HH:mm":"DD/MM/YYYY");return'\n            <input\n              id="'+e.id+'"\n              mdc-datetime-picker\n              ng-model="ngModel"\n              show-todays-date\n              date="true"\n              time="'+r+'"\n              minutes="'+a+'"\n              cancel-text="Cancelar"\n              today-text="Hoje"\n              auto-ok="'+t+'"\n              format="'+o+'"\n              min-date="'+(angular.isDefined(e.minDate)?n(e.minDate).format(o):"")+'"\n              max-date="\''+(angular.isDefined(e.maxDate)?n(e.maxDate).format(o):"")+"'\">\n            </input>\n        "}return{template:function t(n,r){var t=e(r);return t},scope:{ngModel:"=",layout:"=",id:"=",withTime:"=?",withMinutesPicker:"=?",autoOk:"=?",format:"=?",minDate:"=?",maxDate:"=?"}}}])}(),function(){function n(n,e,t,r,a,o){function i(e){if(!angular.isObject(e))return void n.error("PrDialog: Parâmetro inválido, é esperando um objeto como parâmetro.");var t={hasBackdrop:!1,escapeToClose:!1,bindToController:!0,clickOutsideToClose:!0,autoWrap:!0,skipHide:!0,locals:{},zIndex:75,fullscreen:!1};return angular.isDefined(e.locals)&&(t.locals=e.locals,delete e.locals),angular.merge(t,e)}function l(n){var t=i(n);return t.template=' <md-dialog flex=50 aria-label="{{::ctrl.title}}">\n              <md-toolbar md-scroll-shrink>\n                <div class="md-toolbar-tools">\n                  <h3>\n                    <span>{{::ctrl.title}}</span>\n                  </h3>\n                </div>\n              </md-toolbar>\n              <md-dialog-content layout-margin>\n                <p>{{::ctrl.description}}</p>\n              </md-dialog-content>\n              <md-dialog-actions>\n                <md-button class="md-raised"\n                  md-colors="::{background:\'default-{{ctrl.yesBgColor}}\'}"\n                  ng-click="ctrl.yesAction()">Sim</md-button>\n                <md-button class="md-raised"\n                  md-colors="::{background:\'default-{{ctrl.noBgColor}}\'}"\n                  ng-click="ctrl.noAction()">Não</md-button>\n              </md-dialog-actions>\n            </md-dialog>\n          ',t.locals={title:angular.isDefined(t.title)?t.title:"",description:angular.isDefined(t.description)?t.description:"",yesBgColor:angular.isDefined(t.yesBgColor)?t.yesBgColor:"primary",noBgColor:angular.isDefined(t.noBgColor)?t.noBgColor:"accent"},t.controller=["$mdDialog",function(n){function e(){n.cancel()}function t(){n.hide()}var r=this;r.noAction=e,r.yesAction=t}],t.controllerAs="ctrl",t.clickOutsideToClose=!1,t.hasBackdrop=!0,e.show(t)}function s(t){var r=i(t);return angular.isUndefined(r.templateUrl)&&angular.isUndefined(r.template)?void n.error("PrDialog: templateUrl ou template indefinido, é esperando um templateUrl ou um template como atributo."):(r=u(r),r.hasBackdrop=!1,e.show(r))}function u(n){if(n.hasBackdrop){var e=t.createBackdrop(r,"md-dialog-backdrop md-opaque md-backdrop-custom");a.enter(e,angular.element(o.find("body")));var i=n.onRemoving;n.onRemoving=function(){e.remove(),angular.isFunction(i)&&i.call()};var l=n.onComplete;n.onComplete=function(e,t){var r=parseInt(n.zIndex,10);angular.element(o[0].querySelector(".md-backdrop-custom")).css("z-index",r),t.css("z-index",r+1),angular.isFunction(l)&&l.call()}}return n}function c(){e.hide()}return{custom:s,confirm:l,close:c}}n.$inject=["$log","$mdDialog","$mdUtil","$rootScope","$animate","$document"],angular.module("ngProdeb").factory("PrDialog",n)}(),function(){function n(n,e,t){function r(e,t,r,a){var o={headers:!0};return angular.isObject(a)&&angular.merge(o,a),angular.isUndefined(r)&&(r="export"),o.where=angular.isDefined(o.where)?" WHERE "+o.where:" ",o.orderBy=angular.isDefined(o.orderBy)?" ORDER BY "+o.orderBy:" ",r=r+"."+o.formatTo,n.promise("SELECT "+i(e)+" INTO "+o.formatTo.toUpperCase()+"(?, ?) FROM ? "+o.where+o.orderBy,[r,o,t])}function a(n,e,t,a){return angular.isUndefined(a)&&(a={}),a.formatTo="csv",r(n,e,t,a)}function o(n,e,t,a){return angular.isUndefined(a)&&(a={}),a.formatTo="xlsx",r(n,e,t,a)}function i(n){return angular.isArray(n)&&(n=e.map(n,function(n){return n.name+" as ["+n.label+"]"}).join(", ")),n}var l={exportToExcel:o,exportToCSV:a};return n.fn.formatDate=function(n,e){return t("prDate")(n,e)},l}n.$inject=["alasql","lodash","$filter"],angular.module("ngProdeb").factory("PrFile",n)}(),function(){function n(n){return function(e,t){var r="DD/MM/YYYY";return angular.isDefined(t)?n(e,t).format(r):n(e).format(r)}}n.$inject=["moment"],angular.module("ngProdeb").filter("prDate",n)}(),function(){function n(n){return function(e){return n(e).format("DD/MM/YYYY HH:mm")}}n.$inject=["moment"],angular.module("ngProdeb").filter("prDatetime",n)}(),function(){function n(n){return function(e){return n("currency")(e,"R$ ")}}n.$inject=["$filter"],angular.module("ngProdeb").filter("real",n)}(),function(){angular.module("ngProdeb").constant("PrIcons",[{id:"pr-excel",url:"pr-excel.svg",svg:'<svg height="24" width="24" style="fill:#2E7D32" viewBox="0 0 24 24"><path d="M6,2H14L20,8V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V4A2,2 0 0,1 6,2M13,3.5V9H18.5L13,3.5M17,11H13V13H14L12,14.67L10,13H11V11H7V13H8L11,15.5L8,18H7V20H11V18H10L12,16.33L14,18H13V20H17V18H16L13,15.5L16,13H17V11Z" /></svg>'}])}(),function(){function n(){return{restrict:"AE",scope:{paginator:"="},template:'\n        <section class="pr-pagination" layout="row">\n          <section layout="row" layout-align="center center" layout-wrap\n            style="margin-right: 10px"\n            ng-show="paginator.numberOfPages > 1">\n              <md-button class="md-raised"\n                ng-disabled="paginator.currentPage === 1"\n                ng-click="paginator.goToPage(1)">{{paginator.options.labels.first}}</md-button>\n              <md-button class="md-raised"\n                ng-disabled="paginator.currentPage === 1"\n                ng-click="paginator.previousPage()">{{paginator.options.labels.previous}}</md-button>\n              <md-button class="md-raised"\n                ng-repeat="n in paginator.pages(s)"\n                ng-class="{\'md-primary\': n == paginator.currentPage}"\n                ng-click="paginator.goToPage(n)"\n                ng-bind="n">1</md-button>\n            <md-button class="md-raised"\n              ng-disabled="paginator.currentPage == paginator.numberOfPages"\n              ng-click="paginator.nextPage()">{{paginator.options.labels.next}}</md-button>\n            <md-button class="md-raised"\n              ng-disabled="paginator.currentPage == paginator.numberOfPages"\n              ng-click="paginator.goToPage(paginator.numberOfPages)">{{paginator.options.labels.last}}</md-button>\n          </section>\n          <section layout="row" layout-align="center center"\n            ng-show="paginator.total > 0">\n            <md-button class="md-raised" style="cursor: default;"\n              ng-disabled="true" md-colors="::{background:\'accent\'}">Total: {{paginator.total}} registro(s)</md-button>\n          </section>\n        </section>'}}angular.module("ngProdeb").directive("prPagination",n)}(),function(){function n(){var n=function(n,e,t){var r={maxPages:10,labels:{first:"««",previous:"«",next:"»",last:"»»"}};angular.isUndefined(e)&&(e=10),angular.isDefined(t)&&(angular.isDefined(t.maxPages)&&(r.maxPages=t.maxPages),angular.isDefined(t.labels)&&(r.labels=t.labels)),r.maxPagesInner=Math.floor(r.maxPages/2),this.searchMethod=n,this.numberOfPages=1,this.total=0,this.perPage=e,this.currentPage=0,this.options=r};return n.prototype.calcNumberOfPages=function(n){this.total=n,n<=0?this.numberOfPages=1:this.numberOfPages=Math.floor(n/this.perPage)+(n%this.perPage>0?1:0)},n.prototype.pages=function(){for(var n=[],e=1;e<=this.numberOfPages;e++)this.currentPage===e?n.push(e):this.currentPage<=this.options.maxPagesInner+1?e<=this.options.maxPages&&n.push(e):e>=this.currentPage-this.options.maxPagesInner&&e<=this.currentPage+this.options.maxPagesInner&&n.push(e);return n},n.prototype.previousPage=function(){this.currentPage>1&&this.searchMethod(this.currentPage-1)},n.prototype.nextPage=function(){this.currentPage<this.numberOfPages&&this.searchMethod(this.currentPage+1)},n.prototype.goToPage=function(n){n>=1&&n<=this.numberOfPages&&this.searchMethod(n)},{getInstance:function(e,t,r){return new n(e,t,r)}}}angular.module("ngProdeb").factory("PrPagination",n)}(),function(){angular.module("ngProdeb").component("prSpinner",{template:'\n        <md-progress-linear class="spin-label-component {{::$ctrl.color}}"\n          ng-style="$ctrl.style"\n          md-mode="indeterminate"\n          ng-show="$ctrl.spinner && $ctrl.spinner.show"></md-progress-linear>\n        ',bindings:{position:"@",color:"@"},controller:["$scope",function(n){var e=this;e.$onInit=function(){e.style={position:angular.isDefined(e.position)?e.position:"fixed"},angular.isUndefined(e.color)&&(e.color="md-primary")},e.spinner={show:!1},n.$on("show-spinner",function(){e.spinner={show:!0}}),n.$on("hide-spinner",function(){e.spinner={show:!1}})}]})}(),function(){function n(n){function e(){n.$broadcast("show-spinner")}function t(){n.$broadcast("hide-spinner")}return{show:e,hide:t}}n.$inject=["$rootScope"],angular.module("ngProdeb").factory("PrSpinner",n)}(),function(){function n(n,e,t){function r(e,r,a){if(e){var o={template:'\n            <md-toast>\n              <div class="md-toast-content" md-colors="::{background:\''+r+'\'}">\n                <span class="md-toast-text" flex>'+e+"</span>\n              </div>\n            </md-toast>\n          ",position:"top right"};return angular.isObject(a)&&(o=angular.merge(o,a)),n.show(o)}t.debug("Mensagem para ser exibida no Toast não foi informada")}function a(e){return n.hide(e)}function o(n,e){return r(n,"green",e)}function i(n,t){if(angular.isObject(n)){var a="";e.forIn(n,function(n){a+=l(n)}),n=a}else angular.isArray(n)&&(n=l(n));return r(n,"red-A700",t)}function l(n){var e="";return angular.isArray(n)?n.forEach(function(n){e+=n+"<br/>"}):e+=n+"<br/>",e}function s(n,e,t){d.error(angular.isArray(n)||angular.isObject(n)?n:e,t)}function u(n,e){return r(n,"teal",e)}function c(n,e){return r(n,"warn",e)}var d={success:o,error:i,errorValidation:s,info:u,warn:c,hide:a};return d}n.$inject=["$mdToast","lodash","$log"],angular.module("ngProdeb").factory("PrToast",n)}(),function(){angular.module("ngProdeb").directive("prUploaderBase64",["$q",function(n){var e=Array.prototype.slice;return{restrict:"A",require:"?ngModel",link:function(t,r,a,o){o&&(o.$render=function(){},r.bind("change",function(t){function r(e){var t=n.defer(),r=new FileReader;return r.onload=function(n){t.resolve(n.target.result)},r.onerror=function(n){t.reject(n)},r.readAsDataURL(e),t.promise}var a=t.target;n.all(e.call(a.files,0).map(r)).then(function(n){a.multiple?o.$setViewValue(n):o.$setViewValue(n.length?n[0]:null)})}))}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5nLXByb2RlYi5qcyIsImFwcC5qcyIsImFwcC5jb25maWcuanMiLCJuZy1wcm9kZWIubWluLmpzIiwiYXBwLmV4dGVybmFsLmpzIiwiYXBwLnJ1bi5qcyIsImRhdGVwaWNrZXIvcHItZGF0ZS10aW1lLXBpY2tlci5kaXJlY3RpdmUuanMiLCJkaWFsb2cvcHItZGlhbG9nLnNlcnZpY2UuanMiLCJmaWxlL3ByLWZpbGUuc2VydmljZS5qcyIsImZpbHRlcnMvcHItZGF0ZS5maWx0ZXIuanMiLCJmaWx0ZXJzL3ByLWRhdGV0aW1lLmZpbHRlci5qcyIsImZpbHRlcnMvcmVhbC5maWx0ZXIuanMiLCJpY29ucy9wci1pY29ucy5jb25zdGFudC5qcyIsInBhZ2luYXRpb24vcHItcGFnaW5hdGlvbi5kaXJlY3RpdmUuanMiLCJwYWdpbmF0aW9uL3ByLXBhZ2luYXRpb24uc2VydmljZS5qcyIsInNwaW5uZXIvcHItc3Bpbm5lci5jb21wb25lbnQuanMiLCJzcGlubmVyL3ByLXNwaW5uZXIuc2VydmljZS5qcyIsInRvYXN0L3ByLXRvYXN0LnNlcnZpY2UuanMiLCJ1cGxvYWRlci1iYXNlNjQvcHItdXBsb2FkZXItYmFzZTY0LmRpcmVjdGl2ZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJG1kVGhlbWluZ1Byb3ZpZGVyIiwiJG1kSWNvblByb3ZpZGVyIiwibW9tZW50IiwiUHJJY29ucyIsIiRxUHJvdmlkZXIiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiYWNjZW50UGFsZXR0ZSIsImxvY2FsZSIsImNyZWF0ZUZyb21JbnB1dEZhbGxiYWNrIiwiX2QiLCJEYXRlIiwiX2kiLCJlcnJvck9uVW5oYW5kbGVkUmVqZWN0aW9ucyIsImZvckVhY2giLCJpY29uIiwiaWQiLCJ1cmwiLCIkaW5qZWN0IiwiY29uc3RhbnQiLCJfIiwiYWxhc3FsIiwicnVuIiwiJHRlbXBsYXRlQ2FjaGUiLCJwdXQiLCJzdmciLCJkaXJlY3RpdmUiLCJidWlsZERhdGVQaWNrZXIiLCJhdHRyIiwiYXV0b09rIiwiaXNVbmRlZmluZWQiLCJ3aXRoVGltZSIsImlzRGVmaW5lZCIsIndpdGhNaW51dGVzUGlja2VyIiwiZm9ybWF0IiwibWluRGF0ZSIsIm1heERhdGUiLCJ0ZW1wbGF0ZSIsImVsZW1lbnQiLCJzY29wZSIsIm5nTW9kZWwiLCJsYXlvdXQiLCJkaWFsb2dTZXJ2aWNlIiwiJGxvZyIsIiRtZERpYWxvZyIsIiRtZFV0aWwiLCIkcm9vdFNjb3BlIiwiJGFuaW1hdGUiLCIkZG9jdW1lbnQiLCJidWlsZCIsImlzT2JqZWN0IiwiZXJyb3IiLCJkZWZhdWx0T3B0aW9ucyIsImhhc0JhY2tkcm9wIiwiZXNjYXBlVG9DbG9zZSIsImJpbmRUb0NvbnRyb2xsZXIiLCJjbGlja091dHNpZGVUb0Nsb3NlIiwiYXV0b1dyYXAiLCJza2lwSGlkZSIsImxvY2FscyIsInpJbmRleCIsImZ1bGxzY3JlZW4iLCJtZXJnZSIsImNvbmZpcm0iLCJvcHRpb25zIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInllc0JnQ29sb3IiLCJub0JnQ29sb3IiLCJjb250cm9sbGVyIiwibm9BY3Rpb24iLCJjYW5jZWwiLCJ5ZXNBY3Rpb24iLCJoaWRlIiwidm0iLCJ0aGlzIiwiY29udHJvbGxlckFzIiwic2hvdyIsImN1c3RvbSIsInRlbXBsYXRlVXJsIiwiYWRkQmFja2Ryb3AiLCJiYWNrZHJvcCIsImNyZWF0ZUJhY2tkcm9wIiwiZW50ZXIiLCJmaW5kIiwib3JpZ2luYWxPblJlbW92aW5nIiwib25SZW1vdmluZyIsInJlbW92ZSIsImlzRnVuY3Rpb24iLCJjYWxsIiwib3JpZ2luYWxPbkNvbXBsZXRlIiwib25Db21wbGV0ZSIsInBhcnNlSW50IiwicXVlcnlTZWxlY3RvciIsImNzcyIsImNsb3NlIiwiZmFjdG9yeSIsIlByRmlsZSIsImxvZGFzaCIsIiRmaWx0ZXIiLCJleHBvcnRUbyIsImZpZWxkcyIsImRhdGEiLCJmaWxlTmFtZSIsImRlZmF1bHRDb25maWciLCJoZWFkZXJzIiwid2hlcmUiLCJvcmRlckJ5IiwiZm9ybWF0VG8iLCJwcm9taXNlIiwiYnVpbGRGaWVsZHMiLCJ0b1VwcGVyQ2FzZSIsImV4cG9ydFRvQ1NWIiwiZXhwb3J0VG9FeGNlbCIsImlzQXJyYXkiLCJtYXAiLCJmaWVsZCIsIm5hbWUiLCJsYWJlbCIsImpvaW4iLCJvYmoiLCJmbiIsImZvcm1hdERhdGUiLCJkYXRlIiwicHJEYXRlIiwidmFsdWUiLCJpbnB1dEZvcm1hdCIsIm91dHB1dEZvcm1hdCIsImZpbHRlciIsInByRGF0ZXRpbWUiLCJyZWFsIiwicGFnaW5hdGlvbkRpcmVjdGl2ZSIsInJlc3RyaWN0IiwicGFnaW5hdG9yIiwicGFnaW5hdGlvblNlcnZpY2UiLCJQclBhZ2luYWNhbyIsInNlYXJjaE1ldGhvZCIsInBlclBhZ2UiLCJfb3B0aW9ucyIsIm1heFBhZ2VzIiwibGFiZWxzIiwiZmlyc3QiLCJwcmV2aW91cyIsIm5leHQiLCJsYXN0IiwibWF4UGFnZXNJbm5lciIsIk1hdGgiLCJmbG9vciIsIm51bWJlck9mUGFnZXMiLCJ0b3RhbCIsImN1cnJlbnRQYWdlIiwicHJvdG90eXBlIiwiY2FsY051bWJlck9mUGFnZXMiLCJwYWdlcyIsInJldCIsImkiLCJwdXNoIiwicHJldmlvdXNQYWdlIiwibmV4dFBhZ2UiLCJnb1RvUGFnZSIsInBhZ2UiLCJnZXRJbnN0YW5jZSIsImNvbXBvbmVudCIsImJpbmRpbmdzIiwicG9zaXRpb24iLCJjb2xvciIsIiRzY29wZSIsImN0cmwiLCIkb25Jbml0Iiwic3R5bGUiLCJzcGlubmVyIiwiJG9uIiwic3Bpbm5lclNlcnZpY2UiLCIkYnJvYWRjYXN0IiwiVG9hc3QiLCIkbWRUb2FzdCIsInRvYXN0IiwibXNnIiwiZGVidWciLCJvYmplY3QiLCJzdWNjZXNzIiwiZXJyb3JzIiwiZXJyb3JTdHIiLCJmb3JJbiIsImtleUVycm9ycyIsImJ1aWxkQXJyYXlNZXNzYWdlIiwiYXJyTXNnIiwiZXJyb3JWYWxpZGF0aW9uIiwiaW5mbyIsIndhcm4iLCIkcSIsInNsaWNlIiwiQXJyYXkiLCJyZXF1aXJlIiwibGluayIsImF0dHJzIiwiJHJlbmRlciIsImJpbmQiLCJlIiwicmVhZEZpbGUiLCJmaWxlIiwiZGVmZXJyZWQiLCJkZWZlciIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJyZXNvbHZlIiwidGFyZ2V0IiwicmVzdWx0Iiwib25lcnJvciIsInJlamVjdCIsInJlYWRBc0RhdGFVUkwiLCJhbGwiLCJmaWxlcyIsInRoZW4iLCJ2YWx1ZXMiLCJtdWx0aXBsZSIsIiRzZXRWaWV3VmFsdWUiLCJsZW5ndGgiXSwibWFwcGluZ3MiOiJBQUFBLGNDRUEsV0FJRUEsUUFBUUMsT0FBTyxZQUFhLGFBQWMsZ0JBQWlCLHVCQUF3Qix5QkNOcEYsV0FTQyxRQUFTQyxHQUFPQyxFQUFvQkMsRUFDbENDLEVBQVFDLEVBQVNDLEdBRWpCSixFQUFtQkssTUFBTSxXQUN0QkMsZUFBZSxVQUNmQyxjQUFjLFNBRWpCTCxFQUFPTSxPQUFPLFNBRWROLEVBQU9PLHdCQUEwQixTQUFTVixHQUV4Q0EsRUFBT1csR0FBSyxHQUFJQyxNQUFLWixFQUFPYSxLQUc5QlIsRUFBV1MsNEJBQTJCLEdBRXRDaEIsUUFBUWlCLFFBQVFYLEVBQVMsU0FBU1ksR0FDaENkLEVBQWdCYyxLQUFLQSxFQUFLQyxHQUFJRCxFQUFLRSxPQ1Z2Q2xCLEVBQU9tQixTQUFXLHFCQUFzQixrQkFBbUIsU0FBVSxVQUFXLGNEYmhGckIsUUFDR0MsT0FBTyxZQUNQQyxPQUFPQSxNRUhaLFdBS0VGLFFBQ0dDLE9BQU8sWUFDUHFCLFNBQVMsU0FBVUMsR0FDbkJELFNBQVMsU0FBVUUsUUFDbkJGLFNBQVMsU0FBVWpCLFdDWHZCLFdBU0MsUUFBU29CLEdBQUlDLEVBQWdCcEIsR0FDM0JOLFFBQVFpQixRQUFRWCxFQUFTLFNBQVNZLEdBQ2hDUSxFQUFlQyxJQUFJVCxFQUFLRSxJQUFLRixFQUFLVSxPRjZDdENILEVBQUlKLFNBQVcsaUJBQWtCLFdFckRqQ3JCLFFBQ0dDLE9BQU8sWUFDUHdCLElBQUlBLE1DSFQsV0FPRXpCLFFBQ0dDLE9BQU8sWUFDUDRCLFVBQVUsb0JBQUEsU0FBb0IsU0FBU3hCLEdBRXRDLFFBQVN5QixHQUFnQkMsR0FDdkIsR0FBSUMsR0FBVWhDLFFBQVFpQyxZQUFZRixFQUFLQyxTQUEyQixTQUFoQkQsRUFBS0MsT0FDbkRFLEVBQVlsQyxRQUFRbUMsVUFBVUosRUFBS0csV0FBK0IsU0FBbEJILEVBQUtHLFNBQ3JERSxFQUFxQnBDLFFBQVFpQyxZQUFZRixFQUFLSyxvQkFBaUQsU0FBM0JMLEVBQUtLLGtCQUN6RUMsRUFBU04sRUFBS00sU0FBWUgsRUFBWSxtQkFBcUIsYUFLL0QsT0FBQSwyQ0FFWUgsRUFBS1osR0FGakIsMEpBT2NlLEVBUGQsNkJBUWlCRSxFQVJqQixvR0FXaUJKLEVBWGpCLDRCQVlnQkssRUFaaEIsK0JBYW1CckMsUUFBUW1DLFVBQVVKLEVBQUtPLFNBQVdqQyxFQUFPMEIsRUFBS08sU0FBU0QsT0FBT0EsR0FBVSxJQWIzRixpQ0Fjb0JyQyxRQUFRbUMsVUFBVUosRUFBS1EsU0FBV2xDLEVBQU8wQixFQUFLUSxTQUFTRixPQUFPQSxHQUFVLElBZDVGLHVDQW1CRixPQUNFRyxTQUFVLFFBQUFBLEdBQVNDLEVBQVNWLEdBQzFCLEdBQUlTLEdBQVdWLEVBQWdCQyxFQUUvQixPQUFPUyxJQUVURSxPQUNFQyxRQUFTLElBQ1RDLE9BQVEsSUFDUnpCLEdBQUksSUFDSmUsU0FBVSxLQUNWRSxrQkFBbUIsS0FDbkJKLE9BQVEsS0FDUkssT0FBUSxLQUNSQyxRQUFTLEtBQ1RDLFFBQVMsYUN0RG5CLFdBUUUsUUFBU00sR0FBY0MsRUFBTUMsRUFBV0MsRUFBU0MsRUFBWUMsRUFBVUMsR0FhckUsUUFBU0MsR0FBTWxELEdBRWIsSUFBS0YsUUFBUXFELFNBQVNuRCxHQUVwQixXQURBNEMsR0FBS1EsTUFBTSxzRUFJYixJQUFJQyxJQUNGQyxhQUFhLEVBQ2JDLGVBQWUsRUFDZkMsa0JBQWtCLEVBQ2xCQyxxQkFBcUIsRUFDckJDLFVBQVUsRUFDVkMsVUFBVSxFQUNWQyxVQUNBQyxPQUFRLEdBQ1JDLFlBQVksRUFTZCxPQUxJaEUsU0FBUW1DLFVBQVVqQyxFQUFPNEQsVUFDM0JQLEVBQWVPLE9BQVM1RCxFQUFPNEQsYUFDeEI1RCxHQUFPNEQsUUFHVDlELFFBQVFpRSxNQUFNVixFQUFnQnJELEdBUXZDLFFBQVNnRSxHQUFRaEUsR0FFZixHQUFJaUUsR0FBVWYsRUFBTWxELEVBaURwQixPQS9DQWlFLEdBQVEzQixTQUFSLGc1QkFzQkEyQixFQUFRTCxRQUNOTSxNQUFRcEUsUUFBUW1DLFVBQVVnQyxFQUFRQyxPQUFTRCxFQUFRQyxNQUFRLEdBQzNEQyxZQUFjckUsUUFBUW1DLFVBQVVnQyxFQUFRRSxhQUFlRixFQUFRRSxZQUFjLEdBQzdFQyxXQUFhdEUsUUFBUW1DLFVBQVVnQyxFQUFRRyxZQUFjSCxFQUFRRyxXQUFhLFVBQzFFQyxVQUFZdkUsUUFBUW1DLFVBQVVnQyxFQUFRSSxXQUFhSixFQUFRSSxVQUFZLFVBR3pFSixFQUFRSyxZQUFjLFlBQWEsU0FBU3pCLEdBTTFDLFFBQVMwQixLQUNQMUIsRUFBVTJCLFNBRVosUUFBU0MsS0FDUDVCLEVBQVU2QixPQVRaLEdBQUlDLEdBQUtDLElBRVRELEdBQUdKLFNBQVdBLEVBQ2RJLEVBQUdGLFVBQVlBLElBVWpCUixFQUFRWSxhQUFlLE9BQ3ZCWixFQUFRUixxQkFBc0IsRUFDOUJRLEVBQVFYLGFBQWMsRUFFZlQsRUFBVWlDLEtBQUtiLEdBT3hCLFFBQVNjLEdBQU8vRSxHQUVkLEdBQUlpRSxHQUFVZixFQUFNbEQsRUFFcEIsT0FBSUYsU0FBUWlDLFlBQVlrQyxFQUFRZSxjQUFnQmxGLFFBQVFpQyxZQUFZa0MsRUFBUTNCLGNBQzFFTSxHQUFLUSxNQUNILDJHQU1KYSxFQUFVZ0IsRUFBWWhCLEdBRXRCQSxFQUFRWCxhQUFjLEVBRWZULEVBQVVpQyxLQUFLYixJQU94QixRQUFTZ0IsR0FBWWhCLEdBQ25CLEdBQUlBLEVBQVFYLFlBQWEsQ0FDdkIsR0FBSTRCLEdBQVdwQyxFQUFRcUMsZUFBZXBDLEVBQVksa0RBRWxEQyxHQUFTb0MsTUFBTUYsRUFBVXBGLFFBQVF5QyxRQUFRVSxFQUFVb0MsS0FBSyxTQUV4RCxJQUFJQyxHQUFxQnJCLEVBQVFzQixVQUdqQ3RCLEdBQVFzQixXQUFhLFdBQ25CTCxFQUFTTSxTQUNMMUYsUUFBUTJGLFdBQVdILElBQXFCQSxFQUFtQkksT0FHakUsSUFBSUMsR0FBcUIxQixFQUFRMkIsVUFHakMzQixHQUFRMkIsV0FBYSxTQUFVcEQsRUFBT0QsR0FDcEMsR0FBSXNCLEdBQVNnQyxTQUFTNUIsRUFBUUosT0FBUSxHQUV0Qy9ELFNBQVF5QyxRQUFRVSxFQUFVLEdBQUc2QyxjQUFjLHdCQUF3QkMsSUFBSSxVQUFXbEMsR0FDbEZ0QixFQUFRd0QsSUFBSSxVQUFXbEMsRUFBUyxHQUM1Qi9ELFFBQVEyRixXQUFXRSxJQUFxQkEsRUFBbUJELFFBSW5FLE1BQU96QixHQU1ULFFBQVMrQixLQUNQbkQsRUFBVTZCLE9BL0paLE9BQ0VLLE9BQVFBLEVBQ1JmLFFBQVNBLEVBQ1RnQyxNQUFPQSxHSjBHWHJELEVBQWN4QixTQUFXLE9BQVEsWUFBYSxVQUFXLGFBQWMsV0FBWSxhSW5IbkZyQixRQUFRQyxPQUFPLFlBQ1prRyxRQUFRLFdBQVl0RCxNQ0p4QixXQVlDLFFBQVN1RCxHQUFPNUUsRUFBUTZFLEVBQVFDLEdBMkQ5QixRQUFTQyxHQUFTQyxFQUFRQyxFQUFNQyxFQUFVeEcsR0FDeEMsR0FBSXlHLElBQ0ZDLFNBQVMsRUFXWCxPQVJJNUcsU0FBUXFELFNBQVNuRCxJQUFTRixRQUFRaUUsTUFBTTBDLEVBQWV6RyxHQUN2REYsUUFBUWlDLFlBQVl5RSxLQUFXQSxFQUFXLFVBRTlDQyxFQUFjRSxNQUFTN0csUUFBUW1DLFVBQVV3RSxFQUFjRSxPQUFVLFVBQVlGLEVBQWNFLE1BQVEsSUFDbkdGLEVBQWNHLFFBQVc5RyxRQUFRbUMsVUFBVXdFLEVBQWNHLFNBQVksYUFBZUgsRUFBY0csUUFBVSxJQUU1R0osRUFBV0EsRUFBVyxJQUFNQyxFQUFjSSxTQUVuQ3ZGLEVBQU93RixRQUFRLFVBQVlDLEVBQVlULEdBQzFDLFNBQVdHLEVBQWNJLFNBQVNHLGNBQWdCLGlCQUNsRFAsRUFBY0UsTUFDZEYsRUFBY0csU0FBVUosRUFBVUMsRUFBZUYsSUFRdkQsUUFBU1UsR0FBWVgsRUFBUUMsRUFBTUMsRUFBVXhHLEdBSzNDLE1BSklGLFNBQVFpQyxZQUFZL0IsS0FBU0EsTUFFakNBLEVBQU82RyxTQUFXLE1BRVhSLEVBQVNDLEVBQVFDLEVBQU1DLEVBQVV4RyxHQVExQyxRQUFTa0gsR0FBY1osRUFBUUMsRUFBTUMsRUFBVXhHLEdBSzdDLE1BSklGLFNBQVFpQyxZQUFZL0IsS0FBU0EsTUFFakNBLEVBQU82RyxTQUFXLE9BRVhSLEVBQVNDLEVBQVFDLEVBQU1DLEVBQVV4RyxHQU0xQyxRQUFTK0csR0FBWVQsR0FPbkIsTUFOSXhHLFNBQVFxSCxRQUFRYixLQUNsQkEsRUFBU0gsRUFBT2lCLElBQUlkLEVBQVEsU0FBU2UsR0FDbkMsTUFBT0EsR0FBTUMsS0FBTyxRQUFVRCxFQUFNRSxNQUFRLE1BQzNDQyxLQUFLLE9BR0hsQixFQWpIVCxHQUFJbUIsSUFDRlAsY0FBZUEsRUFDZkQsWUFBYUEsRUFrSGYsT0E3R0EzRixHQUFPb0csR0FBR0MsV0FBYSxTQUFTQyxFQUFNekYsR0FDcEMsTUFBT2lFLEdBQVEsVUFBVXdCLEVBQU16RixJQTRHMUJzRixFTCtJVHZCLEVBQU8vRSxTQUFXLFNBQVUsU0FBVSxXSzdRdENyQixRQUNHQyxPQUFPLFlBQ1BrRyxRQUFRLFNBQVVDLE1DUHZCLFdBVUUsUUFBUzJCLEdBQU8xSCxHQUlkLE1BQU8sVUFBUzJILEVBQU9DLEdBQ3JCLEdBQUlDLEdBQWUsWUFFbkIsT0FBSWxJLFNBQVFtQyxVQUFVOEYsR0FDYjVILEVBQU8ySCxFQUFPQyxHQUFhNUYsT0FBTzZGLEdBRWxDN0gsRUFBTzJILEdBQU8zRixPQUFPNkYsSU5pWWxDSCxFQUFPMUcsU0FBVyxVTWpabEJyQixRQUNHQyxPQUFPLFlBQ1BrSSxPQUFPLFNBQVVKLE1DTnRCLFdBVUUsUUFBU0ssR0FBVy9ILEdBSWxCLE1BQU8sVUFBUzJILEdBQ2QsTUFBTzNILEdBQU8ySCxHQUFPM0YsT0FBTyxxQlBnYWhDK0YsRUFBVy9HLFNBQVcsVU8zYXRCckIsUUFDR0MsT0FBTyxZQUNQa0ksT0FBTyxhQUFjQyxNQ04xQixXQVVFLFFBQVNDLEdBQUsvQixHQUlaLE1BQU8sVUFBUzBCLEdBQ2QsTUFBTzFCLEdBQVEsWUFBWTBCLEVBQU8sUVJvYnRDSyxFQUFLaEgsU0FBVyxXUS9iaEJyQixRQUNHQyxPQUFPLFlBQ1BrSSxPQUFPLE9BQVFFLE1DSm5CLFdBSUNySSxRQUNHQyxPQUFPLFlBQ1BxQixTQUFTLFlBRU5ILEdBQUksV0FDSkMsSUFBSyxlQUNMUSxJQUFLLCtTQ1ZiLFdBWUUsUUFBUzBHLEtBQ1AsT0FDRUMsU0FBVSxLQUNWN0YsT0FDRThGLFVBQVcsS0FFYmhHLFNBQUFBLHNxREFmSnhDLFFBQVFDLE9BQU8sWUFDWjRCLFVBQVUsZUFBZ0J5RyxNQ0ovQixXQU9FLFFBQVNHLEtBV1AsR0FBSUMsR0FBYyxTQUFTQyxFQUFjQyxFQUFTQyxHQUNoRCxHQUFJMUUsSUFDRjJFLFNBQVUsR0FDVkMsUUFDRUMsTUFBTyxLQUNQQyxTQUFVLElBQ1ZDLEtBQU0sSUFDTkMsS0FBTSxNQUtObkosU0FBUWlDLFlBQVkyRyxLQUN0QkEsRUFBVSxJQUdSNUksUUFBUW1DLFVBQVUwRyxLQUNoQjdJLFFBQVFtQyxVQUFVMEcsRUFBU0MsWUFDN0IzRSxFQUFRMkUsU0FBV0QsRUFBU0MsVUFFMUI5SSxRQUFRbUMsVUFBVTBHLEVBQVNFLFVBQzdCNUUsRUFBUTRFLE9BQVNGLEVBQVNFLFNBSzlCNUUsRUFBUWlGLGNBQWdCQyxLQUFLQyxNQUFNbkYsRUFBUTJFLFNBQVcsR0FHdERoRSxLQUFLNkQsYUFBZUEsRUFDcEI3RCxLQUFLeUUsY0FBZ0IsRUFDckJ6RSxLQUFLMEUsTUFBUSxFQUNiMUUsS0FBSzhELFFBQVVBLEVBQ2Y5RCxLQUFLMkUsWUFBYyxFQUNuQjNFLEtBQUtYLFFBQVVBLEVBeUVqQixPQWhFQXVFLEdBQVlnQixVQUFVQyxrQkFBb0IsU0FBU0gsR0FDakQxRSxLQUFLMEUsTUFBUUEsRUFFVEEsR0FBUyxFQUNYMUUsS0FBS3lFLGNBQWdCLEVBRXJCekUsS0FBS3lFLGNBQWdCRixLQUFLQyxNQUFNRSxFQUFRMUUsS0FBSzhELFVBQVlZLEVBQVExRSxLQUFLOEQsUUFBVSxFQUFJLEVBQUksSUFPNUZGLEVBQVlnQixVQUFVRSxNQUFRLFdBRzVCLElBQUssR0FGREMsTUFFS0MsRUFBSSxFQUFHQSxHQUFLaEYsS0FBS3lFLGNBQWVPLElBQ25DaEYsS0FBSzJFLGNBQWdCSyxFQUN2QkQsRUFBSUUsS0FBS0QsR0FFTGhGLEtBQUsyRSxhQUFnQjNFLEtBQUtYLFFBQVFpRixjQUFnQixFQUNoRFUsR0FBS2hGLEtBQUtYLFFBQVEyRSxVQUNwQmUsRUFBSUUsS0FBS0QsR0FHTkEsR0FBS2hGLEtBQUsyRSxZQUFjM0UsS0FBS1gsUUFBUWlGLGVBQ3ZDVSxHQUFLaEYsS0FBSzJFLFlBQWMzRSxLQUFLWCxRQUFRaUYsZUFDdENTLEVBQUlFLEtBQUtELEVBS2pCLE9BQU9ELElBTVRuQixFQUFZZ0IsVUFBVU0sYUFBZSxXQUMvQmxGLEtBQUsyRSxZQUFjLEdBQ3JCM0UsS0FBSzZELGFBQWE3RCxLQUFLMkUsWUFBYyxJQU96Q2YsRUFBWWdCLFVBQVVPLFNBQVcsV0FDM0JuRixLQUFLMkUsWUFBYzNFLEtBQUt5RSxlQUMxQnpFLEtBQUs2RCxhQUFhN0QsS0FBSzJFLFlBQWMsSUFTekNmLEVBQVlnQixVQUFVUSxTQUFXLFNBQVNDLEdBQ3BDQSxHQUFRLEdBQUtBLEdBQVFyRixLQUFLeUUsZUFDNUJ6RSxLQUFLNkQsYUFBYXdCLEtBS3BCQyxZQUFhLFNBQVN6QixFQUFjQyxFQUFTQyxHQUMzQyxNQUFPLElBQUlILEdBQVlDLEVBQWNDLEVBQVNDLEtBNUhwRDdJLFFBQVFDLE9BQU8sWUFDWmtHLFFBQVEsZUFBZ0JzQyxNQ0o3QixXQU9FekksUUFDR0MsT0FBTyxZQUNQb0ssVUFBVSxhQUNUN0gsU0FBQUEsNk9BTUE4SCxVQUNFQyxTQUFVLElBQ1ZDLE1BQU8sS0FFVGhHLFlBQWEsU0FBVSxTQUFTaUcsR0FDOUIsR0FBSUMsR0FBTzVGLElBRVg0RixHQUFLQyxRQUFVLFdBRWJELEVBQUtFLE9BQVVMLFNBQVV2SyxRQUFRbUMsVUFBVXVJLEVBQUtILFVBQVlHLEVBQUtILFNBQVcsU0FDeEV2SyxRQUFRaUMsWUFBWXlJLEVBQUtGLFNBQVFFLEVBQUtGLE1BQVEsZUFHcERFLEVBQUtHLFNBQ0g3RixNQUFNLEdBS1J5RixFQUFPSyxJQUFJLGVBQWdCLFdBQ3pCSixFQUFLRyxTQUNIN0YsTUFBTSxLQUlWeUYsRUFBT0ssSUFBSSxlQUFnQixXQUN6QkosRUFBS0csU0FDSDdGLE1BQU0sWUM3Q2xCLFdBT0UsUUFBUytGLEdBQWU5SCxHQVN0QixRQUFTK0IsS0FFUC9CLEVBQVcrSCxXQUFXLGdCQU94QixRQUFTcEcsS0FDUDNCLEVBQVcrSCxXQUFXLGdCQWxCeEIsT0FDRWhHLEtBQU1BLEVBQ05KLEtBQU1BLEdieXFCVm1HLEVBQWUxSixTQUFXLGNhaHJCMUJyQixRQUFRQyxPQUFPLFlBQ1prRyxRQUFRLFlBQWE0RSxNQ0Z6QixXQVdDLFFBQVNFLEdBQU1DLEVBQVU3RSxFQUFRdkQsR0FrQi9CLFFBQVNxSSxHQUFNQyxFQUFLWixFQUFPckcsR0FDekIsR0FBSWlILEVBQUssQ0FDUCxHQUFJN0gsSUFDRmYsU0FBQUEsb0dBRThEZ0ksRUFGOUQsMkRBR3lDWSxFQUh6QyxxRUFPQWIsU0FBVSxZQUtaLE9BRkl2SyxTQUFRcUQsU0FBU2MsS0FBVVosRUFBaUJ2RCxRQUFRaUUsTUFBTVYsRUFBZ0JZLElBRXZFK0csRUFBU2xHLEtBQUt6QixHQUVyQlQsRUFBS3VJLE1BQU0sd0RBV2YsUUFBU3pHLEdBQUswRyxHQUNaLE1BQU9KLEdBQVN0RyxLQUFLMEcsR0FHdkIsUUFBU0MsR0FBUUgsRUFBS2pILEdBQ3BCLE1BQU9nSCxHQUFNQyxFQUFLLFFBQVNqSCxHQUc3QixRQUFTYixHQUFNa0ksRUFBUXJILEdBR3JCLEdBQUluRSxRQUFRcUQsU0FBU21JLEdBQVMsQ0FDNUIsR0FBSUMsR0FBVyxFQVVmcEYsR0FBT3FGLE1BQU1GLEVBQVEsU0FBU0csR0FDNUJGLEdBQVlHLEVBQWtCRCxLQUdoQ0gsRUFBU0MsTUFFTHpMLFNBQVFxSCxRQUFRbUUsS0FDbEJBLEVBQVNJLEVBQWtCSixHQUkvQixPQUFPTCxHQUFNSyxFQUFRLFdBQVlySCxHQUduQyxRQUFTeUgsR0FBa0JDLEdBQ3pCLEdBQUlULEdBQU8sRUFXWCxPQVRJcEwsU0FBUXFILFFBQVF3RSxHQUVsQkEsRUFBTzVLLFFBQVEsU0FBU3FDLEdBQ3RCOEgsR0FBTzlILEVBQVEsVUFHakI4SCxHQUFPUyxFQUFTLFFBR1hULEVBbUJULFFBQVNVLEdBQWdCTixFQUFRSixFQUFLakgsR0FDcEN3RCxFQUFJckUsTUFBT3RELFFBQVFxSCxRQUFRbUUsSUFBV3hMLFFBQVFxRCxTQUFTbUksR0FBV0EsRUFBU0osRUFBS2pILEdBR2xGLFFBQVM0SCxHQUFLWCxFQUFLakgsR0FDakIsTUFBT2dILEdBQU1DLEVBQUssT0FBUWpILEdBRzVCLFFBQVM2SCxHQUFLWixFQUFLakgsR0FDakIsTUFBT2dILEdBQU1DLEVBQUssT0FBUWpILEdBekg1QixHQUFJd0QsSUFDRjRELFFBQVNBLEVBQ1RqSSxNQUFPQSxFQUNQd0ksZ0JBQWlCQSxFQUNqQkMsS0FBTUEsRUFDTkMsS0FBTUEsRUFDTnBILEtBQU1BLEVBc0hSLE9BQU8rQyxHZDBrQlRzRCxFQUFNNUosU0FBVyxXQUFZLFNBQVUsUWMvc0J2Q3JCLFFBQ0dDLE9BQU8sWUFDUGtHLFFBQVEsVUFBVzhFLE1DTHhCLFdBR0VqTCxRQUFRQyxPQUFPLFlBQVk0QixVQUFVLG9CQUFBLEtBQW9CLFNBQVNvSyxHQUNoRSxHQUFJQyxHQUFRQyxNQUFNekMsVUFBVXdDLEtBRTVCLFFBQ0UzRCxTQUFVLElBQ1Y2RCxRQUFTLFdBQ1RDLEtBQU0sU0FBUzNKLEVBQU9ELEVBQVM2SixFQUFPM0osR0FDL0JBLElBRUxBLEVBQVE0SixRQUFVLGFBRWxCOUosRUFBUStKLEtBQUssU0FBVSxTQUFTQyxHQVM5QixRQUFTQyxHQUFTQyxHQUNoQixHQUFJQyxHQUFXWCxFQUFHWSxRQUVkQyxFQUFTLEdBQUlDLFdBVWpCLE9BUkFELEdBQU9FLE9BQVMsU0FBU1AsR0FDdkJHLEVBQVNLLFFBQVFSLEVBQUVTLE9BQU9DLFNBRTVCTCxFQUFPTSxRQUFVLFNBQVNYLEdBQ3hCRyxFQUFTUyxPQUFPWixJQUVsQkssRUFBT1EsY0FBY1gsR0FFZEMsRUFBUzVGLFFBckJsQixHQUFJdkUsR0FBVWdLLEVBQUVTLE1BRWhCakIsR0FBR3NCLElBQUlyQixFQUFNdEcsS0FBS25ELEVBQVErSyxNQUFPLEdBQUdsRyxJQUFJb0YsSUFDckNlLEtBQUssU0FBU0MsR0FDVGpMLEVBQVFrTCxTQUFVaEwsRUFBUWlMLGNBQWNGLEdBQ3ZDL0ssRUFBUWlMLGNBQWNGLEVBQU9HLE9BQVNILEVBQU8sR0FBSyIsImZpbGUiOiJuZy1wcm9kZWIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludCBhbmd1bGFyL2ZpbGUtbmFtZTogMCovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvL2luaWNpYSBvIG1vZHVsbyBkYSBiaWJsaW90ZWNhIGUgZGVmaW5lIGFzIGRlcGVuZMOqbmNpYXNcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInLCBbJ25nTWF0ZXJpYWwnLCAnbWQuZGF0YS50YWJsZScsICduZ01hdGVyaWFsRGF0ZVBpY2tlcicsICdhbmd1bGFyRmlsZVVwbG9hZCddKTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5jb25maWcoY29uZmlnKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIGNvbmZpZygkbWRUaGVtaW5nUHJvdmlkZXIsICRtZEljb25Qcm92aWRlciwgbW9tZW50LCBQckljb25zLCAkcVByb3ZpZGVyKSB7XG4gICAgLy9jb25maWd1cmHDp8O1ZXMgcGFkcsO1ZXMgZGFzIGJpYmxpb3RlY2FzIHF1ZSBzw6NvIHV0aWxpemFkYXNcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKS5wcmltYXJ5UGFsZXR0ZSgnaW5kaWdvJykuYWNjZW50UGFsZXR0ZSgnYW1iZXInKTtcblxuICAgIG1vbWVudC5sb2NhbGUoJ3B0LUJSJyk7XG5cbiAgICBtb21lbnQuY3JlYXRlRnJvbUlucHV0RmFsbGJhY2sgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAvLyB1bnJlbGlhYmxlIHN0cmluZyBtYWdpYywgb3JcbiAgICAgIGNvbmZpZy5fZCA9IG5ldyBEYXRlKGNvbmZpZy5faSk7XG4gICAgfTtcblxuICAgICRxUHJvdmlkZXIuZXJyb3JPblVuaGFuZGxlZFJlamVjdGlvbnMoZmFsc2UpO1xuXG4gICAgYW5ndWxhci5mb3JFYWNoKFBySWNvbnMsIGZ1bmN0aW9uIChpY29uKSB7XG4gICAgICAkbWRJY29uUHJvdmlkZXIuaWNvbihpY29uLmlkLCBpY29uLnVybCk7XG4gICAgfSk7XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qZXNsaW50IGFuZ3VsYXIvZmlsZS1uYW1lOiAwLCBuby11bmRlZjogMCovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvL2VuY2Fwc3VsYSBhcyBiaWJsaW90ZWNhcyBleHRlcm5hcyBwYXJhIHNlcmVtIGNhcnJlZ2FkYXMgY29tbyB1bWEgZGVwZW5kw6puY2lhXG4gIC8vZG8gYW5ndWxhci5cblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5jb25zdGFudCgnbG9kYXNoJywgXykuY29uc3RhbnQoJ2FsYXNxbCcsIGFsYXNxbCkuY29uc3RhbnQoJ21vbWVudCcsIG1vbWVudCk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykucnVuKHJ1bik7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LXBhcmFtc1xuICBmdW5jdGlvbiBydW4oJHRlbXBsYXRlQ2FjaGUsIFBySWNvbnMpIHtcbiAgICBhbmd1bGFyLmZvckVhY2goUHJJY29ucywgZnVuY3Rpb24gKGljb24pIHtcbiAgICAgICR0ZW1wbGF0ZUNhY2hlLnB1dChpY29uLnVybCwgaWNvbi5zdmcpO1xuICAgIH0pO1xuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qKlxuICAgKiBEaXJldGl2YSBxdWUgZXhpYmUgdW0gc3Bpbm5lciBzZW1wcmUgcXVlIHVtIGJyb2FkY2FzdCwgbWFudWFsbWVudGUsIMOpIGRpc3BhcmFkb1xuICAgKi9cbiAgLyoqIEBuZ0luamVjdCAqL1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmRpcmVjdGl2ZSgncHJEYXRlVGltZVBpY2tlcicsIGZ1bmN0aW9uIChtb21lbnQpIHtcblxuICAgIGZ1bmN0aW9uIGJ1aWxkRGF0ZVBpY2tlcihhdHRyKSB7XG4gICAgICB2YXIgYXV0b09rID0gYW5ndWxhci5pc1VuZGVmaW5lZChhdHRyLmF1dG9PaykgfHwgYXR0ci5hdXRvT2sgPT09ICd0cnVlJztcbiAgICAgIHZhciB3aXRoVGltZSA9IGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIud2l0aFRpbWUpICYmIGF0dHIud2l0aFRpbWUgPT09ICd0cnVlJztcbiAgICAgIHZhciB3aXRoTWludXRlc1BpY2tlciA9IGFuZ3VsYXIuaXNVbmRlZmluZWQoYXR0ci53aXRoTWludXRlc1BpY2tlcikgfHwgYXR0ci53aXRoTWludXRlc1BpY2tlciA9PT0gJ3RydWUnO1xuICAgICAgdmFyIGZvcm1hdCA9IGF0dHIuZm9ybWF0IHx8ICh3aXRoVGltZSA/ICdERC9NTS9ZWVlZIEhIOm1tJyA6ICdERC9NTS9ZWVlZJyk7XG5cbiAgICAgIC8qKlxuICAgICAgICogQ29uc3Ryb2kgbyB0ZW1wbGF0ZSBkbyBjb21wb25lbnRlIGRlIGVzY29saGEgZGUgZGF0YVxuICAgICAgICovXG4gICAgICByZXR1cm4gJ1xcbiAgICAgICAgICAgIDxpbnB1dFxcbiAgICAgICAgICAgICAgaWQ9XCInICsgYXR0ci5pZCArICdcIlxcbiAgICAgICAgICAgICAgbWRjLWRhdGV0aW1lLXBpY2tlclxcbiAgICAgICAgICAgICAgbmctbW9kZWw9XCJuZ01vZGVsXCJcXG4gICAgICAgICAgICAgIHNob3ctdG9kYXlzLWRhdGVcXG4gICAgICAgICAgICAgIGRhdGU9XCJ0cnVlXCJcXG4gICAgICAgICAgICAgIHRpbWU9XCInICsgd2l0aFRpbWUgKyAnXCJcXG4gICAgICAgICAgICAgIG1pbnV0ZXM9XCInICsgd2l0aE1pbnV0ZXNQaWNrZXIgKyAnXCJcXG4gICAgICAgICAgICAgIGNhbmNlbC10ZXh0PVwiQ2FuY2VsYXJcIlxcbiAgICAgICAgICAgICAgdG9kYXktdGV4dD1cIkhvamVcIlxcbiAgICAgICAgICAgICAgYXV0by1vaz1cIicgKyBhdXRvT2sgKyAnXCJcXG4gICAgICAgICAgICAgIGZvcm1hdD1cIicgKyBmb3JtYXQgKyAnXCJcXG4gICAgICAgICAgICAgIG1pbi1kYXRlPVwiJyArIChhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm1pbkRhdGUpID8gbW9tZW50KGF0dHIubWluRGF0ZSkuZm9ybWF0KGZvcm1hdCkgOiAnJykgKyAnXCJcXG4gICAgICAgICAgICAgIG1heC1kYXRlPVwiXFwnJyArIChhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm1heERhdGUpID8gbW9tZW50KGF0dHIubWF4RGF0ZSkuZm9ybWF0KGZvcm1hdCkgOiAnJykgKyAnXFwnXCI+XFxuICAgICAgICAgICAgPC9pbnB1dD5cXG4gICAgICAgICc7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRlbXBsYXRlOiBmdW5jdGlvbiB0ZW1wbGF0ZShlbGVtZW50LCBhdHRyKSB7XG4gICAgICAgIHZhciB0ZW1wbGF0ZSA9IGJ1aWxkRGF0ZVBpY2tlcihhdHRyKTtcblxuICAgICAgICByZXR1cm4gdGVtcGxhdGU7XG4gICAgICB9LFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgbmdNb2RlbDogJz0nLFxuICAgICAgICBsYXlvdXQ6ICc9JyxcbiAgICAgICAgaWQ6ICc9JyxcbiAgICAgICAgd2l0aFRpbWU6ICc9PycsXG4gICAgICAgIHdpdGhNaW51dGVzUGlja2VyOiAnPT8nLFxuICAgICAgICBhdXRvT2s6ICc9PycsXG4gICAgICAgIGZvcm1hdDogJz0/JyxcbiAgICAgICAgbWluRGF0ZTogJz0/JyxcbiAgICAgICAgbWF4RGF0ZTogJz0/J1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5mYWN0b3J5KCdQckRpYWxvZycsIGRpYWxvZ1NlcnZpY2UpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gZGlhbG9nU2VydmljZSgkbG9nLCAkbWREaWFsb2csICRtZFV0aWwsICRyb290U2NvcGUsICRhbmltYXRlLCAkZG9jdW1lbnQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY3VzdG9tOiBjdXN0b20sXG4gICAgICBjb25maXJtOiBjb25maXJtLFxuICAgICAgY2xvc2U6IGNsb3NlXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcXVlIGNvbmZpZ3VyYSBlIHJlYWxpemEgbyBtZXJnZSBkbyBvYmpldG8gcmVjZWJpZG8gdmlhIHBhcsOibWV0cm9cbiAgICAgKiBjb20gYSBjb25maWd1cmHDp8OjbyBwYWRyw6NvIHBhcmEgYSBleGliacOnw6NvIGRvIGRpYWxvZ1xuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWcgLSBPYmpldG8gY29udGVuZG8gYXMgY29uZmlndXJhw6fDtWVzXG4gICAgICogQHJldHVybnMge2RpYWxvZ1NlcnZpY2V9IC0gUmV0b3JuYSBvIHNlcnZpY2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBidWlsZChjb25maWcpIHtcblxuICAgICAgaWYgKCFhbmd1bGFyLmlzT2JqZWN0KGNvbmZpZykpIHtcbiAgICAgICAgJGxvZy5lcnJvcignUHJEaWFsb2c6IFBhcsOibWV0cm8gaW52w6FsaWRvLCDDqSBlc3BlcmFuZG8gdW0gb2JqZXRvIGNvbW8gcGFyw6JtZXRyby4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgICAgIGhhc0JhY2tkcm9wOiBmYWxzZSxcbiAgICAgICAgZXNjYXBlVG9DbG9zZTogZmFsc2UsXG4gICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgIGF1dG9XcmFwOiB0cnVlLFxuICAgICAgICBza2lwSGlkZTogdHJ1ZSxcbiAgICAgICAgbG9jYWxzOiB7fSxcbiAgICAgICAgekluZGV4OiA3NSxcbiAgICAgICAgZnVsbHNjcmVlbjogZmFsc2VcbiAgICAgIH07XG5cbiAgICAgIC8vbsOjbyBmYXplbW9zIG1lcmdlIGRhIHByb3ByaWVkYWRlIGxvY2FscyBwYXJhIG7Do28gZXN0b3VyYXIgbyBsaW1pdGUgZGUgcmVjdXJzaXZpZGFkZVxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGNvbmZpZy5sb2NhbHMpKSB7XG4gICAgICAgIGRlZmF1bHRPcHRpb25zLmxvY2FscyA9IGNvbmZpZy5sb2NhbHM7XG4gICAgICAgIGRlbGV0ZSBjb25maWcubG9jYWxzO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYW5ndWxhci5tZXJnZShkZWZhdWx0T3B0aW9ucywgY29uZmlnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBleGliZSBvIGRpYWxvZyBkZSBjb25maXJtYcOnw6NvIG5hIHRlbGEgZGVwb2lzIHF1ZSBvIGJ1aWxkIGUgaW52b2NhZG9cbiAgICAgKiBkZSB1bWEgZGV0ZXJtaW5hZGEgYcOnw6NvXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpcm0oY29uZmlnKSB7XG5cbiAgICAgIHZhciBvcHRpb25zID0gYnVpbGQoY29uZmlnKTtcblxuICAgICAgb3B0aW9ucy50ZW1wbGF0ZSA9ICcgPG1kLWRpYWxvZyBmbGV4PTUwIGFyaWEtbGFiZWw9XCJ7ezo6Y3RybC50aXRsZX19XCI+XFxuICAgICAgICAgICAgICA8bWQtdG9vbGJhciBtZC1zY3JvbGwtc2hyaW5rPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdG9vbGJhci10b29sc1wiPlxcbiAgICAgICAgICAgICAgICAgIDxoMz5cXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuPnt7OjpjdHJsLnRpdGxlfX08L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgPC9oMz5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICA8L21kLXRvb2xiYXI+XFxuICAgICAgICAgICAgICA8bWQtZGlhbG9nLWNvbnRlbnQgbGF5b3V0LW1hcmdpbj5cXG4gICAgICAgICAgICAgICAgPHA+e3s6OmN0cmwuZGVzY3JpcHRpb259fTwvcD5cXG4gICAgICAgICAgICAgIDwvbWQtZGlhbG9nLWNvbnRlbnQ+XFxuICAgICAgICAgICAgICA8bWQtZGlhbG9nLWFjdGlvbnM+XFxuICAgICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxcbiAgICAgICAgICAgICAgICAgIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6XFwnZGVmYXVsdC17e2N0cmwueWVzQmdDb2xvcn19XFwnfVwiXFxuICAgICAgICAgICAgICAgICAgbmctY2xpY2s9XCJjdHJsLnllc0FjdGlvbigpXCI+U2ltPC9tZC1idXR0b24+XFxuICAgICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxcbiAgICAgICAgICAgICAgICAgIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6XFwnZGVmYXVsdC17e2N0cmwubm9CZ0NvbG9yfX1cXCd9XCJcXG4gICAgICAgICAgICAgICAgICBuZy1jbGljaz1cImN0cmwubm9BY3Rpb24oKVwiPk5cXHhFM288L21kLWJ1dHRvbj5cXG4gICAgICAgICAgICAgIDwvbWQtZGlhbG9nLWFjdGlvbnM+XFxuICAgICAgICAgICAgPC9tZC1kaWFsb2c+XFxuICAgICAgICAgICc7XG4gICAgICBvcHRpb25zLmxvY2FscyA9IHtcbiAgICAgICAgdGl0bGU6IGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMudGl0bGUpID8gb3B0aW9ucy50aXRsZSA6ICcnLFxuICAgICAgICBkZXNjcmlwdGlvbjogYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy5kZXNjcmlwdGlvbikgPyBvcHRpb25zLmRlc2NyaXB0aW9uIDogJycsXG4gICAgICAgIHllc0JnQ29sb3I6IGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMueWVzQmdDb2xvcikgPyBvcHRpb25zLnllc0JnQ29sb3IgOiAncHJpbWFyeScsXG4gICAgICAgIG5vQmdDb2xvcjogYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy5ub0JnQ29sb3IpID8gb3B0aW9ucy5ub0JnQ29sb3IgOiAnYWNjZW50J1xuICAgICAgfTtcblxuICAgICAgb3B0aW9ucy5jb250cm9sbGVyID0gWyckbWREaWFsb2cnLCBmdW5jdGlvbiAoJG1kRGlhbG9nKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0ubm9BY3Rpb24gPSBub0FjdGlvbjtcbiAgICAgICAgdm0ueWVzQWN0aW9uID0geWVzQWN0aW9uO1xuXG4gICAgICAgIGZ1bmN0aW9uIG5vQWN0aW9uKCkge1xuICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB5ZXNBY3Rpb24oKSB7XG4gICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgfV07XG5cbiAgICAgIG9wdGlvbnMuY29udHJvbGxlckFzID0gJ2N0cmwnO1xuICAgICAgb3B0aW9ucy5jbGlja091dHNpZGVUb0Nsb3NlID0gZmFsc2U7XG4gICAgICBvcHRpb25zLmhhc0JhY2tkcm9wID0gdHJ1ZTtcblxuICAgICAgcmV0dXJuICRtZERpYWxvZy5zaG93KG9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcXVlIGV4aWJlIG8gZGlhbG9nIGN1c3RvbWl6YWRvIG5hIHRlbGEgZGVwb2lzIHF1ZSBvIGJ1aWxkIGUgaW52b2NhZG9cbiAgICAgKiBAcmV0dXJucyB7cHJvbWlzc2V9IC0gUmV0b3JuYSB1bWEgcHJvbWlzc2UgcXVlIHBvZGUgb3UgbsOjbyBzZXIgcmVzb2x2aWRhXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3VzdG9tKGNvbmZpZykge1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IGJ1aWxkKGNvbmZpZyk7XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKG9wdGlvbnMudGVtcGxhdGVVcmwpICYmIGFuZ3VsYXIuaXNVbmRlZmluZWQob3B0aW9ucy50ZW1wbGF0ZSkpIHtcbiAgICAgICAgJGxvZy5lcnJvcignUHJEaWFsb2c6IHRlbXBsYXRlVXJsIG91IHRlbXBsYXRlIGluZGVmaW5pZG8sIMOpIGVzcGVyYW5kbyB1bSB0ZW1wbGF0ZVVybCBvdSB1bSB0ZW1wbGF0ZSBjb21vIGF0cmlidXRvLicpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vQ3JpYWRvIG8gYmFja2Ryb3AgbWFudWFsbWVudGUgcGFyYSBkaW1pbnVpciBvIHotaW5kZXggYXRyYXbDqXMgZGUgdW1hIGNsYXNzZSBjc3NcbiAgICAgIC8vbyB6LWluZGV4IHRlbSBxdWUgZmljYXIgbWVub3IgZGV2aWRvIGFvIGRpYWxvZy5jb25maXJtIHVzYXIgbyB6LWluZGV4IG9yaWdpbmFsIGRlIDgwXG4gICAgICBvcHRpb25zID0gYWRkQmFja2Ryb3Aob3B0aW9ucyk7XG5cbiAgICAgIG9wdGlvbnMuaGFzQmFja2Ryb3AgPSBmYWxzZTtcblxuICAgICAgcmV0dXJuICRtZERpYWxvZy5zaG93KG9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcXVlIGNyaWEgbyBiYWNrZHJvcCBlIG1vc3RyYSBuYSB0ZWxhIGNvbSBvIHotaW5kZXggY29uZmlndXJhdsOpbFxuICAgICAqIHBhcmEgc29icmVwb3Igb3MgZWxlbWVudG9zIGRhIHRlbGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZGRCYWNrZHJvcChvcHRpb25zKSB7XG4gICAgICBpZiAob3B0aW9ucy5oYXNCYWNrZHJvcCkge1xuICAgICAgICB2YXIgYmFja2Ryb3AgPSAkbWRVdGlsLmNyZWF0ZUJhY2tkcm9wKCRyb290U2NvcGUsICdtZC1kaWFsb2ctYmFja2Ryb3AgbWQtb3BhcXVlIG1kLWJhY2tkcm9wLWN1c3RvbScpO1xuXG4gICAgICAgICRhbmltYXRlLmVudGVyKGJhY2tkcm9wLCBhbmd1bGFyLmVsZW1lbnQoJGRvY3VtZW50LmZpbmQoJ2JvZHknKSkpO1xuXG4gICAgICAgIHZhciBvcmlnaW5hbE9uUmVtb3ZpbmcgPSBvcHRpb25zLm9uUmVtb3Zpbmc7XG5cbiAgICAgICAgLy9Nw6l0b2RvIGV4ZWN1dGFkbyBxdWFuZG8gYSBhbmltYcOnw6NvIGRlIGZlY2hhbWVudG8gZG8gZGlhbG9nIHRlcm1pbmFcbiAgICAgICAgb3B0aW9ucy5vblJlbW92aW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGJhY2tkcm9wLnJlbW92ZSgpO1xuICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24ob3JpZ2luYWxPblJlbW92aW5nKSkgb3JpZ2luYWxPblJlbW92aW5nLmNhbGwoKTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgb3JpZ2luYWxPbkNvbXBsZXRlID0gb3B0aW9ucy5vbkNvbXBsZXRlO1xuXG4gICAgICAgIC8vTcOpdG9kbyBleGVjdXRhZG8gcXVhbmRvIGEgYW5pbWHDp8OjbyBkZSBhYmVydHVyYSBkbyBkaWFsb2cgdGVybWluYVxuICAgICAgICBvcHRpb25zLm9uQ29tcGxldGUgPSBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgICAgICB2YXIgekluZGV4ID0gcGFyc2VJbnQob3B0aW9ucy56SW5kZXgsIDEwKTtcblxuICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgkZG9jdW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLWJhY2tkcm9wLWN1c3RvbScpKS5jc3MoJ3otaW5kZXgnLCB6SW5kZXgpO1xuICAgICAgICAgIGVsZW1lbnQuY3NzKCd6LWluZGV4JywgekluZGV4ICsgMSk7XG4gICAgICAgICAgaWYgKGFuZ3VsYXIuaXNGdW5jdGlvbihvcmlnaW5hbE9uQ29tcGxldGUpKSBvcmlnaW5hbE9uQ29tcGxldGUuY2FsbCgpO1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gb3B0aW9ucztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBzZXJ2ZSBwYXJhIGZlY2hhciBvIGRpYWxvZ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICB9XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmFjdG9yeSgnUHJGaWxlJywgUHJGaWxlKTtcblxuICAvKipcbiAgICogU2VydmljZSBxdWUgZW5jYXBzdWxhIG9zIHNlcnZpw6dvc1xuICAgKiBkZSBleHBvcnRhw6fDo28gZSBpbXBvcnRhw6fDo28gZGUgYXJxdWl2b3NcbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gUHJGaWxlKGFsYXNxbCwgbG9kYXNoLCAkZmlsdGVyKSB7XG4gICAgdmFyIG9iaiA9IHtcbiAgICAgIGV4cG9ydFRvRXhjZWw6IGV4cG9ydFRvRXhjZWwsXG4gICAgICBleHBvcnRUb0NTVjogZXhwb3J0VG9DU1ZcbiAgICB9O1xuXG4gICAgLy9EZWZpbmVkIGZpbHRlcnNcblxuICAgIGFsYXNxbC5mbi5mb3JtYXREYXRlID0gZnVuY3Rpb24gKGRhdGUsIGZvcm1hdCkge1xuICAgICAgcmV0dXJuICRmaWx0ZXIoJ3ByRGF0ZScpKGRhdGUsIGZvcm1hdCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEV4cG9ydGEgb3MgZGFkb3MgZW52aWFkb3MgcGFyYSBvIGZvcm1hdG8gaW5mb3JtYWRvLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd8YXJyYXl9IGZpZWxkc1xuICAgICAqICBTdHJpbmcgY29udGVuZG8gb3MgY2FtcG9zIHNlcGFyYWRvIHBvciB2aXJndWxhXG4gICAgICogICAgZXg6IG5hbWUsIGRlc2NyaXB0aW9uXG4gICAgICogICAgZXg6IG5hbWUgYXMgTm9tZSwgZGVzY3JpcHRpb24gYXMgJ0Rlc2NyacOnw6NvJ1xuICAgICAqICAgIGV4OiAqICAocGFyYSB0b2RvcyBvcyBjYW1wb3MpXG4gICAgICogIEFycmF5IGRlIG9iamV0b3MgY29tIG9zIGNhbXBvc1xuICAgICAqICAgIGV4OiBbXG4gICAgICogICAgICB7IG5hbWU6ICduYW1lJywgbGFiZWw6ICdOb21lJyB9LFxuICAgICAqICAgICAgeyBuYW1lOiAnZGVzY3JpcHRpb24nLCBsYWJlbDogJ0Rlc2NyacOnw6NvJyB9LFxuICAgICAqICAgICAgeyBuYW1lOiAncm9sZS5uYW1lJywgbGFiZWw6ICdQZXJmaWwnIH0sXG4gICAgICogICAgICB7IG5hbWU6ICdmb3JtYXREYXRlKGRhdGUpJywgbGFiZWw6ICdEYXRhJyB9LCpcbiAgICAgKiAgICBdXG4gICAgICogQHBhcmFtIHthcnJheX0gZGF0YSAtIEFycmF5IHF1ZSB2YWkgc2VydmlyIGNvbW8gZm9udGUgZGUgZGFkb3NcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsZU5hbWUgLSBOb21lIGRvIGFycXVpdm8gc2VtIGEgZXh0ZW5zw6NvXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGNvbmZpZ1xuICAgICAqIENvbmZpZ3VyYcOnw7VlcyBkYSBkb2N1bWVudGHDp8OjbyBkbyBhbGFzcWwgY29tbzpcbiAgICAgKiAgLSAoYm9vbGVhbikgaGVhZGVyc1xuICAgICAqIG1haXMgYXMgZGVzdGFjYWRhcyBhYmFpeG9cbiAgICAgKiAgLSAoc3RyaW5nKSB3aGVyZVxuICAgICAqICAtIChzdHJpbmcpIG9yZGVyQnlcbiAgICAgKlxuICAgICAqIGZpbHRlcnMgZGVmaW5pZG9zXG4gICAgICpcbiAgICAgKiBmb3JtYXREYXRlKGNhbXBvLCBbZm9ybWF0b10pXG4gICAgICpcbiAgICAgKiBFeGVtcGxvOlxuICAgICAqXG4gICAgICogdmFyIGNhcnMgPSBbXG4gICAgICogIHsgbmFtZTogJ1N0aWxvJywgIGJyYW5kOiAnRmlhdCcsIGRhdGU6IG1vbWVudCgpLnN1YnRyYWN0KDEsICd5ZWFycycpIH0sXG4gICAgICogIHsgbmFtZTogJ1B1bnRvJywgIGJyYW5kOiAnRmlhdCcsIGRhdGU6IG1vbWVudCgpLnN1YnRyYWN0KDMsICd5ZWFycycpIH0sXG4gICAgICogIHsgbmFtZTogJ0ZpZXN0YScsIGJyYW5kOiAnRm9yZCcsIGRhdGU6ICcwNC0wMS0yMDE3JyB9XG4gICAgICogXVxuICAgICAqXG4gICAgICogUHJGaWxlLmV4cG9ydFRvRXhjZWwoW1xuICAgICAqICB7IG5hbWU6ICdicmFuZCcsIGxhYmVsOiAnTWFyY2EnIH0sXG4gICAgICogIHsgbmFtZTogJ25hbWUnLCBsYWJlbDogJ05vbWUnIH0sXG4gICAgICogIHsgbmFtZTogJ2Zvcm1hdERhdGUoZGF0ZSwgXFwnREQtTU0tWVlZWVxcJyknLCBsYWJlbDogJ0NvbXByYWRvIGVtPycgfVxuICAgICAqIF0sIGNhcnMsICdkYXRhLWV4cG9ydCcsIHtcbiAgICAgKiAgb3JkZXJCeTogJ2JyYW5kIEFTQywgbmFtZSBBU0MnLFxuICAgICAqICB3aGVyZTogJ2JyYW5kIGxpa2UgXCIlRmklXCInXG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7cHJvbWlzc2V9IC0gUmV0b3JuYSB1bWEgcHJvbWlzc2UgcXVlIHBvZGUgb3UgbsOjbyBzZXIgcmVzb2x2aWRhXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXhwb3J0VG8oZmllbGRzLCBkYXRhLCBmaWxlTmFtZSwgY29uZmlnKSB7XG4gICAgICB2YXIgZGVmYXVsdENvbmZpZyA9IHtcbiAgICAgICAgaGVhZGVyczogdHJ1ZVxuICAgICAgfTtcblxuICAgICAgaWYgKGFuZ3VsYXIuaXNPYmplY3QoY29uZmlnKSkgYW5ndWxhci5tZXJnZShkZWZhdWx0Q29uZmlnLCBjb25maWcpO1xuICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoZmlsZU5hbWUpKSBmaWxlTmFtZSA9ICdleHBvcnQnO1xuXG4gICAgICBkZWZhdWx0Q29uZmlnLndoZXJlID0gYW5ndWxhci5pc0RlZmluZWQoZGVmYXVsdENvbmZpZy53aGVyZSkgPyAnIFdIRVJFICcgKyBkZWZhdWx0Q29uZmlnLndoZXJlIDogJyAnO1xuICAgICAgZGVmYXVsdENvbmZpZy5vcmRlckJ5ID0gYW5ndWxhci5pc0RlZmluZWQoZGVmYXVsdENvbmZpZy5vcmRlckJ5KSA/ICcgT1JERVIgQlkgJyArIGRlZmF1bHRDb25maWcub3JkZXJCeSA6ICcgJztcblxuICAgICAgZmlsZU5hbWUgPSBmaWxlTmFtZSArICcuJyArIGRlZmF1bHRDb25maWcuZm9ybWF0VG87XG5cbiAgICAgIHJldHVybiBhbGFzcWwucHJvbWlzZSgnU0VMRUNUICcgKyBidWlsZEZpZWxkcyhmaWVsZHMpICsgJyBJTlRPICcgKyBkZWZhdWx0Q29uZmlnLmZvcm1hdFRvLnRvVXBwZXJDYXNlKCkgKyAnKD8sID8pIEZST00gPyAnICsgZGVmYXVsdENvbmZpZy53aGVyZSArIGRlZmF1bHRDb25maWcub3JkZXJCeSwgW2ZpbGVOYW1lLCBkZWZhdWx0Q29uZmlnLCBkYXRhXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0YSBvcyBkYWRvcyBlbnZpYWRvcyBwYXJhIGNzdlxuICAgICAqXG4gICAgICogQHNlZSBleHBvcnRUb1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4cG9ydFRvQ1NWKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZykge1xuICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoY29uZmlnKSkgY29uZmlnID0ge307XG5cbiAgICAgIGNvbmZpZy5mb3JtYXRUbyA9ICdjc3YnO1xuXG4gICAgICByZXR1cm4gZXhwb3J0VG8oZmllbGRzLCBkYXRhLCBmaWxlTmFtZSwgY29uZmlnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnRhIG9zIGRhZG9zIGVudmlhZG9zIHBhcmEgZXhjZWxcbiAgICAgKlxuICAgICAqIEBzZWUgZXhwb3J0VG9cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleHBvcnRUb0V4Y2VsKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZykge1xuICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoY29uZmlnKSkgY29uZmlnID0ge307XG5cbiAgICAgIGNvbmZpZy5mb3JtYXRUbyA9ICd4bHN4JztcblxuICAgICAgcmV0dXJuIGV4cG9ydFRvKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTW9udGEgdW1hIHN0cmluZyBjb250ZW5kbyBvcyBjYW1wb3MgcGFyYSBvIFNFTEVDVCBkYSBRdWVyeS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBidWlsZEZpZWxkcyhmaWVsZHMpIHtcbiAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZmllbGRzKSkge1xuICAgICAgICBmaWVsZHMgPSBsb2Rhc2gubWFwKGZpZWxkcywgZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgICAgcmV0dXJuIGZpZWxkLm5hbWUgKyAnIGFzIFsnICsgZmllbGQubGFiZWwgKyAnXSc7XG4gICAgICAgIH0pLmpvaW4oJywgJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmaWVsZHM7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9iajtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblxuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmlsdGVyKCdwckRhdGUnLCBwckRhdGUpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gcHJEYXRlKG1vbWVudCkge1xuICAgIC8qKlxuICAgICAqIEZvcm1hdGEgdW1hIGRhdGEgbm8gcGFkcsOjbyBicmFzaWxlaXJvXG4gICAgICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSwgaW5wdXRGb3JtYXQpIHtcbiAgICAgIHZhciBvdXRwdXRGb3JtYXQgPSAnREQvTU0vWVlZWSc7XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChpbnB1dEZvcm1hdCkpIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh2YWx1ZSwgaW5wdXRGb3JtYXQpLmZvcm1hdChvdXRwdXRGb3JtYXQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh2YWx1ZSkuZm9ybWF0KG91dHB1dEZvcm1hdCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblxuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmlsdGVyKCdwckRhdGV0aW1lJywgcHJEYXRldGltZSk7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LXBhcmFtc1xuICBmdW5jdGlvbiBwckRhdGV0aW1lKG1vbWVudCkge1xuICAgIC8qKlxuICAgICAqIEZvcm1hdGEgdW1hIGRhdGEgY29tIGhvcsOhcmlvIG5vIHBhZHLDo28gYnJhc2lsZWlyb1xuICAgICAqL1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiBtb21lbnQodmFsdWUpLmZvcm1hdCgnREQvTU0vWVlZWSBISDptbScpO1xuICAgIH07XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmZpbHRlcigncmVhbCcsIHJlYWwpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gcmVhbCgkZmlsdGVyKSB7XG4gICAgLyoqXG4gICAgICogRm9ybWF0YSB1bSB2YWxvciBwYXJhIG8gcGFkcsOjbyBicmFzaWxlaXJvXG4gICAgICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuICRmaWx0ZXIoJ2N1cnJlbmN5JykodmFsdWUsICdSJCAnKTtcbiAgICB9O1xuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qIGVzbGludC1kaXNhYmxlIG1heC1sZW4gKi9cblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5jb25zdGFudCgnUHJJY29ucycsIFt7XG4gICAgaWQ6ICdwci1leGNlbCcsXG4gICAgdXJsOiAncHItZXhjZWwuc3ZnJyxcbiAgICBzdmc6ICc8c3ZnIGhlaWdodD1cIjI0XCIgd2lkdGg9XCIyNFwiIHN0eWxlPVwiZmlsbDojMkU3RDMyXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPjxwYXRoIGQ9XCJNNiwySDE0TDIwLDhWMjBBMiwyIDAgMCwxIDE4LDIySDZBMiwyIDAgMCwxIDQsMjBWNEEyLDIgMCAwLDEgNiwyTTEzLDMuNVY5SDE4LjVMMTMsMy41TTE3LDExSDEzVjEzSDE0TDEyLDE0LjY3TDEwLDEzSDExVjExSDdWMTNIOEwxMSwxNS41TDgsMThIN1YyMEgxMVYxOEgxMEwxMiwxNi4zM0wxNCwxOEgxM1YyMEgxN1YxOEgxNkwxMywxNS41TDE2LDEzSDE3VjExWlwiIC8+PC9zdmc+J1xuICB9XSk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmRpcmVjdGl2ZSgncHJQYWdpbmF0aW9uJywgcGFnaW5hdGlvbkRpcmVjdGl2ZSk7XG5cbiAgLyoqXG4gICAqIERpcmV0aXZhIHF1ZSBleGliZSB1bWEgcGFnaW5hw6fDo28uXG4gICAqIEFkb3RhIG8gZXN0aWxvIGRlIHBhZ2luYcOnw6NvIGRhIEJ1c2NhIGRvIEdvb2dsZS5cbiAgICogVXRpbGl6YSBvcyBlc3RpbG9zIGRvIGJvb3RzdHJhcFxuICAgKi9cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBwYWdpbmF0aW9uRGlyZWN0aXZlKCkge1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0FFJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHBhZ2luYXRvcjogJz0nXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGU6ICdcXG4gICAgICAgIDxzZWN0aW9uIGNsYXNzPVwicHItcGFnaW5hdGlvblwiIGxheW91dD1cInJvd1wiPlxcbiAgICAgICAgICA8c2VjdGlvbiBsYXlvdXQ9XCJyb3dcIiBsYXlvdXQtYWxpZ249XCJjZW50ZXIgY2VudGVyXCIgbGF5b3V0LXdyYXBcXG4gICAgICAgICAgICBzdHlsZT1cIm1hcmdpbi1yaWdodDogMTBweFwiXFxuICAgICAgICAgICAgbmctc2hvdz1cInBhZ2luYXRvci5udW1iZXJPZlBhZ2VzID4gMVwiPlxcbiAgICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXFxuICAgICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwicGFnaW5hdG9yLmN1cnJlbnRQYWdlID09PSAxXCJcXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCJwYWdpbmF0b3IuZ29Ub1BhZ2UoMSlcIj57e3BhZ2luYXRvci5vcHRpb25zLmxhYmVscy5maXJzdH19PC9tZC1idXR0b24+XFxuICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcXG4gICAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCJwYWdpbmF0b3IuY3VycmVudFBhZ2UgPT09IDFcIlxcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5wcmV2aW91c1BhZ2UoKVwiPnt7cGFnaW5hdG9yLm9wdGlvbnMubGFiZWxzLnByZXZpb3VzfX08L21kLWJ1dHRvbj5cXG4gICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxcbiAgICAgICAgICAgICAgICBuZy1yZXBlYXQ9XCJuIGluIHBhZ2luYXRvci5wYWdlcyhzKVwiXFxuICAgICAgICAgICAgICAgIG5nLWNsYXNzPVwie1xcJ21kLXByaW1hcnlcXCc6IG4gPT0gcGFnaW5hdG9yLmN1cnJlbnRQYWdlfVwiXFxuICAgICAgICAgICAgICAgIG5nLWNsaWNrPVwicGFnaW5hdG9yLmdvVG9QYWdlKG4pXCJcXG4gICAgICAgICAgICAgICAgbmctYmluZD1cIm5cIj4xPC9tZC1idXR0b24+XFxuICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXFxuICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cInBhZ2luYXRvci5jdXJyZW50UGFnZSA9PSBwYWdpbmF0b3IubnVtYmVyT2ZQYWdlc1wiXFxuICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5uZXh0UGFnZSgpXCI+e3twYWdpbmF0b3Iub3B0aW9ucy5sYWJlbHMubmV4dH19PC9tZC1idXR0b24+XFxuICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXFxuICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cInBhZ2luYXRvci5jdXJyZW50UGFnZSA9PSBwYWdpbmF0b3IubnVtYmVyT2ZQYWdlc1wiXFxuICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5nb1RvUGFnZShwYWdpbmF0b3IubnVtYmVyT2ZQYWdlcylcIj57e3BhZ2luYXRvci5vcHRpb25zLmxhYmVscy5sYXN0fX08L21kLWJ1dHRvbj5cXG4gICAgICAgICAgPC9zZWN0aW9uPlxcbiAgICAgICAgICA8c2VjdGlvbiBsYXlvdXQ9XCJyb3dcIiBsYXlvdXQtYWxpZ249XCJjZW50ZXIgY2VudGVyXCJcXG4gICAgICAgICAgICBuZy1zaG93PVwicGFnaW5hdG9yLnRvdGFsID4gMFwiPlxcbiAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIiBzdHlsZT1cImN1cnNvcjogZGVmYXVsdDtcIlxcbiAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCJ0cnVlXCIgbWQtY29sb3JzPVwiOjp7YmFja2dyb3VuZDpcXCdhY2NlbnRcXCd9XCI+VG90YWw6IHt7cGFnaW5hdG9yLnRvdGFsfX0gcmVnaXN0cm8ocyk8L21kLWJ1dHRvbj5cXG4gICAgICAgICAgPC9zZWN0aW9uPlxcbiAgICAgICAgPC9zZWN0aW9uPidcbiAgICB9O1xuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmZhY3RvcnkoJ1ByUGFnaW5hdGlvbicsIHBhZ2luYXRpb25TZXJ2aWNlKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIHBhZ2luYXRpb25TZXJ2aWNlKCkge1xuXG4gICAgLyoqXG4gICAgICogQ3JpYSBlIHJldG9ybmEgdW1hIGluc3RhbmNpYSBkbyBvYmpldG8gcGFnaW5hZG9yLlxuICAgICAqXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gc2VhcmNoTWV0aG9kIC0gZnVuw6fDo28gcmVzcG9uc8OhdmVsIHBvciBjYXJyZWdhciBvcyBkYWRvc1xuICAgICAgIGUgcXVlIHZhaSBzZXIgY2hhbWFkYSBxdWFuZG8gbyB1c3XDoXJpbyBjbGljYXIgZW0gdW1hIHDDoWdpbmFcbiAgICAgKiBAcGFyYW0ge2ludH0gcGVyUGFnZSAtIE7Dum1lcm8gZGUgaXRlbnMgcG9yIHDDoWdpbmEuIFBhZHLDo28gw6kgMTAuXG4gICAgICogQHBhcmFtIHtvYmplY3R9IF9vcHRpb25zIC0gT2JqZXRvIGNvbnRlbmRvIGFzIGRlbWFpcyBjb25maWd1cmHDp8O1ZXNcbiAgICAgKi9cbiAgICB2YXIgUHJQYWdpbmFjYW8gPSBmdW5jdGlvbiBQclBhZ2luYWNhbyhzZWFyY2hNZXRob2QsIHBlclBhZ2UsIF9vcHRpb25zKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgbWF4UGFnZXM6IDEwLFxuICAgICAgICBsYWJlbHM6IHtcbiAgICAgICAgICBmaXJzdDogJ8KrwqsnLFxuICAgICAgICAgIHByZXZpb3VzOiAnwqsnLFxuICAgICAgICAgIG5leHQ6ICfCuycsXG4gICAgICAgICAgbGFzdDogJ8K7wrsnXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8vc29icmVlc2NyZXZlIG9zIHBhcmFtZXRyb3MgcGFkcsO1ZXNcbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKHBlclBhZ2UpKSB7XG4gICAgICAgIHBlclBhZ2UgPSAxMDtcbiAgICAgIH1cblxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKF9vcHRpb25zKSkge1xuICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoX29wdGlvbnMubWF4UGFnZXMpKSB7XG4gICAgICAgICAgb3B0aW9ucy5tYXhQYWdlcyA9IF9vcHRpb25zLm1heFBhZ2VzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChfb3B0aW9ucy5sYWJlbHMpKSB7XG4gICAgICAgICAgb3B0aW9ucy5sYWJlbHMgPSBfb3B0aW9ucy5sYWJlbHM7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy9jYWxjdWxhIHF1YW50YXMgcMOhZ2luYXMgdsOjbyBzZXIgZXhpYmlkYXMgbmEgcGFydGUgaW50ZXJtZWRpYXJpYSBkYSBwYWdpbmHDp8Ojb1xuICAgICAgb3B0aW9ucy5tYXhQYWdlc0lubmVyID0gTWF0aC5mbG9vcihvcHRpb25zLm1heFBhZ2VzIC8gMik7XG5cbiAgICAgIC8vQ3JpYSBvIG9iamV0byBwYWdpbmFkb3IgY29tIG9zIHBhcmFtZXRyb3MgaW5pY2lhaXNcbiAgICAgIHRoaXMuc2VhcmNoTWV0aG9kID0gc2VhcmNoTWV0aG9kO1xuICAgICAgdGhpcy5udW1iZXJPZlBhZ2VzID0gMTtcbiAgICAgIHRoaXMudG90YWwgPSAwO1xuICAgICAgdGhpcy5wZXJQYWdlID0gcGVyUGFnZTtcbiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAwO1xuICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYSBvIG7Dum1lcm8gZGUgcMOhZ2luYXMgcXVlIHZhaSBzZXIgZXhpYmlkYSBiYXNlYWRvIG5vIHRvdGFsIGRlXG4gICAgICogaXRlbnMgY29tIGEgcGVyUGFnZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbnR9IHRvdGFsIC0gdG90YWwgZGUgaXRlbnNcbiAgICAgKi9cbiAgICBQclBhZ2luYWNhby5wcm90b3R5cGUuY2FsY051bWJlck9mUGFnZXMgPSBmdW5jdGlvbiAodG90YWwpIHtcbiAgICAgIHRoaXMudG90YWwgPSB0b3RhbDtcblxuICAgICAgaWYgKHRvdGFsIDw9IDApIHtcbiAgICAgICAgdGhpcy5udW1iZXJPZlBhZ2VzID0gMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubnVtYmVyT2ZQYWdlcyA9IE1hdGguZmxvb3IodG90YWwgLyB0aGlzLnBlclBhZ2UpICsgKHRvdGFsICUgdGhpcy5wZXJQYWdlID4gMCA/IDEgOiAwKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVmVyaWZpY2EgYXMgcMOhZ2luYXMgcXVlIGRldmVtIHNlciBleGliaWRhc1xuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5wYWdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciByZXQgPSBbXTtcblxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gdGhpcy5udW1iZXJPZlBhZ2VzOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPT09IGkpIHtcbiAgICAgICAgICByZXQucHVzaChpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA8PSB0aGlzLm9wdGlvbnMubWF4UGFnZXNJbm5lciArIDEpIHtcbiAgICAgICAgICAgIGlmIChpIDw9IHRoaXMub3B0aW9ucy5tYXhQYWdlcykge1xuICAgICAgICAgICAgICByZXQucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGkgPj0gdGhpcy5jdXJyZW50UGFnZSAtIHRoaXMub3B0aW9ucy5tYXhQYWdlc0lubmVyICYmIGkgPD0gdGhpcy5jdXJyZW50UGFnZSArIHRoaXMub3B0aW9ucy5tYXhQYWdlc0lubmVyKSB7XG4gICAgICAgICAgICAgIHJldC5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJldDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FycmVnYSBvcyBkYWRvcyBkYSBww6FnaW5hIGFudGVyaW9yXG4gICAgICovXG4gICAgUHJQYWdpbmFjYW8ucHJvdG90eXBlLnByZXZpb3VzUGFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlID4gMSkge1xuICAgICAgICB0aGlzLnNlYXJjaE1ldGhvZCh0aGlzLmN1cnJlbnRQYWdlIC0gMSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENhcnJlZ2Egb3MgZGFkb3MgZGEgcHLDs3hpbWEgcMOhZ2luYVxuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5uZXh0UGFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlIDwgdGhpcy5udW1iZXJPZlBhZ2VzKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoTWV0aG9kKHRoaXMuY3VycmVudFBhZ2UgKyAxKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FycmVnYSBvcyBkYWRvcyBkYSBww6FnaW5hIGluZm9ybWFkYVxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbnR9IHBhZ2UgLSBwYWdpbmEgcXVlIGRldmUgc2VyIGNhcnJlZ2FkYVxuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5nb1RvUGFnZSA9IGZ1bmN0aW9uIChwYWdlKSB7XG4gICAgICBpZiAocGFnZSA+PSAxICYmIHBhZ2UgPD0gdGhpcy5udW1iZXJPZlBhZ2VzKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoTWV0aG9kKHBhZ2UpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgZ2V0SW5zdGFuY2U6IGZ1bmN0aW9uIGdldEluc3RhbmNlKHNlYXJjaE1ldGhvZCwgcGVyUGFnZSwgX29wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQclBhZ2luYWNhbyhzZWFyY2hNZXRob2QsIHBlclBhZ2UsIF9vcHRpb25zKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qKlxuICAgKiBEaXJldGl2YSBxdWUgZXhpYmUgdW0gc3Bpbm5lciBzZW1wcmUgcXVlIHVtIGJyb2FkY2FzdCwgbWFudWFsbWVudGUsIMOpIGRpc3BhcmFkb1xuICAgKi9cbiAgLyoqIEBuZ0luamVjdCAqL1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmNvbXBvbmVudCgncHJTcGlubmVyJywge1xuICAgIHRlbXBsYXRlOiAnXFxuICAgICAgICA8bWQtcHJvZ3Jlc3MtbGluZWFyIGNsYXNzPVwic3Bpbi1sYWJlbC1jb21wb25lbnQge3s6OiRjdHJsLmNvbG9yfX1cIlxcbiAgICAgICAgICBuZy1zdHlsZT1cIiRjdHJsLnN0eWxlXCJcXG4gICAgICAgICAgbWQtbW9kZT1cImluZGV0ZXJtaW5hdGVcIlxcbiAgICAgICAgICBuZy1zaG93PVwiJGN0cmwuc3Bpbm5lciAmJiAkY3RybC5zcGlubmVyLnNob3dcIj48L21kLXByb2dyZXNzLWxpbmVhcj5cXG4gICAgICAgICcsXG4gICAgYmluZGluZ3M6IHtcbiAgICAgIHBvc2l0aW9uOiAnQCcsXG4gICAgICBjb2xvcjogJ0AnXG4gICAgfSxcbiAgICBjb250cm9sbGVyOiBbJyRzY29wZScsIGZ1bmN0aW9uICgkc2NvcGUpIHtcbiAgICAgIHZhciBjdHJsID0gdGhpcztcblxuICAgICAgY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL0RlZmluZSBhIHBvc2nDp8Ojb1xuICAgICAgICBjdHJsLnN0eWxlID0geyBwb3NpdGlvbjogYW5ndWxhci5pc0RlZmluZWQoY3RybC5wb3NpdGlvbikgPyBjdHJsLnBvc2l0aW9uIDogJ2ZpeGVkJyB9O1xuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChjdHJsLmNvbG9yKSkgY3RybC5jb2xvciA9ICdtZC1wcmltYXJ5JztcbiAgICAgIH07XG4gICAgICAvL2NvbXBvcnRhbWVudG8gcGFkcsOjb1xuICAgICAgY3RybC5zcGlubmVyID0ge1xuICAgICAgICBzaG93OiBmYWxzZVxuICAgICAgfTtcblxuICAgICAgLy9Fc2N1dGEgbyBjYW5hbCBlbWl0aWRvIHZpYSBicm9hZGNhc3RcbiAgICAgIC8vcGFyYSBleGliaXIvZXNjb25kZXIgbyBjb21wb25lbnRlXG4gICAgICAkc2NvcGUuJG9uKCdzaG93LXNwaW5uZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGN0cmwuc3Bpbm5lciA9IHtcbiAgICAgICAgICBzaG93OiB0cnVlXG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgJHNjb3BlLiRvbignaGlkZS1zcGlubmVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBjdHJsLnNwaW5uZXIgPSB7XG4gICAgICAgICAgc2hvdzogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH1dXG4gIH0pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmZhY3RvcnkoJ1ByU3Bpbm5lcicsIHNwaW5uZXJTZXJ2aWNlKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIHNwaW5uZXJTZXJ2aWNlKCRyb290U2NvcGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2hvdzogc2hvdyxcbiAgICAgIGhpZGU6IGhpZGVcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRXhpYmUgbyBzcGlubmVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2hvdygpIHtcbiAgICAgIC8vZW1pdGUgbyBzaW5hbCBwYXJhIGEgZGlyZXRpdmEgaW5mb3JtYW5kbyBxdWUgbyBjb21wb25lbnRlIHNwaW5uZXIgZGV2ZSBzZXIgZXhpYmlkb1xuICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdzaG93LXNwaW5uZXInKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc2NvbmRlIG8gc3Bpbm5lclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhpZGUoKSB7XG4gICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2hpZGUtc3Bpbm5lcicpO1xuICAgIH1cbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5mYWN0b3J5KCdQclRvYXN0JywgVG9hc3QpO1xuXG4gIC8qKlxuICAgKiBTZXJ2acOnbyBxdWUgZW5jYXBzdWxhIGUgYW1wbGlhIG9zIHNlcnZpw6dvcyBkbyBhbmd1bGFyIHRvYXN0clxuICAgKi9cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBUb2FzdCgkbWRUb2FzdCwgbG9kYXNoLCAkbG9nKSB7XG4gICAgdmFyIG9iaiA9IHtcbiAgICAgIHN1Y2Nlc3M6IHN1Y2Nlc3MsXG4gICAgICBlcnJvcjogZXJyb3IsXG4gICAgICBlcnJvclZhbGlkYXRpb246IGVycm9yVmFsaWRhdGlvbixcbiAgICAgIGluZm86IGluZm8sXG4gICAgICB3YXJuOiB3YXJuLFxuICAgICAgaGlkZTogaGlkZVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBFeGliZSB1bWEgbm90aWZpY2HDp8Ojb1xuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1zZyAtIE1lbnNhZ2VtIGRhIG5vdGlmaWNhw6fDo29cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29sb3IgLSBDb3IgZGUgZnVuZG8gZGEgbm90aWZpY2HDp8Ojb1xuICAgICAqXG4gICAgICBAcmV0dXJucyB7cHJvbWlzc2V9IC0gUmV0b3JuYSB1bWEgcHJvbWlzc2UgcXVlIHBvZGUgb3UgbsOjbyBzZXIgcmVzb2x2aWRhXG4gICAgICovXG4gICAgZnVuY3Rpb24gdG9hc3QobXNnLCBjb2xvciwgb3B0aW9ucykge1xuICAgICAgaWYgKG1zZykge1xuICAgICAgICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgICAgICAgdGVtcGxhdGU6ICdcXG4gICAgICAgICAgICA8bWQtdG9hc3Q+XFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdG9hc3QtY29udGVudFwiIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6XFwnJyArIGNvbG9yICsgJ1xcJ31cIj5cXG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtZC10b2FzdC10ZXh0XCIgZmxleD4nICsgbXNnICsgJzwvc3Bhbj5cXG4gICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvbWQtdG9hc3Q+XFxuICAgICAgICAgICcsXG4gICAgICAgICAgcG9zaXRpb246ICd0b3AgcmlnaHQnXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNPYmplY3Qob3B0aW9ucykpIGRlZmF1bHRPcHRpb25zID0gYW5ndWxhci5tZXJnZShkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgICAgICAgcmV0dXJuICRtZFRvYXN0LnNob3coZGVmYXVsdE9wdGlvbnMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJGxvZy5kZWJ1ZygnTWVuc2FnZW0gcGFyYSBzZXIgZXhpYmlkYSBubyBUb2FzdCBuw6NvIGZvaSBpbmZvcm1hZGEnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc2NvbmRlIHVtYSBub3RpZmljYcOnw6NvXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gb2JqZWN0IC0gVW0gYXJndW1lbnRvIG9wY2lvbmFsIHBhcmEgYSBwcm9taXNlIGEgc2VyIHJlc29sdmlkYVxuICAgICAqXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSDDqSBleGVjdXRhZGEgcXVhbmRvIGEgbm90aWZpY2HDp8OjbyDDqSByZW1vdmlkYSBkbyBET01cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBoaWRlKG9iamVjdCkge1xuICAgICAgcmV0dXJuICRtZFRvYXN0LmhpZGUob2JqZWN0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdWNjZXNzKG1zZywgb3B0aW9ucykge1xuICAgICAgcmV0dXJuIHRvYXN0KG1zZywgJ2dyZWVuJywgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXJyb3IoZXJyb3JzLCBvcHRpb25zKSB7XG4gICAgICAvL3NlIGZvciB1bSBvYmpldG8gY29udGVuZG8gb3MgZXJyb3MsIGl0ZXJhIHNvYnJlIG9zIGF0cmlidXRvcyBkbyBtZXNtb1xuICAgICAgLy9wYXJhIGV4aWJpciBhKHMpIG1lbnNhZ2VtKG5zKSBkZSBlcnJvIGF0cmlidWlkYXNcbiAgICAgIGlmIChhbmd1bGFyLmlzT2JqZWN0KGVycm9ycykpIHtcbiAgICAgICAgdmFyIGVycm9yU3RyID0gJyc7XG5cbiAgICAgICAgLy8gZXhpYmUgYXMgbWVuc2FnZW0gZGUgZXJybyBjb250aWRhcyBubyBvYmpldG9cbiAgICAgICAgLy8gIHtcbiAgICAgICAgLy8gICAgXCJuYW1lXCI6IFtcIm8gY2FtcG8gbm9tZSDDqSBvYnJpZ2F0w7NyaW9cIl0sXG4gICAgICAgIC8vICAgIFwicGFzc3dvcmRcIjogW1xuICAgICAgICAvLyAgICAgIFwiQSBjb25maXJtYcOnw6NvIGRlIHNlbmhhIG7Do28gY29uZmVyZS5cIixcbiAgICAgICAgLy8gICAgICBcInNlbmhhIGRldmUgdGVyIG5vIG3DrW5pbW8gNiBjYXJhY3RlcmVzLlwiXG4gICAgICAgIC8vICAgIF1cbiAgICAgICAgLy8gIH1cbiAgICAgICAgbG9kYXNoLmZvckluKGVycm9ycywgZnVuY3Rpb24gKGtleUVycm9ycykge1xuICAgICAgICAgIGVycm9yU3RyICs9IGJ1aWxkQXJyYXlNZXNzYWdlKGtleUVycm9ycyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGVycm9ycyA9IGVycm9yU3RyO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShlcnJvcnMpKSB7XG4gICAgICAgICAgZXJyb3JzID0gYnVpbGRBcnJheU1lc3NhZ2UoZXJyb3JzKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdG9hc3QoZXJyb3JzLCAncmVkLUE3MDAnLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBidWlsZEFycmF5TWVzc2FnZShhcnJNc2cpIHtcbiAgICAgIHZhciBtc2cgPSAnJztcblxuICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShhcnJNc2cpKSB7XG4gICAgICAgIC8vaXRlcmEgc29icmUgb3MgZXJyb3MgZGUgdW0gYXRyaWJ1dG9cbiAgICAgICAgYXJyTXNnLmZvckVhY2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgbXNnICs9IGVycm9yICsgJzxici8+JztcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtc2cgKz0gYXJyTXNnICsgJzxici8+JztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG1zZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGliZSB1bSB0b2FzdCBjb20gYXMgbWVuc2FnZW5zIGRlIGVycm8gcmVmZXJlbnRlIGEgdmFsaWRhw6fDo28uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdCB8IGFycmF5fSBlcnJvcnMgLSBPYmpldG8gb3UgQXJyYXkgY29udGVuZG8gYXMgbWVuc2FnZW5zIGRlIGVycm8uIERldmUgZXN0YXJcbiAgICAgKiBubyBzZWd1aW50ZSBmb3JtYXRvLlxuICAgICAqICAge1xuICAgICAqICAgIFwibm9tZS1kby1hdHJpYnV0bzFcIjogW1wibWVuc2FnZW0gZGUgZXJybyAxXCIsIFwibWVuc2FnZW0gZGUgZXJybyAyXCJdLFxuICAgICAqICAgIFwibm9tZS1kby1hdHJpYnV0bzJcIjogW1wibWVuc2FnZW0gZGUgZXJybyAxXCJdXG4gICAgICogICB9XG4gICAgICogb3VcbiAgICAgKiAgIFtcbiAgICAgKiAgICAnTWVuc2FnZW0gMScsXG4gICAgICogICAgJ01lbnNhZ2VtIDInXG4gICAgICogICBdXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1zZyAtIE9wY2lvbmFsLiBNZW5zYWdlbSBkZSBlcnJvLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGVycm9yVmFsaWRhdGlvbihlcnJvcnMsIG1zZywgb3B0aW9ucykge1xuICAgICAgb2JqLmVycm9yKGFuZ3VsYXIuaXNBcnJheShlcnJvcnMpIHx8IGFuZ3VsYXIuaXNPYmplY3QoZXJyb3JzKSA/IGVycm9ycyA6IG1zZywgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5mbyhtc2csIG9wdGlvbnMpIHtcbiAgICAgIHJldHVybiB0b2FzdChtc2csICd0ZWFsJywgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd2Fybihtc2csIG9wdGlvbnMpIHtcbiAgICAgIHJldHVybiB0b2FzdChtc2csICd3YXJuJywgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9iajtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5kaXJlY3RpdmUoJ3ByVXBsb2FkZXJCYXNlNjQnLCBmdW5jdGlvbiAoJHEpIHtcbiAgICB2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXG4gICAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbCkge1xuICAgICAgICBpZiAoIW5nTW9kZWwpIHJldHVybjtcblxuICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbiAoKSB7fTtcblxuICAgICAgICBlbGVtZW50LmJpbmQoJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdmFyIGVsZW1lbnQgPSBlLnRhcmdldDtcblxuICAgICAgICAgICRxLmFsbChzbGljZS5jYWxsKGVsZW1lbnQuZmlsZXMsIDApLm1hcChyZWFkRmlsZSkpLnRoZW4oZnVuY3Rpb24gKHZhbHVlcykge1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQubXVsdGlwbGUpIG5nTW9kZWwuJHNldFZpZXdWYWx1ZSh2YWx1ZXMpO2Vsc2UgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKHZhbHVlcy5sZW5ndGggPyB2YWx1ZXNbMF0gOiBudWxsKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGZ1bmN0aW9uIHJlYWRGaWxlKGZpbGUpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXG4gICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShlLnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xufSkoKTsiLCIvKmVzbGludCBhbmd1bGFyL2ZpbGUtbmFtZTogMCovXG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vaW5pY2lhIG8gbW9kdWxvIGRhIGJpYmxpb3RlY2EgZSBkZWZpbmUgYXMgZGVwZW5kw6puY2lhc1xuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInLCBbJ25nTWF0ZXJpYWwnLCAnbWQuZGF0YS50YWJsZScsICduZ01hdGVyaWFsRGF0ZVBpY2tlcicsICdhbmd1bGFyRmlsZVVwbG9hZCddKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5jb25maWcoY29uZmlnKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIGNvbmZpZygkbWRUaGVtaW5nUHJvdmlkZXIsICRtZEljb25Qcm92aWRlcixcbiAgICBtb21lbnQsIFBySWNvbnMsICRxUHJvdmlkZXIpIHtcbiAgICAvL2NvbmZpZ3VyYcOnw7VlcyBwYWRyw7VlcyBkYXMgYmlibGlvdGVjYXMgcXVlIHPDo28gdXRpbGl6YWRhc1xuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXG4gICAgICAucHJpbWFyeVBhbGV0dGUoJ2luZGlnbycpXG4gICAgICAuYWNjZW50UGFsZXR0ZSgnYW1iZXInKTtcblxuICAgIG1vbWVudC5sb2NhbGUoJ3B0LUJSJyk7XG5cbiAgICBtb21lbnQuY3JlYXRlRnJvbUlucHV0RmFsbGJhY2sgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgIC8vIHVucmVsaWFibGUgc3RyaW5nIG1hZ2ljLCBvclxuICAgICAgY29uZmlnLl9kID0gbmV3IERhdGUoY29uZmlnLl9pKTtcbiAgICB9O1xuXG4gICAgJHFQcm92aWRlci5lcnJvck9uVW5oYW5kbGVkUmVqZWN0aW9ucyhmYWxzZSk7XG5cbiAgICBhbmd1bGFyLmZvckVhY2goUHJJY29ucywgZnVuY3Rpb24oaWNvbikge1xuICAgICAgJG1kSWNvblByb3ZpZGVyLmljb24oaWNvbi5pZCwgaWNvbi51cmwpO1xuICAgIH0pO1xuICB9XG59KCkpO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludCBhbmd1bGFyL2ZpbGUtbmFtZTogMCovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvL2luaWNpYSBvIG1vZHVsbyBkYSBiaWJsaW90ZWNhIGUgZGVmaW5lIGFzIGRlcGVuZMOqbmNpYXNcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInLCBbJ25nTWF0ZXJpYWwnLCAnbWQuZGF0YS50YWJsZScsICduZ01hdGVyaWFsRGF0ZVBpY2tlcicsICdhbmd1bGFyRmlsZVVwbG9hZCddKTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBjb25maWcuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdQcm92aWRlclwiLCBcIiRtZEljb25Qcm92aWRlclwiLCBcIm1vbWVudFwiLCBcIlBySWNvbnNcIiwgXCIkcVByb3ZpZGVyXCJdO1xuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5jb25maWcoY29uZmlnKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIGNvbmZpZygkbWRUaGVtaW5nUHJvdmlkZXIsICRtZEljb25Qcm92aWRlciwgbW9tZW50LCBQckljb25zLCAkcVByb3ZpZGVyKSB7XG4gICAgLy9jb25maWd1cmHDp8O1ZXMgcGFkcsO1ZXMgZGFzIGJpYmxpb3RlY2FzIHF1ZSBzw6NvIHV0aWxpemFkYXNcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKS5wcmltYXJ5UGFsZXR0ZSgnaW5kaWdvJykuYWNjZW50UGFsZXR0ZSgnYW1iZXInKTtcblxuICAgIG1vbWVudC5sb2NhbGUoJ3B0LUJSJyk7XG5cbiAgICBtb21lbnQuY3JlYXRlRnJvbUlucHV0RmFsbGJhY2sgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAvLyB1bnJlbGlhYmxlIHN0cmluZyBtYWdpYywgb3JcbiAgICAgIGNvbmZpZy5fZCA9IG5ldyBEYXRlKGNvbmZpZy5faSk7XG4gICAgfTtcblxuICAgICRxUHJvdmlkZXIuZXJyb3JPblVuaGFuZGxlZFJlamVjdGlvbnMoZmFsc2UpO1xuXG4gICAgYW5ndWxhci5mb3JFYWNoKFBySWNvbnMsIGZ1bmN0aW9uIChpY29uKSB7XG4gICAgICAkbWRJY29uUHJvdmlkZXIuaWNvbihpY29uLmlkLCBpY29uLnVybCk7XG4gICAgfSk7XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qZXNsaW50IGFuZ3VsYXIvZmlsZS1uYW1lOiAwLCBuby11bmRlZjogMCovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvL2VuY2Fwc3VsYSBhcyBiaWJsaW90ZWNhcyBleHRlcm5hcyBwYXJhIHNlcmVtIGNhcnJlZ2FkYXMgY29tbyB1bWEgZGVwZW5kw6puY2lhXG4gIC8vZG8gYW5ndWxhci5cblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5jb25zdGFudCgnbG9kYXNoJywgXykuY29uc3RhbnQoJ2FsYXNxbCcsIGFsYXNxbCkuY29uc3RhbnQoJ21vbWVudCcsIG1vbWVudCk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgcnVuLiRpbmplY3QgPSBbXCIkdGVtcGxhdGVDYWNoZVwiLCBcIlBySWNvbnNcIl07XG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLnJ1bihydW4pO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gcnVuKCR0ZW1wbGF0ZUNhY2hlLCBQckljb25zKSB7XG4gICAgYW5ndWxhci5mb3JFYWNoKFBySWNvbnMsIGZ1bmN0aW9uIChpY29uKSB7XG4gICAgICAkdGVtcGxhdGVDYWNoZS5wdXQoaWNvbi51cmwsIGljb24uc3ZnKTtcbiAgICB9KTtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICogRGlyZXRpdmEgcXVlIGV4aWJlIHVtIHNwaW5uZXIgc2VtcHJlIHF1ZSB1bSBicm9hZGNhc3QsIG1hbnVhbG1lbnRlLCDDqSBkaXNwYXJhZG9cbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5kaXJlY3RpdmUoJ3ByRGF0ZVRpbWVQaWNrZXInLCBbXCJtb21lbnRcIiwgZnVuY3Rpb24gKG1vbWVudCkge1xuXG4gICAgZnVuY3Rpb24gYnVpbGREYXRlUGlja2VyKGF0dHIpIHtcbiAgICAgIHZhciBhdXRvT2sgPSBhbmd1bGFyLmlzVW5kZWZpbmVkKGF0dHIuYXV0b09rKSB8fCBhdHRyLmF1dG9PayA9PT0gJ3RydWUnO1xuICAgICAgdmFyIHdpdGhUaW1lID0gYW5ndWxhci5pc0RlZmluZWQoYXR0ci53aXRoVGltZSkgJiYgYXR0ci53aXRoVGltZSA9PT0gJ3RydWUnO1xuICAgICAgdmFyIHdpdGhNaW51dGVzUGlja2VyID0gYW5ndWxhci5pc1VuZGVmaW5lZChhdHRyLndpdGhNaW51dGVzUGlja2VyKSB8fCBhdHRyLndpdGhNaW51dGVzUGlja2VyID09PSAndHJ1ZSc7XG4gICAgICB2YXIgZm9ybWF0ID0gYXR0ci5mb3JtYXQgfHwgKHdpdGhUaW1lID8gJ0REL01NL1lZWVkgSEg6bW0nIDogJ0REL01NL1lZWVknKTtcblxuICAgICAgLyoqXG4gICAgICAgKiBDb25zdHJvaSBvIHRlbXBsYXRlIGRvIGNvbXBvbmVudGUgZGUgZXNjb2xoYSBkZSBkYXRhXG4gICAgICAgKi9cbiAgICAgIHJldHVybiAnXFxuICAgICAgICAgICAgPGlucHV0XFxuICAgICAgICAgICAgICBpZD1cIicgKyBhdHRyLmlkICsgJ1wiXFxuICAgICAgICAgICAgICBtZGMtZGF0ZXRpbWUtcGlja2VyXFxuICAgICAgICAgICAgICBuZy1tb2RlbD1cIm5nTW9kZWxcIlxcbiAgICAgICAgICAgICAgc2hvdy10b2RheXMtZGF0ZVxcbiAgICAgICAgICAgICAgZGF0ZT1cInRydWVcIlxcbiAgICAgICAgICAgICAgdGltZT1cIicgKyB3aXRoVGltZSArICdcIlxcbiAgICAgICAgICAgICAgbWludXRlcz1cIicgKyB3aXRoTWludXRlc1BpY2tlciArICdcIlxcbiAgICAgICAgICAgICAgY2FuY2VsLXRleHQ9XCJDYW5jZWxhclwiXFxuICAgICAgICAgICAgICB0b2RheS10ZXh0PVwiSG9qZVwiXFxuICAgICAgICAgICAgICBhdXRvLW9rPVwiJyArIGF1dG9PayArICdcIlxcbiAgICAgICAgICAgICAgZm9ybWF0PVwiJyArIGZvcm1hdCArICdcIlxcbiAgICAgICAgICAgICAgbWluLWRhdGU9XCInICsgKGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubWluRGF0ZSkgPyBtb21lbnQoYXR0ci5taW5EYXRlKS5mb3JtYXQoZm9ybWF0KSA6ICcnKSArICdcIlxcbiAgICAgICAgICAgICAgbWF4LWRhdGU9XCJcXCcnICsgKGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubWF4RGF0ZSkgPyBtb21lbnQoYXR0ci5tYXhEYXRlKS5mb3JtYXQoZm9ybWF0KSA6ICcnKSArICdcXCdcIj5cXG4gICAgICAgICAgICA8L2lucHV0PlxcbiAgICAgICAgJztcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgdGVtcGxhdGU6IGZ1bmN0aW9uIHRlbXBsYXRlKGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgICAgdmFyIHRlbXBsYXRlID0gYnVpbGREYXRlUGlja2VyKGF0dHIpO1xuXG4gICAgICAgIHJldHVybiB0ZW1wbGF0ZTtcbiAgICAgIH0sXG4gICAgICBzY29wZToge1xuICAgICAgICBuZ01vZGVsOiAnPScsXG4gICAgICAgIGxheW91dDogJz0nLFxuICAgICAgICBpZDogJz0nLFxuICAgICAgICB3aXRoVGltZTogJz0/JyxcbiAgICAgICAgd2l0aE1pbnV0ZXNQaWNrZXI6ICc9PycsXG4gICAgICAgIGF1dG9PazogJz0/JyxcbiAgICAgICAgZm9ybWF0OiAnPT8nLFxuICAgICAgICBtaW5EYXRlOiAnPT8nLFxuICAgICAgICBtYXhEYXRlOiAnPT8nXG4gICAgICB9XG4gICAgfTtcbiAgfV0pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBkaWFsb2dTZXJ2aWNlLiRpbmplY3QgPSBbXCIkbG9nXCIsIFwiJG1kRGlhbG9nXCIsIFwiJG1kVXRpbFwiLCBcIiRyb290U2NvcGVcIiwgXCIkYW5pbWF0ZVwiLCBcIiRkb2N1bWVudFwiXTtcbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmFjdG9yeSgnUHJEaWFsb2cnLCBkaWFsb2dTZXJ2aWNlKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIGRpYWxvZ1NlcnZpY2UoJGxvZywgJG1kRGlhbG9nLCAkbWRVdGlsLCAkcm9vdFNjb3BlLCAkYW5pbWF0ZSwgJGRvY3VtZW50KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGN1c3RvbTogY3VzdG9tLFxuICAgICAgY29uZmlybTogY29uZmlybSxcbiAgICAgIGNsb3NlOiBjbG9zZVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBjb25maWd1cmEgZSByZWFsaXphIG8gbWVyZ2UgZG8gb2JqZXRvIHJlY2ViaWRvIHZpYSBwYXLDom1ldHJvXG4gICAgICogY29tIGEgY29uZmlndXJhw6fDo28gcGFkcsOjbyBwYXJhIGEgZXhpYmnDp8OjbyBkbyBkaWFsb2dcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gY29uZmlnIC0gT2JqZXRvIGNvbnRlbmRvIGFzIGNvbmZpZ3VyYcOnw7Vlc1xuICAgICAqIEByZXR1cm5zIHtkaWFsb2dTZXJ2aWNlfSAtIFJldG9ybmEgbyBzZXJ2aWNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gYnVpbGQoY29uZmlnKSB7XG5cbiAgICAgIGlmICghYW5ndWxhci5pc09iamVjdChjb25maWcpKSB7XG4gICAgICAgICRsb2cuZXJyb3IoJ1ByRGlhbG9nOiBQYXLDom1ldHJvIGludsOhbGlkbywgw6kgZXNwZXJhbmRvIHVtIG9iamV0byBjb21vIHBhcsOibWV0cm8uJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgICAgICBoYXNCYWNrZHJvcDogZmFsc2UsXG4gICAgICAgIGVzY2FwZVRvQ2xvc2U6IGZhbHNlLFxuICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICBhdXRvV3JhcDogdHJ1ZSxcbiAgICAgICAgc2tpcEhpZGU6IHRydWUsXG4gICAgICAgIGxvY2Fsczoge30sXG4gICAgICAgIHpJbmRleDogNzUsXG4gICAgICAgIGZ1bGxzY3JlZW46IGZhbHNlXG4gICAgICB9O1xuXG4gICAgICAvL27Do28gZmF6ZW1vcyBtZXJnZSBkYSBwcm9wcmllZGFkZSBsb2NhbHMgcGFyYSBuw6NvIGVzdG91cmFyIG8gbGltaXRlIGRlIHJlY3Vyc2l2aWRhZGVcbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChjb25maWcubG9jYWxzKSkge1xuICAgICAgICBkZWZhdWx0T3B0aW9ucy5sb2NhbHMgPSBjb25maWcubG9jYWxzO1xuICAgICAgICBkZWxldGUgY29uZmlnLmxvY2FscztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGFuZ3VsYXIubWVyZ2UoZGVmYXVsdE9wdGlvbnMsIGNvbmZpZyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTcOpdG9kbyBxdWUgZXhpYmUgbyBkaWFsb2cgZGUgY29uZmlybWHDp8OjbyBuYSB0ZWxhIGRlcG9pcyBxdWUgbyBidWlsZCBlIGludm9jYWRvXG4gICAgICogZGUgdW1hIGRldGVybWluYWRhIGHDp8Ojb1xuICAgICAqIEByZXR1cm5zIHtwcm9taXNzZX0gLSBSZXRvcm5hIHVtYSBwcm9taXNzZSBxdWUgcG9kZSBvdSBuw6NvIHNlciByZXNvbHZpZGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb25maXJtKGNvbmZpZykge1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IGJ1aWxkKGNvbmZpZyk7XG5cbiAgICAgIG9wdGlvbnMudGVtcGxhdGUgPSAnIDxtZC1kaWFsb2cgZmxleD01MCBhcmlhLWxhYmVsPVwie3s6OmN0cmwudGl0bGV9fVwiPlxcbiAgICAgICAgICAgICAgPG1kLXRvb2xiYXIgbWQtc2Nyb2xsLXNocmluaz5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXRvb2xiYXItdG9vbHNcIj5cXG4gICAgICAgICAgICAgICAgICA8aDM+XFxuICAgICAgICAgICAgICAgICAgICA8c3Bhbj57ezo6Y3RybC50aXRsZX19PC9zcGFuPlxcbiAgICAgICAgICAgICAgICAgIDwvaDM+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgPC9tZC10b29sYmFyPlxcbiAgICAgICAgICAgICAgPG1kLWRpYWxvZy1jb250ZW50IGxheW91dC1tYXJnaW4+XFxuICAgICAgICAgICAgICAgIDxwPnt7OjpjdHJsLmRlc2NyaXB0aW9ufX08L3A+XFxuICAgICAgICAgICAgICA8L21kLWRpYWxvZy1jb250ZW50PlxcbiAgICAgICAgICAgICAgPG1kLWRpYWxvZy1hY3Rpb25zPlxcbiAgICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcXG4gICAgICAgICAgICAgICAgICBtZC1jb2xvcnM9XCI6OntiYWNrZ3JvdW5kOlxcJ2RlZmF1bHQte3tjdHJsLnllc0JnQ29sb3J9fVxcJ31cIlxcbiAgICAgICAgICAgICAgICAgIG5nLWNsaWNrPVwiY3RybC55ZXNBY3Rpb24oKVwiPlNpbTwvbWQtYnV0dG9uPlxcbiAgICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcXG4gICAgICAgICAgICAgICAgICBtZC1jb2xvcnM9XCI6OntiYWNrZ3JvdW5kOlxcJ2RlZmF1bHQte3tjdHJsLm5vQmdDb2xvcn19XFwnfVwiXFxuICAgICAgICAgICAgICAgICAgbmctY2xpY2s9XCJjdHJsLm5vQWN0aW9uKClcIj5OXFx4RTNvPC9tZC1idXR0b24+XFxuICAgICAgICAgICAgICA8L21kLWRpYWxvZy1hY3Rpb25zPlxcbiAgICAgICAgICAgIDwvbWQtZGlhbG9nPlxcbiAgICAgICAgICAnO1xuICAgICAgb3B0aW9ucy5sb2NhbHMgPSB7XG4gICAgICAgIHRpdGxlOiBhbmd1bGFyLmlzRGVmaW5lZChvcHRpb25zLnRpdGxlKSA/IG9wdGlvbnMudGl0bGUgOiAnJyxcbiAgICAgICAgZGVzY3JpcHRpb246IGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMuZGVzY3JpcHRpb24pID8gb3B0aW9ucy5kZXNjcmlwdGlvbiA6ICcnLFxuICAgICAgICB5ZXNCZ0NvbG9yOiBhbmd1bGFyLmlzRGVmaW5lZChvcHRpb25zLnllc0JnQ29sb3IpID8gb3B0aW9ucy55ZXNCZ0NvbG9yIDogJ3ByaW1hcnknLFxuICAgICAgICBub0JnQ29sb3I6IGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMubm9CZ0NvbG9yKSA/IG9wdGlvbnMubm9CZ0NvbG9yIDogJ2FjY2VudCdcbiAgICAgIH07XG5cbiAgICAgIG9wdGlvbnMuY29udHJvbGxlciA9IFsnJG1kRGlhbG9nJywgZnVuY3Rpb24gKCRtZERpYWxvZykge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIHZtLm5vQWN0aW9uID0gbm9BY3Rpb247XG4gICAgICAgIHZtLnllc0FjdGlvbiA9IHllc0FjdGlvbjtcblxuICAgICAgICBmdW5jdGlvbiBub0FjdGlvbigpIHtcbiAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24geWVzQWN0aW9uKCkge1xuICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgIH1dO1xuXG4gICAgICBvcHRpb25zLmNvbnRyb2xsZXJBcyA9ICdjdHJsJztcbiAgICAgIG9wdGlvbnMuY2xpY2tPdXRzaWRlVG9DbG9zZSA9IGZhbHNlO1xuICAgICAgb3B0aW9ucy5oYXNCYWNrZHJvcCA9IHRydWU7XG5cbiAgICAgIHJldHVybiAkbWREaWFsb2cuc2hvdyhvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBleGliZSBvIGRpYWxvZyBjdXN0b21pemFkbyBuYSB0ZWxhIGRlcG9pcyBxdWUgbyBidWlsZCBlIGludm9jYWRvXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGN1c3RvbShjb25maWcpIHtcblxuICAgICAgdmFyIG9wdGlvbnMgPSBidWlsZChjb25maWcpO1xuXG4gICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChvcHRpb25zLnRlbXBsYXRlVXJsKSAmJiBhbmd1bGFyLmlzVW5kZWZpbmVkKG9wdGlvbnMudGVtcGxhdGUpKSB7XG4gICAgICAgICRsb2cuZXJyb3IoJ1ByRGlhbG9nOiB0ZW1wbGF0ZVVybCBvdSB0ZW1wbGF0ZSBpbmRlZmluaWRvLCDDqSBlc3BlcmFuZG8gdW0gdGVtcGxhdGVVcmwgb3UgdW0gdGVtcGxhdGUgY29tbyBhdHJpYnV0by4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvL0NyaWFkbyBvIGJhY2tkcm9wIG1hbnVhbG1lbnRlIHBhcmEgZGltaW51aXIgbyB6LWluZGV4IGF0cmF2w6lzIGRlIHVtYSBjbGFzc2UgY3NzXG4gICAgICAvL28gei1pbmRleCB0ZW0gcXVlIGZpY2FyIG1lbm9yIGRldmlkbyBhbyBkaWFsb2cuY29uZmlybSB1c2FyIG8gei1pbmRleCBvcmlnaW5hbCBkZSA4MFxuICAgICAgb3B0aW9ucyA9IGFkZEJhY2tkcm9wKG9wdGlvbnMpO1xuXG4gICAgICBvcHRpb25zLmhhc0JhY2tkcm9wID0gZmFsc2U7XG5cbiAgICAgIHJldHVybiAkbWREaWFsb2cuc2hvdyhvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBjcmlhIG8gYmFja2Ryb3AgZSBtb3N0cmEgbmEgdGVsYSBjb20gbyB6LWluZGV4IGNvbmZpZ3VyYXbDqWxcbiAgICAgKiBwYXJhIHNvYnJlcG9yIG9zIGVsZW1lbnRvcyBkYSB0ZWxhXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWRkQmFja2Ryb3Aob3B0aW9ucykge1xuICAgICAgaWYgKG9wdGlvbnMuaGFzQmFja2Ryb3ApIHtcbiAgICAgICAgdmFyIGJhY2tkcm9wID0gJG1kVXRpbC5jcmVhdGVCYWNrZHJvcCgkcm9vdFNjb3BlLCAnbWQtZGlhbG9nLWJhY2tkcm9wIG1kLW9wYXF1ZSBtZC1iYWNrZHJvcC1jdXN0b20nKTtcblxuICAgICAgICAkYW5pbWF0ZS5lbnRlcihiYWNrZHJvcCwgYW5ndWxhci5lbGVtZW50KCRkb2N1bWVudC5maW5kKCdib2R5JykpKTtcblxuICAgICAgICB2YXIgb3JpZ2luYWxPblJlbW92aW5nID0gb3B0aW9ucy5vblJlbW92aW5nO1xuXG4gICAgICAgIC8vTcOpdG9kbyBleGVjdXRhZG8gcXVhbmRvIGEgYW5pbWHDp8OjbyBkZSBmZWNoYW1lbnRvIGRvIGRpYWxvZyB0ZXJtaW5hXG4gICAgICAgIG9wdGlvbnMub25SZW1vdmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBiYWNrZHJvcC5yZW1vdmUoKTtcbiAgICAgICAgICBpZiAoYW5ndWxhci5pc0Z1bmN0aW9uKG9yaWdpbmFsT25SZW1vdmluZykpIG9yaWdpbmFsT25SZW1vdmluZy5jYWxsKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIG9yaWdpbmFsT25Db21wbGV0ZSA9IG9wdGlvbnMub25Db21wbGV0ZTtcblxuICAgICAgICAvL03DqXRvZG8gZXhlY3V0YWRvIHF1YW5kbyBhIGFuaW1hw6fDo28gZGUgYWJlcnR1cmEgZG8gZGlhbG9nIHRlcm1pbmFcbiAgICAgICAgb3B0aW9ucy5vbkNvbXBsZXRlID0gZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgICAgdmFyIHpJbmRleCA9IHBhcnNlSW50KG9wdGlvbnMuekluZGV4LCAxMCk7XG5cbiAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJGRvY3VtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1iYWNrZHJvcC1jdXN0b20nKSkuY3NzKCd6LWluZGV4JywgekluZGV4KTtcbiAgICAgICAgICBlbGVtZW50LmNzcygnei1pbmRleCcsIHpJbmRleCArIDEpO1xuICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24ob3JpZ2luYWxPbkNvbXBsZXRlKSkgb3JpZ2luYWxPbkNvbXBsZXRlLmNhbGwoKTtcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTcOpdG9kbyBxdWUgc2VydmUgcGFyYSBmZWNoYXIgbyBkaWFsb2dcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgfVxuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIFByRmlsZS4kaW5qZWN0ID0gW1wiYWxhc3FsXCIsIFwibG9kYXNoXCIsIFwiJGZpbHRlclwiXTtcbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmFjdG9yeSgnUHJGaWxlJywgUHJGaWxlKTtcblxuICAvKipcbiAgICogU2VydmljZSBxdWUgZW5jYXBzdWxhIG9zIHNlcnZpw6dvc1xuICAgKiBkZSBleHBvcnRhw6fDo28gZSBpbXBvcnRhw6fDo28gZGUgYXJxdWl2b3NcbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gUHJGaWxlKGFsYXNxbCwgbG9kYXNoLCAkZmlsdGVyKSB7XG4gICAgdmFyIG9iaiA9IHtcbiAgICAgIGV4cG9ydFRvRXhjZWw6IGV4cG9ydFRvRXhjZWwsXG4gICAgICBleHBvcnRUb0NTVjogZXhwb3J0VG9DU1ZcbiAgICB9O1xuXG4gICAgLy9EZWZpbmVkIGZpbHRlcnNcblxuICAgIGFsYXNxbC5mbi5mb3JtYXREYXRlID0gZnVuY3Rpb24gKGRhdGUsIGZvcm1hdCkge1xuICAgICAgcmV0dXJuICRmaWx0ZXIoJ3ByRGF0ZScpKGRhdGUsIGZvcm1hdCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEV4cG9ydGEgb3MgZGFkb3MgZW52aWFkb3MgcGFyYSBvIGZvcm1hdG8gaW5mb3JtYWRvLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd8YXJyYXl9IGZpZWxkc1xuICAgICAqICBTdHJpbmcgY29udGVuZG8gb3MgY2FtcG9zIHNlcGFyYWRvIHBvciB2aXJndWxhXG4gICAgICogICAgZXg6IG5hbWUsIGRlc2NyaXB0aW9uXG4gICAgICogICAgZXg6IG5hbWUgYXMgTm9tZSwgZGVzY3JpcHRpb24gYXMgJ0Rlc2NyacOnw6NvJ1xuICAgICAqICAgIGV4OiAqICAocGFyYSB0b2RvcyBvcyBjYW1wb3MpXG4gICAgICogIEFycmF5IGRlIG9iamV0b3MgY29tIG9zIGNhbXBvc1xuICAgICAqICAgIGV4OiBbXG4gICAgICogICAgICB7IG5hbWU6ICduYW1lJywgbGFiZWw6ICdOb21lJyB9LFxuICAgICAqICAgICAgeyBuYW1lOiAnZGVzY3JpcHRpb24nLCBsYWJlbDogJ0Rlc2NyacOnw6NvJyB9LFxuICAgICAqICAgICAgeyBuYW1lOiAncm9sZS5uYW1lJywgbGFiZWw6ICdQZXJmaWwnIH0sXG4gICAgICogICAgICB7IG5hbWU6ICdmb3JtYXREYXRlKGRhdGUpJywgbGFiZWw6ICdEYXRhJyB9LCpcbiAgICAgKiAgICBdXG4gICAgICogQHBhcmFtIHthcnJheX0gZGF0YSAtIEFycmF5IHF1ZSB2YWkgc2VydmlyIGNvbW8gZm9udGUgZGUgZGFkb3NcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsZU5hbWUgLSBOb21lIGRvIGFycXVpdm8gc2VtIGEgZXh0ZW5zw6NvXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGNvbmZpZ1xuICAgICAqIENvbmZpZ3VyYcOnw7VlcyBkYSBkb2N1bWVudGHDp8OjbyBkbyBhbGFzcWwgY29tbzpcbiAgICAgKiAgLSAoYm9vbGVhbikgaGVhZGVyc1xuICAgICAqIG1haXMgYXMgZGVzdGFjYWRhcyBhYmFpeG9cbiAgICAgKiAgLSAoc3RyaW5nKSB3aGVyZVxuICAgICAqICAtIChzdHJpbmcpIG9yZGVyQnlcbiAgICAgKlxuICAgICAqIGZpbHRlcnMgZGVmaW5pZG9zXG4gICAgICpcbiAgICAgKiBmb3JtYXREYXRlKGNhbXBvLCBbZm9ybWF0b10pXG4gICAgICpcbiAgICAgKiBFeGVtcGxvOlxuICAgICAqXG4gICAgICogdmFyIGNhcnMgPSBbXG4gICAgICogIHsgbmFtZTogJ1N0aWxvJywgIGJyYW5kOiAnRmlhdCcsIGRhdGU6IG1vbWVudCgpLnN1YnRyYWN0KDEsICd5ZWFycycpIH0sXG4gICAgICogIHsgbmFtZTogJ1B1bnRvJywgIGJyYW5kOiAnRmlhdCcsIGRhdGU6IG1vbWVudCgpLnN1YnRyYWN0KDMsICd5ZWFycycpIH0sXG4gICAgICogIHsgbmFtZTogJ0ZpZXN0YScsIGJyYW5kOiAnRm9yZCcsIGRhdGU6ICcwNC0wMS0yMDE3JyB9XG4gICAgICogXVxuICAgICAqXG4gICAgICogUHJGaWxlLmV4cG9ydFRvRXhjZWwoW1xuICAgICAqICB7IG5hbWU6ICdicmFuZCcsIGxhYmVsOiAnTWFyY2EnIH0sXG4gICAgICogIHsgbmFtZTogJ25hbWUnLCBsYWJlbDogJ05vbWUnIH0sXG4gICAgICogIHsgbmFtZTogJ2Zvcm1hdERhdGUoZGF0ZSwgXFwnREQtTU0tWVlZWVxcJyknLCBsYWJlbDogJ0NvbXByYWRvIGVtPycgfVxuICAgICAqIF0sIGNhcnMsICdkYXRhLWV4cG9ydCcsIHtcbiAgICAgKiAgb3JkZXJCeTogJ2JyYW5kIEFTQywgbmFtZSBBU0MnLFxuICAgICAqICB3aGVyZTogJ2JyYW5kIGxpa2UgXCIlRmklXCInXG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7cHJvbWlzc2V9IC0gUmV0b3JuYSB1bWEgcHJvbWlzc2UgcXVlIHBvZGUgb3UgbsOjbyBzZXIgcmVzb2x2aWRhXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXhwb3J0VG8oZmllbGRzLCBkYXRhLCBmaWxlTmFtZSwgY29uZmlnKSB7XG4gICAgICB2YXIgZGVmYXVsdENvbmZpZyA9IHtcbiAgICAgICAgaGVhZGVyczogdHJ1ZVxuICAgICAgfTtcblxuICAgICAgaWYgKGFuZ3VsYXIuaXNPYmplY3QoY29uZmlnKSkgYW5ndWxhci5tZXJnZShkZWZhdWx0Q29uZmlnLCBjb25maWcpO1xuICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoZmlsZU5hbWUpKSBmaWxlTmFtZSA9ICdleHBvcnQnO1xuXG4gICAgICBkZWZhdWx0Q29uZmlnLndoZXJlID0gYW5ndWxhci5pc0RlZmluZWQoZGVmYXVsdENvbmZpZy53aGVyZSkgPyAnIFdIRVJFICcgKyBkZWZhdWx0Q29uZmlnLndoZXJlIDogJyAnO1xuICAgICAgZGVmYXVsdENvbmZpZy5vcmRlckJ5ID0gYW5ndWxhci5pc0RlZmluZWQoZGVmYXVsdENvbmZpZy5vcmRlckJ5KSA/ICcgT1JERVIgQlkgJyArIGRlZmF1bHRDb25maWcub3JkZXJCeSA6ICcgJztcblxuICAgICAgZmlsZU5hbWUgPSBmaWxlTmFtZSArICcuJyArIGRlZmF1bHRDb25maWcuZm9ybWF0VG87XG5cbiAgICAgIHJldHVybiBhbGFzcWwucHJvbWlzZSgnU0VMRUNUICcgKyBidWlsZEZpZWxkcyhmaWVsZHMpICsgJyBJTlRPICcgKyBkZWZhdWx0Q29uZmlnLmZvcm1hdFRvLnRvVXBwZXJDYXNlKCkgKyAnKD8sID8pIEZST00gPyAnICsgZGVmYXVsdENvbmZpZy53aGVyZSArIGRlZmF1bHRDb25maWcub3JkZXJCeSwgW2ZpbGVOYW1lLCBkZWZhdWx0Q29uZmlnLCBkYXRhXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0YSBvcyBkYWRvcyBlbnZpYWRvcyBwYXJhIGNzdlxuICAgICAqXG4gICAgICogQHNlZSBleHBvcnRUb1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4cG9ydFRvQ1NWKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZykge1xuICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoY29uZmlnKSkgY29uZmlnID0ge307XG5cbiAgICAgIGNvbmZpZy5mb3JtYXRUbyA9ICdjc3YnO1xuXG4gICAgICByZXR1cm4gZXhwb3J0VG8oZmllbGRzLCBkYXRhLCBmaWxlTmFtZSwgY29uZmlnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnRhIG9zIGRhZG9zIGVudmlhZG9zIHBhcmEgZXhjZWxcbiAgICAgKlxuICAgICAqIEBzZWUgZXhwb3J0VG9cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleHBvcnRUb0V4Y2VsKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZykge1xuICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoY29uZmlnKSkgY29uZmlnID0ge307XG5cbiAgICAgIGNvbmZpZy5mb3JtYXRUbyA9ICd4bHN4JztcblxuICAgICAgcmV0dXJuIGV4cG9ydFRvKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTW9udGEgdW1hIHN0cmluZyBjb250ZW5kbyBvcyBjYW1wb3MgcGFyYSBvIFNFTEVDVCBkYSBRdWVyeS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBidWlsZEZpZWxkcyhmaWVsZHMpIHtcbiAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZmllbGRzKSkge1xuICAgICAgICBmaWVsZHMgPSBsb2Rhc2gubWFwKGZpZWxkcywgZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgICAgcmV0dXJuIGZpZWxkLm5hbWUgKyAnIGFzIFsnICsgZmllbGQubGFiZWwgKyAnXSc7XG4gICAgICAgIH0pLmpvaW4oJywgJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmaWVsZHM7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9iajtcbiAgfVxufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblxuICAndXNlIHN0cmljdCc7XG5cbiAgcHJEYXRlLiRpbmplY3QgPSBbXCJtb21lbnRcIl07XG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmZpbHRlcigncHJEYXRlJywgcHJEYXRlKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIHByRGF0ZShtb21lbnQpIHtcbiAgICAvKipcbiAgICAgKiBGb3JtYXRhIHVtYSBkYXRhIG5vIHBhZHLDo28gYnJhc2lsZWlyb1xuICAgICAqL1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUsIGlucHV0Rm9ybWF0KSB7XG4gICAgICB2YXIgb3V0cHV0Rm9ybWF0ID0gJ0REL01NL1lZWVknO1xuXG4gICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoaW5wdXRGb3JtYXQpKSB7XG4gICAgICAgIHJldHVybiBtb21lbnQodmFsdWUsIGlucHV0Rm9ybWF0KS5mb3JtYXQob3V0cHV0Rm9ybWF0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBtb21lbnQodmFsdWUpLmZvcm1hdChvdXRwdXRGb3JtYXQpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHByRGF0ZXRpbWUuJGluamVjdCA9IFtcIm1vbWVudFwiXTtcbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmlsdGVyKCdwckRhdGV0aW1lJywgcHJEYXRldGltZSk7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LXBhcmFtc1xuICBmdW5jdGlvbiBwckRhdGV0aW1lKG1vbWVudCkge1xuICAgIC8qKlxuICAgICAqIEZvcm1hdGEgdW1hIGRhdGEgY29tIGhvcsOhcmlvIG5vIHBhZHLDo28gYnJhc2lsZWlyb1xuICAgICAqL1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiBtb21lbnQodmFsdWUpLmZvcm1hdCgnREQvTU0vWVlZWSBISDptbScpO1xuICAgIH07XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHJlYWwuJGluamVjdCA9IFtcIiRmaWx0ZXJcIl07XG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmZpbHRlcigncmVhbCcsIHJlYWwpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gcmVhbCgkZmlsdGVyKSB7XG4gICAgLyoqXG4gICAgICogRm9ybWF0YSB1bSB2YWxvciBwYXJhIG8gcGFkcsOjbyBicmFzaWxlaXJvXG4gICAgICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuICRmaWx0ZXIoJ2N1cnJlbmN5JykodmFsdWUsICdSJCAnKTtcbiAgICB9O1xuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qIGVzbGludC1kaXNhYmxlIG1heC1sZW4gKi9cblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5jb25zdGFudCgnUHJJY29ucycsIFt7XG4gICAgaWQ6ICdwci1leGNlbCcsXG4gICAgdXJsOiAncHItZXhjZWwuc3ZnJyxcbiAgICBzdmc6ICc8c3ZnIGhlaWdodD1cIjI0XCIgd2lkdGg9XCIyNFwiIHN0eWxlPVwiZmlsbDojMkU3RDMyXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPjxwYXRoIGQ9XCJNNiwySDE0TDIwLDhWMjBBMiwyIDAgMCwxIDE4LDIySDZBMiwyIDAgMCwxIDQsMjBWNEEyLDIgMCAwLDEgNiwyTTEzLDMuNVY5SDE4LjVMMTMsMy41TTE3LDExSDEzVjEzSDE0TDEyLDE0LjY3TDEwLDEzSDExVjExSDdWMTNIOEwxMSwxNS41TDgsMThIN1YyMEgxMVYxOEgxMEwxMiwxNi4zM0wxNCwxOEgxM1YyMEgxN1YxOEgxNkwxMywxNS41TDE2LDEzSDE3VjExWlwiIC8+PC9zdmc+J1xuICB9XSk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmRpcmVjdGl2ZSgncHJQYWdpbmF0aW9uJywgcGFnaW5hdGlvbkRpcmVjdGl2ZSk7XG5cbiAgLyoqXG4gICAqIERpcmV0aXZhIHF1ZSBleGliZSB1bWEgcGFnaW5hw6fDo28uXG4gICAqIEFkb3RhIG8gZXN0aWxvIGRlIHBhZ2luYcOnw6NvIGRhIEJ1c2NhIGRvIEdvb2dsZS5cbiAgICogVXRpbGl6YSBvcyBlc3RpbG9zIGRvIGJvb3RzdHJhcFxuICAgKi9cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBwYWdpbmF0aW9uRGlyZWN0aXZlKCkge1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0FFJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHBhZ2luYXRvcjogJz0nXG4gICAgICB9LFxuICAgICAgdGVtcGxhdGU6ICdcXG4gICAgICAgIDxzZWN0aW9uIGNsYXNzPVwicHItcGFnaW5hdGlvblwiIGxheW91dD1cInJvd1wiPlxcbiAgICAgICAgICA8c2VjdGlvbiBsYXlvdXQ9XCJyb3dcIiBsYXlvdXQtYWxpZ249XCJjZW50ZXIgY2VudGVyXCIgbGF5b3V0LXdyYXBcXG4gICAgICAgICAgICBzdHlsZT1cIm1hcmdpbi1yaWdodDogMTBweFwiXFxuICAgICAgICAgICAgbmctc2hvdz1cInBhZ2luYXRvci5udW1iZXJPZlBhZ2VzID4gMVwiPlxcbiAgICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXFxuICAgICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwicGFnaW5hdG9yLmN1cnJlbnRQYWdlID09PSAxXCJcXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCJwYWdpbmF0b3IuZ29Ub1BhZ2UoMSlcIj57e3BhZ2luYXRvci5vcHRpb25zLmxhYmVscy5maXJzdH19PC9tZC1idXR0b24+XFxuICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcXG4gICAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCJwYWdpbmF0b3IuY3VycmVudFBhZ2UgPT09IDFcIlxcbiAgICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5wcmV2aW91c1BhZ2UoKVwiPnt7cGFnaW5hdG9yLm9wdGlvbnMubGFiZWxzLnByZXZpb3VzfX08L21kLWJ1dHRvbj5cXG4gICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxcbiAgICAgICAgICAgICAgICBuZy1yZXBlYXQ9XCJuIGluIHBhZ2luYXRvci5wYWdlcyhzKVwiXFxuICAgICAgICAgICAgICAgIG5nLWNsYXNzPVwie1xcJ21kLXByaW1hcnlcXCc6IG4gPT0gcGFnaW5hdG9yLmN1cnJlbnRQYWdlfVwiXFxuICAgICAgICAgICAgICAgIG5nLWNsaWNrPVwicGFnaW5hdG9yLmdvVG9QYWdlKG4pXCJcXG4gICAgICAgICAgICAgICAgbmctYmluZD1cIm5cIj4xPC9tZC1idXR0b24+XFxuICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXFxuICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cInBhZ2luYXRvci5jdXJyZW50UGFnZSA9PSBwYWdpbmF0b3IubnVtYmVyT2ZQYWdlc1wiXFxuICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5uZXh0UGFnZSgpXCI+e3twYWdpbmF0b3Iub3B0aW9ucy5sYWJlbHMubmV4dH19PC9tZC1idXR0b24+XFxuICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXFxuICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cInBhZ2luYXRvci5jdXJyZW50UGFnZSA9PSBwYWdpbmF0b3IubnVtYmVyT2ZQYWdlc1wiXFxuICAgICAgICAgICAgICBuZy1jbGljaz1cInBhZ2luYXRvci5nb1RvUGFnZShwYWdpbmF0b3IubnVtYmVyT2ZQYWdlcylcIj57e3BhZ2luYXRvci5vcHRpb25zLmxhYmVscy5sYXN0fX08L21kLWJ1dHRvbj5cXG4gICAgICAgICAgPC9zZWN0aW9uPlxcbiAgICAgICAgICA8c2VjdGlvbiBsYXlvdXQ9XCJyb3dcIiBsYXlvdXQtYWxpZ249XCJjZW50ZXIgY2VudGVyXCJcXG4gICAgICAgICAgICBuZy1zaG93PVwicGFnaW5hdG9yLnRvdGFsID4gMFwiPlxcbiAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIiBzdHlsZT1cImN1cnNvcjogZGVmYXVsdDtcIlxcbiAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCJ0cnVlXCIgbWQtY29sb3JzPVwiOjp7YmFja2dyb3VuZDpcXCdhY2NlbnRcXCd9XCI+VG90YWw6IHt7cGFnaW5hdG9yLnRvdGFsfX0gcmVnaXN0cm8ocyk8L21kLWJ1dHRvbj5cXG4gICAgICAgICAgPC9zZWN0aW9uPlxcbiAgICAgICAgPC9zZWN0aW9uPidcbiAgICB9O1xuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmZhY3RvcnkoJ1ByUGFnaW5hdGlvbicsIHBhZ2luYXRpb25TZXJ2aWNlKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIHBhZ2luYXRpb25TZXJ2aWNlKCkge1xuXG4gICAgLyoqXG4gICAgICogQ3JpYSBlIHJldG9ybmEgdW1hIGluc3RhbmNpYSBkbyBvYmpldG8gcGFnaW5hZG9yLlxuICAgICAqXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gc2VhcmNoTWV0aG9kIC0gZnVuw6fDo28gcmVzcG9uc8OhdmVsIHBvciBjYXJyZWdhciBvcyBkYWRvc1xuICAgICAgIGUgcXVlIHZhaSBzZXIgY2hhbWFkYSBxdWFuZG8gbyB1c3XDoXJpbyBjbGljYXIgZW0gdW1hIHDDoWdpbmFcbiAgICAgKiBAcGFyYW0ge2ludH0gcGVyUGFnZSAtIE7Dum1lcm8gZGUgaXRlbnMgcG9yIHDDoWdpbmEuIFBhZHLDo28gw6kgMTAuXG4gICAgICogQHBhcmFtIHtvYmplY3R9IF9vcHRpb25zIC0gT2JqZXRvIGNvbnRlbmRvIGFzIGRlbWFpcyBjb25maWd1cmHDp8O1ZXNcbiAgICAgKi9cbiAgICB2YXIgUHJQYWdpbmFjYW8gPSBmdW5jdGlvbiBQclBhZ2luYWNhbyhzZWFyY2hNZXRob2QsIHBlclBhZ2UsIF9vcHRpb25zKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgbWF4UGFnZXM6IDEwLFxuICAgICAgICBsYWJlbHM6IHtcbiAgICAgICAgICBmaXJzdDogJ8KrwqsnLFxuICAgICAgICAgIHByZXZpb3VzOiAnwqsnLFxuICAgICAgICAgIG5leHQ6ICfCuycsXG4gICAgICAgICAgbGFzdDogJ8K7wrsnXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8vc29icmVlc2NyZXZlIG9zIHBhcmFtZXRyb3MgcGFkcsO1ZXNcbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKHBlclBhZ2UpKSB7XG4gICAgICAgIHBlclBhZ2UgPSAxMDtcbiAgICAgIH1cblxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKF9vcHRpb25zKSkge1xuICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoX29wdGlvbnMubWF4UGFnZXMpKSB7XG4gICAgICAgICAgb3B0aW9ucy5tYXhQYWdlcyA9IF9vcHRpb25zLm1heFBhZ2VzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChfb3B0aW9ucy5sYWJlbHMpKSB7XG4gICAgICAgICAgb3B0aW9ucy5sYWJlbHMgPSBfb3B0aW9ucy5sYWJlbHM7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy9jYWxjdWxhIHF1YW50YXMgcMOhZ2luYXMgdsOjbyBzZXIgZXhpYmlkYXMgbmEgcGFydGUgaW50ZXJtZWRpYXJpYSBkYSBwYWdpbmHDp8Ojb1xuICAgICAgb3B0aW9ucy5tYXhQYWdlc0lubmVyID0gTWF0aC5mbG9vcihvcHRpb25zLm1heFBhZ2VzIC8gMik7XG5cbiAgICAgIC8vQ3JpYSBvIG9iamV0byBwYWdpbmFkb3IgY29tIG9zIHBhcmFtZXRyb3MgaW5pY2lhaXNcbiAgICAgIHRoaXMuc2VhcmNoTWV0aG9kID0gc2VhcmNoTWV0aG9kO1xuICAgICAgdGhpcy5udW1iZXJPZlBhZ2VzID0gMTtcbiAgICAgIHRoaXMudG90YWwgPSAwO1xuICAgICAgdGhpcy5wZXJQYWdlID0gcGVyUGFnZTtcbiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAwO1xuICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYSBvIG7Dum1lcm8gZGUgcMOhZ2luYXMgcXVlIHZhaSBzZXIgZXhpYmlkYSBiYXNlYWRvIG5vIHRvdGFsIGRlXG4gICAgICogaXRlbnMgY29tIGEgcGVyUGFnZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbnR9IHRvdGFsIC0gdG90YWwgZGUgaXRlbnNcbiAgICAgKi9cbiAgICBQclBhZ2luYWNhby5wcm90b3R5cGUuY2FsY051bWJlck9mUGFnZXMgPSBmdW5jdGlvbiAodG90YWwpIHtcbiAgICAgIHRoaXMudG90YWwgPSB0b3RhbDtcblxuICAgICAgaWYgKHRvdGFsIDw9IDApIHtcbiAgICAgICAgdGhpcy5udW1iZXJPZlBhZ2VzID0gMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubnVtYmVyT2ZQYWdlcyA9IE1hdGguZmxvb3IodG90YWwgLyB0aGlzLnBlclBhZ2UpICsgKHRvdGFsICUgdGhpcy5wZXJQYWdlID4gMCA/IDEgOiAwKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVmVyaWZpY2EgYXMgcMOhZ2luYXMgcXVlIGRldmVtIHNlciBleGliaWRhc1xuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5wYWdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciByZXQgPSBbXTtcblxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gdGhpcy5udW1iZXJPZlBhZ2VzOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPT09IGkpIHtcbiAgICAgICAgICByZXQucHVzaChpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA8PSB0aGlzLm9wdGlvbnMubWF4UGFnZXNJbm5lciArIDEpIHtcbiAgICAgICAgICAgIGlmIChpIDw9IHRoaXMub3B0aW9ucy5tYXhQYWdlcykge1xuICAgICAgICAgICAgICByZXQucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGkgPj0gdGhpcy5jdXJyZW50UGFnZSAtIHRoaXMub3B0aW9ucy5tYXhQYWdlc0lubmVyICYmIGkgPD0gdGhpcy5jdXJyZW50UGFnZSArIHRoaXMub3B0aW9ucy5tYXhQYWdlc0lubmVyKSB7XG4gICAgICAgICAgICAgIHJldC5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJldDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FycmVnYSBvcyBkYWRvcyBkYSBww6FnaW5hIGFudGVyaW9yXG4gICAgICovXG4gICAgUHJQYWdpbmFjYW8ucHJvdG90eXBlLnByZXZpb3VzUGFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlID4gMSkge1xuICAgICAgICB0aGlzLnNlYXJjaE1ldGhvZCh0aGlzLmN1cnJlbnRQYWdlIC0gMSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENhcnJlZ2Egb3MgZGFkb3MgZGEgcHLDs3hpbWEgcMOhZ2luYVxuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5uZXh0UGFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlIDwgdGhpcy5udW1iZXJPZlBhZ2VzKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoTWV0aG9kKHRoaXMuY3VycmVudFBhZ2UgKyAxKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FycmVnYSBvcyBkYWRvcyBkYSBww6FnaW5hIGluZm9ybWFkYVxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbnR9IHBhZ2UgLSBwYWdpbmEgcXVlIGRldmUgc2VyIGNhcnJlZ2FkYVxuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5nb1RvUGFnZSA9IGZ1bmN0aW9uIChwYWdlKSB7XG4gICAgICBpZiAocGFnZSA+PSAxICYmIHBhZ2UgPD0gdGhpcy5udW1iZXJPZlBhZ2VzKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoTWV0aG9kKHBhZ2UpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgZ2V0SW5zdGFuY2U6IGZ1bmN0aW9uIGdldEluc3RhbmNlKHNlYXJjaE1ldGhvZCwgcGVyUGFnZSwgX29wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQclBhZ2luYWNhbyhzZWFyY2hNZXRob2QsIHBlclBhZ2UsIF9vcHRpb25zKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4vKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qKlxuICAgKiBEaXJldGl2YSBxdWUgZXhpYmUgdW0gc3Bpbm5lciBzZW1wcmUgcXVlIHVtIGJyb2FkY2FzdCwgbWFudWFsbWVudGUsIMOpIGRpc3BhcmFkb1xuICAgKi9cbiAgLyoqIEBuZ0luamVjdCAqL1xuXG4gIGFuZ3VsYXIubW9kdWxlKCduZ1Byb2RlYicpLmNvbXBvbmVudCgncHJTcGlubmVyJywge1xuICAgIHRlbXBsYXRlOiAnXFxuICAgICAgICA8bWQtcHJvZ3Jlc3MtbGluZWFyIGNsYXNzPVwic3Bpbi1sYWJlbC1jb21wb25lbnQge3s6OiRjdHJsLmNvbG9yfX1cIlxcbiAgICAgICAgICBuZy1zdHlsZT1cIiRjdHJsLnN0eWxlXCJcXG4gICAgICAgICAgbWQtbW9kZT1cImluZGV0ZXJtaW5hdGVcIlxcbiAgICAgICAgICBuZy1zaG93PVwiJGN0cmwuc3Bpbm5lciAmJiAkY3RybC5zcGlubmVyLnNob3dcIj48L21kLXByb2dyZXNzLWxpbmVhcj5cXG4gICAgICAgICcsXG4gICAgYmluZGluZ3M6IHtcbiAgICAgIHBvc2l0aW9uOiAnQCcsXG4gICAgICBjb2xvcjogJ0AnXG4gICAgfSxcbiAgICBjb250cm9sbGVyOiBbJyRzY29wZScsIGZ1bmN0aW9uICgkc2NvcGUpIHtcbiAgICAgIHZhciBjdHJsID0gdGhpcztcblxuICAgICAgY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL0RlZmluZSBhIHBvc2nDp8Ojb1xuICAgICAgICBjdHJsLnN0eWxlID0geyBwb3NpdGlvbjogYW5ndWxhci5pc0RlZmluZWQoY3RybC5wb3NpdGlvbikgPyBjdHJsLnBvc2l0aW9uIDogJ2ZpeGVkJyB9O1xuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChjdHJsLmNvbG9yKSkgY3RybC5jb2xvciA9ICdtZC1wcmltYXJ5JztcbiAgICAgIH07XG4gICAgICAvL2NvbXBvcnRhbWVudG8gcGFkcsOjb1xuICAgICAgY3RybC5zcGlubmVyID0ge1xuICAgICAgICBzaG93OiBmYWxzZVxuICAgICAgfTtcblxuICAgICAgLy9Fc2N1dGEgbyBjYW5hbCBlbWl0aWRvIHZpYSBicm9hZGNhc3RcbiAgICAgIC8vcGFyYSBleGliaXIvZXNjb25kZXIgbyBjb21wb25lbnRlXG4gICAgICAkc2NvcGUuJG9uKCdzaG93LXNwaW5uZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGN0cmwuc3Bpbm5lciA9IHtcbiAgICAgICAgICBzaG93OiB0cnVlXG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgJHNjb3BlLiRvbignaGlkZS1zcGlubmVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBjdHJsLnNwaW5uZXIgPSB7XG4gICAgICAgICAgc2hvdzogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH1dXG4gIH0pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHNwaW5uZXJTZXJ2aWNlLiRpbmplY3QgPSBbXCIkcm9vdFNjb3BlXCJdO1xuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5mYWN0b3J5KCdQclNwaW5uZXInLCBzcGlubmVyU2VydmljZSk7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBzcGlubmVyU2VydmljZSgkcm9vdFNjb3BlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNob3c6IHNob3csXG4gICAgICBoaWRlOiBoaWRlXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEV4aWJlIG8gc3Bpbm5lclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNob3coKSB7XG4gICAgICAvL2VtaXRlIG8gc2luYWwgcGFyYSBhIGRpcmV0aXZhIGluZm9ybWFuZG8gcXVlIG8gY29tcG9uZW50ZSBzcGlubmVyIGRldmUgc2VyIGV4aWJpZG9cbiAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnc2hvdy1zcGlubmVyJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXNjb25kZSBvIHNwaW5uZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBoaWRlKCkge1xuICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdoaWRlLXNwaW5uZXInKTtcbiAgICB9XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgVG9hc3QuJGluamVjdCA9IFtcIiRtZFRvYXN0XCIsIFwibG9kYXNoXCIsIFwiJGxvZ1wiXTtcbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZmFjdG9yeSgnUHJUb2FzdCcsIFRvYXN0KTtcblxuICAvKipcbiAgICogU2VydmnDp28gcXVlIGVuY2Fwc3VsYSBlIGFtcGxpYSBvcyBzZXJ2acOnb3MgZG8gYW5ndWxhciB0b2FzdHJcbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gVG9hc3QoJG1kVG9hc3QsIGxvZGFzaCwgJGxvZykge1xuICAgIHZhciBvYmogPSB7XG4gICAgICBzdWNjZXNzOiBzdWNjZXNzLFxuICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgZXJyb3JWYWxpZGF0aW9uOiBlcnJvclZhbGlkYXRpb24sXG4gICAgICBpbmZvOiBpbmZvLFxuICAgICAgd2Fybjogd2FybixcbiAgICAgIGhpZGU6IGhpZGVcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRXhpYmUgdW1hIG5vdGlmaWNhw6fDo29cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtc2cgLSBNZW5zYWdlbSBkYSBub3RpZmljYcOnw6NvXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbG9yIC0gQ29yIGRlIGZ1bmRvIGRhIG5vdGlmaWNhw6fDo29cbiAgICAgKlxuICAgICAgQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHRvYXN0KG1zZywgY29sb3IsIG9wdGlvbnMpIHtcbiAgICAgIGlmIChtc2cpIHtcbiAgICAgICAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgICAgICAgIHRlbXBsYXRlOiAnXFxuICAgICAgICAgICAgPG1kLXRvYXN0PlxcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXRvYXN0LWNvbnRlbnRcIiBtZC1jb2xvcnM9XCI6OntiYWNrZ3JvdW5kOlxcJycgKyBjb2xvciArICdcXCd9XCI+XFxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibWQtdG9hc3QtdGV4dFwiIGZsZXg+JyArIG1zZyArICc8L3NwYW4+XFxuICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L21kLXRvYXN0PlxcbiAgICAgICAgICAnLFxuICAgICAgICAgIHBvc2l0aW9uOiAndG9wIHJpZ2h0J1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChhbmd1bGFyLmlzT2JqZWN0KG9wdGlvbnMpKSBkZWZhdWx0T3B0aW9ucyA9IGFuZ3VsYXIubWVyZ2UoZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuXG4gICAgICAgIHJldHVybiAkbWRUb2FzdC5zaG93KGRlZmF1bHRPcHRpb25zKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRsb2cuZGVidWcoJ01lbnNhZ2VtIHBhcmEgc2VyIGV4aWJpZGEgbm8gVG9hc3QgbsOjbyBmb2kgaW5mb3JtYWRhJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXNjb25kZSB1bWEgbm90aWZpY2HDp8Ojb1xuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IG9iamVjdCAtIFVtIGFyZ3VtZW50byBvcGNpb25hbCBwYXJhIGEgcHJvbWlzZSBhIHNlciByZXNvbHZpZGFcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtwcm9taXNzZX0gLSBSZXRvcm5hIHVtYSBwcm9taXNzZSBxdWUgw6kgZXhlY3V0YWRhIHF1YW5kbyBhIG5vdGlmaWNhw6fDo28gw6kgcmVtb3ZpZGEgZG8gRE9NXG4gICAgICovXG4gICAgZnVuY3Rpb24gaGlkZShvYmplY3QpIHtcbiAgICAgIHJldHVybiAkbWRUb2FzdC5oaWRlKG9iamVjdCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3VjY2Vzcyhtc2csIG9wdGlvbnMpIHtcbiAgICAgIHJldHVybiB0b2FzdChtc2csICdncmVlbicsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVycm9yKGVycm9ycywgb3B0aW9ucykge1xuICAgICAgLy9zZSBmb3IgdW0gb2JqZXRvIGNvbnRlbmRvIG9zIGVycm9zLCBpdGVyYSBzb2JyZSBvcyBhdHJpYnV0b3MgZG8gbWVzbW9cbiAgICAgIC8vcGFyYSBleGliaXIgYShzKSBtZW5zYWdlbShucykgZGUgZXJybyBhdHJpYnVpZGFzXG4gICAgICBpZiAoYW5ndWxhci5pc09iamVjdChlcnJvcnMpKSB7XG4gICAgICAgIHZhciBlcnJvclN0ciA9ICcnO1xuXG4gICAgICAgIC8vIGV4aWJlIGFzIG1lbnNhZ2VtIGRlIGVycm8gY29udGlkYXMgbm8gb2JqZXRvXG4gICAgICAgIC8vICB7XG4gICAgICAgIC8vICAgIFwibmFtZVwiOiBbXCJvIGNhbXBvIG5vbWUgw6kgb2JyaWdhdMOzcmlvXCJdLFxuICAgICAgICAvLyAgICBcInBhc3N3b3JkXCI6IFtcbiAgICAgICAgLy8gICAgICBcIkEgY29uZmlybWHDp8OjbyBkZSBzZW5oYSBuw6NvIGNvbmZlcmUuXCIsXG4gICAgICAgIC8vICAgICAgXCJzZW5oYSBkZXZlIHRlciBubyBtw61uaW1vIDYgY2FyYWN0ZXJlcy5cIlxuICAgICAgICAvLyAgICBdXG4gICAgICAgIC8vICB9XG4gICAgICAgIGxvZGFzaC5mb3JJbihlcnJvcnMsIGZ1bmN0aW9uIChrZXlFcnJvcnMpIHtcbiAgICAgICAgICBlcnJvclN0ciArPSBidWlsZEFycmF5TWVzc2FnZShrZXlFcnJvcnMpO1xuICAgICAgICB9KTtcblxuICAgICAgICBlcnJvcnMgPSBlcnJvclN0cjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZXJyb3JzKSkge1xuICAgICAgICAgIGVycm9ycyA9IGJ1aWxkQXJyYXlNZXNzYWdlKGVycm9ycyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRvYXN0KGVycm9ycywgJ3JlZC1BNzAwJywgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYnVpbGRBcnJheU1lc3NhZ2UoYXJyTXNnKSB7XG4gICAgICB2YXIgbXNnID0gJyc7XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoYXJyTXNnKSkge1xuICAgICAgICAvL2l0ZXJhIHNvYnJlIG9zIGVycm9zIGRlIHVtIGF0cmlidXRvXG4gICAgICAgIGFyck1zZy5mb3JFYWNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIG1zZyArPSBlcnJvciArICc8YnIvPic7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbXNnICs9IGFyck1zZyArICc8YnIvPic7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBtc2c7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhpYmUgdW0gdG9hc3QgY29tIGFzIG1lbnNhZ2VucyBkZSBlcnJvIHJlZmVyZW50ZSBhIHZhbGlkYcOnw6NvLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3QgfCBhcnJheX0gZXJyb3JzIC0gT2JqZXRvIG91IEFycmF5IGNvbnRlbmRvIGFzIG1lbnNhZ2VucyBkZSBlcnJvLiBEZXZlIGVzdGFyXG4gICAgICogbm8gc2VndWludGUgZm9ybWF0by5cbiAgICAgKiAgIHtcbiAgICAgKiAgICBcIm5vbWUtZG8tYXRyaWJ1dG8xXCI6IFtcIm1lbnNhZ2VtIGRlIGVycm8gMVwiLCBcIm1lbnNhZ2VtIGRlIGVycm8gMlwiXSxcbiAgICAgKiAgICBcIm5vbWUtZG8tYXRyaWJ1dG8yXCI6IFtcIm1lbnNhZ2VtIGRlIGVycm8gMVwiXVxuICAgICAqICAgfVxuICAgICAqIG91XG4gICAgICogICBbXG4gICAgICogICAgJ01lbnNhZ2VtIDEnLFxuICAgICAqICAgICdNZW5zYWdlbSAyJ1xuICAgICAqICAgXVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtc2cgLSBPcGNpb25hbC4gTWVuc2FnZW0gZGUgZXJyby5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBlcnJvclZhbGlkYXRpb24oZXJyb3JzLCBtc2csIG9wdGlvbnMpIHtcbiAgICAgIG9iai5lcnJvcihhbmd1bGFyLmlzQXJyYXkoZXJyb3JzKSB8fCBhbmd1bGFyLmlzT2JqZWN0KGVycm9ycykgPyBlcnJvcnMgOiBtc2csIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluZm8obXNnLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gdG9hc3QobXNnLCAndGVhbCcsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdhcm4obXNnLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gdG9hc3QobXNnLCAnd2FybicsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIHJldHVybiBvYmo7XG4gIH1cbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJykuZGlyZWN0aXZlKCdwclVwbG9hZGVyQmFzZTY0JywgW1wiJHFcIiwgZnVuY3Rpb24gKCRxKSB7XG4gICAgdmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxuICAgICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcbiAgICAgICAgaWYgKCFuZ01vZGVsKSByZXR1cm47XG5cbiAgICAgICAgbmdNb2RlbC4kcmVuZGVyID0gZnVuY3Rpb24gKCkge307XG5cbiAgICAgICAgZWxlbWVudC5iaW5kKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQ7XG5cbiAgICAgICAgICAkcS5hbGwoc2xpY2UuY2FsbChlbGVtZW50LmZpbGVzLCAwKS5tYXAocmVhZEZpbGUpKS50aGVuKGZ1bmN0aW9uICh2YWx1ZXMpIHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50Lm11bHRpcGxlKSBuZ01vZGVsLiRzZXRWaWV3VmFsdWUodmFsdWVzKTtlbHNlIG5nTW9kZWwuJHNldFZpZXdWYWx1ZSh2YWx1ZXMubGVuZ3RoID8gdmFsdWVzWzBdIDogbnVsbCk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBmdW5jdGlvbiByZWFkRmlsZShmaWxlKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZS50YXJnZXQucmVzdWx0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICB9XSk7XG59KSgpOyIsIi8qZXNsaW50IGFuZ3VsYXIvZmlsZS1uYW1lOiAwLCBuby11bmRlZjogMCovXG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vZW5jYXBzdWxhIGFzIGJpYmxpb3RlY2FzIGV4dGVybmFzIHBhcmEgc2VyZW0gY2FycmVnYWRhcyBjb21vIHVtYSBkZXBlbmTDqm5jaWFcbiAgLy9kbyBhbmd1bGFyLlxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5jb25zdGFudCgnbG9kYXNoJywgXylcbiAgICAuY29uc3RhbnQoJ2FsYXNxbCcsIGFsYXNxbClcbiAgICAuY29uc3RhbnQoJ21vbWVudCcsIG1vbWVudCk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCduZ1Byb2RlYicpXG4gICAgLnJ1bihydW4pO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gcnVuKCR0ZW1wbGF0ZUNhY2hlLCBQckljb25zKSB7XG4gICAgYW5ndWxhci5mb3JFYWNoKFBySWNvbnMsIGZ1bmN0aW9uKGljb24pIHtcbiAgICAgICR0ZW1wbGF0ZUNhY2hlLnB1dChpY29uLnVybCwgaWNvbi5zdmcpO1xuICAgIH0pO1xuICB9XG59KCkpO1xuXG5cbiIsIi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICogRGlyZXRpdmEgcXVlIGV4aWJlIHVtIHNwaW5uZXIgc2VtcHJlIHF1ZSB1bSBicm9hZGNhc3QsIG1hbnVhbG1lbnRlLCDDqSBkaXNwYXJhZG9cbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ25nUHJvZGViJylcbiAgICAuZGlyZWN0aXZlKCdwckRhdGVUaW1lUGlja2VyJywgZnVuY3Rpb24obW9tZW50KSB7XG5cbiAgICAgIGZ1bmN0aW9uIGJ1aWxkRGF0ZVBpY2tlcihhdHRyKSB7XG4gICAgICAgIHZhciBhdXRvT2sgPSAoYW5ndWxhci5pc1VuZGVmaW5lZChhdHRyLmF1dG9PaykgfHwgYXR0ci5hdXRvT2sgPT09ICd0cnVlJyk7XG4gICAgICAgIHZhciB3aXRoVGltZSA9IChhbmd1bGFyLmlzRGVmaW5lZChhdHRyLndpdGhUaW1lKSAmJiBhdHRyLndpdGhUaW1lID09PSAndHJ1ZScpO1xuICAgICAgICB2YXIgd2l0aE1pbnV0ZXNQaWNrZXIgPSAoYW5ndWxhci5pc1VuZGVmaW5lZChhdHRyLndpdGhNaW51dGVzUGlja2VyKSB8fCBhdHRyLndpdGhNaW51dGVzUGlja2VyID09PSAndHJ1ZScpO1xuICAgICAgICB2YXIgZm9ybWF0ID0gYXR0ci5mb3JtYXQgfHwgKCh3aXRoVGltZSkgPyAnREQvTU0vWVlZWSBISDptbScgOiAnREQvTU0vWVlZWScpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25zdHJvaSBvIHRlbXBsYXRlIGRvIGNvbXBvbmVudGUgZGUgZXNjb2xoYSBkZSBkYXRhXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gYFxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIGlkPVwiJHthdHRyLmlkfVwiXG4gICAgICAgICAgICAgIG1kYy1kYXRldGltZS1waWNrZXJcbiAgICAgICAgICAgICAgbmctbW9kZWw9XCJuZ01vZGVsXCJcbiAgICAgICAgICAgICAgc2hvdy10b2RheXMtZGF0ZVxuICAgICAgICAgICAgICBkYXRlPVwidHJ1ZVwiXG4gICAgICAgICAgICAgIHRpbWU9XCIke3dpdGhUaW1lfVwiXG4gICAgICAgICAgICAgIG1pbnV0ZXM9XCIke3dpdGhNaW51dGVzUGlja2VyfVwiXG4gICAgICAgICAgICAgIGNhbmNlbC10ZXh0PVwiQ2FuY2VsYXJcIlxuICAgICAgICAgICAgICB0b2RheS10ZXh0PVwiSG9qZVwiXG4gICAgICAgICAgICAgIGF1dG8tb2s9XCIke2F1dG9Pa31cIlxuICAgICAgICAgICAgICBmb3JtYXQ9XCIke2Zvcm1hdH1cIlxuICAgICAgICAgICAgICBtaW4tZGF0ZT1cIiR7IGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubWluRGF0ZSkgPyBtb21lbnQoYXR0ci5taW5EYXRlKS5mb3JtYXQoZm9ybWF0KSA6ICcnIH1cIlxuICAgICAgICAgICAgICBtYXgtZGF0ZT1cIickeyBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm1heERhdGUpID8gbW9tZW50KGF0dHIubWF4RGF0ZSkuZm9ybWF0KGZvcm1hdCkgOiAnJyB9J1wiPlxuICAgICAgICAgICAgPC9pbnB1dD5cbiAgICAgICAgYFxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0ZW1wbGF0ZTogZnVuY3Rpb24oZWxlbWVudCwgYXR0cikge1xuICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9IGJ1aWxkRGF0ZVBpY2tlcihhdHRyKTtcblxuICAgICAgICAgIHJldHVybiB0ZW1wbGF0ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICBuZ01vZGVsOiAnPScsXG4gICAgICAgICAgbGF5b3V0OiAnPScsXG4gICAgICAgICAgaWQ6ICc9JyxcbiAgICAgICAgICB3aXRoVGltZTogJz0/JyxcbiAgICAgICAgICB3aXRoTWludXRlc1BpY2tlcjogJz0/JyxcbiAgICAgICAgICBhdXRvT2s6ICc9PycsXG4gICAgICAgICAgZm9ybWF0OiAnPT8nLFxuICAgICAgICAgIG1pbkRhdGU6ICc9PycsXG4gICAgICAgICAgbWF4RGF0ZTogJz0/J1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG59KSgpO1xuIiwiLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5mYWN0b3J5KCdQckRpYWxvZycsIGRpYWxvZ1NlcnZpY2UpO1xuXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1wYXJhbXNcbiAgZnVuY3Rpb24gZGlhbG9nU2VydmljZSgkbG9nLCAkbWREaWFsb2csICRtZFV0aWwsICRyb290U2NvcGUsICRhbmltYXRlLCAkZG9jdW1lbnQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY3VzdG9tOiBjdXN0b20sXG4gICAgICBjb25maXJtOiBjb25maXJtLFxuICAgICAgY2xvc2U6IGNsb3NlXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE3DqXRvZG8gcXVlIGNvbmZpZ3VyYSBlIHJlYWxpemEgbyBtZXJnZSBkbyBvYmpldG8gcmVjZWJpZG8gdmlhIHBhcsOibWV0cm9cbiAgICAgKiBjb20gYSBjb25maWd1cmHDp8OjbyBwYWRyw6NvIHBhcmEgYSBleGliacOnw6NvIGRvIGRpYWxvZ1xuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWcgLSBPYmpldG8gY29udGVuZG8gYXMgY29uZmlndXJhw6fDtWVzXG4gICAgICogQHJldHVybnMge2RpYWxvZ1NlcnZpY2V9IC0gUmV0b3JuYSBvIHNlcnZpY2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBidWlsZChjb25maWcpIHtcblxuICAgICAgaWYgKCFhbmd1bGFyLmlzT2JqZWN0KGNvbmZpZykpIHtcbiAgICAgICAgJGxvZy5lcnJvcignUHJEaWFsb2c6IFBhcsOibWV0cm8gaW52w6FsaWRvLCDDqSBlc3BlcmFuZG8gdW0gb2JqZXRvIGNvbW8gcGFyw6JtZXRyby4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgICAgIGhhc0JhY2tkcm9wOiBmYWxzZSxcbiAgICAgICAgZXNjYXBlVG9DbG9zZTogZmFsc2UsXG4gICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgIGF1dG9XcmFwOiB0cnVlLFxuICAgICAgICBza2lwSGlkZTogdHJ1ZSxcbiAgICAgICAgbG9jYWxzOiB7fSxcbiAgICAgICAgekluZGV4OiA3NSxcbiAgICAgICAgZnVsbHNjcmVlbjogZmFsc2VcbiAgICAgIH07XG5cbiAgICAgIC8vbsOjbyBmYXplbW9zIG1lcmdlIGRhIHByb3ByaWVkYWRlIGxvY2FscyBwYXJhIG7Do28gZXN0b3VyYXIgbyBsaW1pdGUgZGUgcmVjdXJzaXZpZGFkZVxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGNvbmZpZy5sb2NhbHMpKSB7XG4gICAgICAgIGRlZmF1bHRPcHRpb25zLmxvY2FscyA9IGNvbmZpZy5sb2NhbHM7XG4gICAgICAgIGRlbGV0ZSBjb25maWcubG9jYWxzO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYW5ndWxhci5tZXJnZShkZWZhdWx0T3B0aW9ucywgY29uZmlnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBleGliZSBvIGRpYWxvZyBkZSBjb25maXJtYcOnw6NvIG5hIHRlbGEgZGVwb2lzIHF1ZSBvIGJ1aWxkIGUgaW52b2NhZG9cbiAgICAgKiBkZSB1bWEgZGV0ZXJtaW5hZGEgYcOnw6NvXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSBwb2RlIG91IG7Do28gc2VyIHJlc29sdmlkYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpcm0oY29uZmlnKSB7XG5cbiAgICAgIHZhciBvcHRpb25zID0gYnVpbGQoY29uZmlnKTtcblxuICAgICAgb3B0aW9ucy50ZW1wbGF0ZSA9XG4gICAgICAgICAgYCA8bWQtZGlhbG9nIGZsZXg9NTAgYXJpYS1sYWJlbD1cInt7OjpjdHJsLnRpdGxlfX1cIj5cbiAgICAgICAgICAgICAgPG1kLXRvb2xiYXIgbWQtc2Nyb2xsLXNocmluaz5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdG9vbGJhci10b29sc1wiPlxuICAgICAgICAgICAgICAgICAgPGgzPlxuICAgICAgICAgICAgICAgICAgICA8c3Bhbj57ezo6Y3RybC50aXRsZX19PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9tZC10b29sYmFyPlxuICAgICAgICAgICAgICA8bWQtZGlhbG9nLWNvbnRlbnQgbGF5b3V0LW1hcmdpbj5cbiAgICAgICAgICAgICAgICA8cD57ezo6Y3RybC5kZXNjcmlwdGlvbn19PC9wPlxuICAgICAgICAgICAgICA8L21kLWRpYWxvZy1jb250ZW50PlxuICAgICAgICAgICAgICA8bWQtZGlhbG9nLWFjdGlvbnM+XG4gICAgICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXG4gICAgICAgICAgICAgICAgICBtZC1jb2xvcnM9XCI6OntiYWNrZ3JvdW5kOidkZWZhdWx0LXt7Y3RybC55ZXNCZ0NvbG9yfX0nfVwiXG4gICAgICAgICAgICAgICAgICBuZy1jbGljaz1cImN0cmwueWVzQWN0aW9uKClcIj5TaW08L21kLWJ1dHRvbj5cbiAgICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcbiAgICAgICAgICAgICAgICAgIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6J2RlZmF1bHQte3tjdHJsLm5vQmdDb2xvcn19J31cIlxuICAgICAgICAgICAgICAgICAgbmctY2xpY2s9XCJjdHJsLm5vQWN0aW9uKClcIj5Ow6NvPC9tZC1idXR0b24+XG4gICAgICAgICAgICAgIDwvbWQtZGlhbG9nLWFjdGlvbnM+XG4gICAgICAgICAgICA8L21kLWRpYWxvZz5cbiAgICAgICAgICBgO1xuICAgICAgb3B0aW9ucy5sb2NhbHMgPSB7XG4gICAgICAgIHRpdGxlOiAoYW5ndWxhci5pc0RlZmluZWQob3B0aW9ucy50aXRsZSkgPyBvcHRpb25zLnRpdGxlIDogJycpLFxuICAgICAgICBkZXNjcmlwdGlvbjogKGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMuZGVzY3JpcHRpb24pID8gb3B0aW9ucy5kZXNjcmlwdGlvbiA6ICcnKSxcbiAgICAgICAgeWVzQmdDb2xvcjogKGFuZ3VsYXIuaXNEZWZpbmVkKG9wdGlvbnMueWVzQmdDb2xvcikgPyBvcHRpb25zLnllc0JnQ29sb3IgOiAncHJpbWFyeScpLFxuICAgICAgICBub0JnQ29sb3I6IChhbmd1bGFyLmlzRGVmaW5lZChvcHRpb25zLm5vQmdDb2xvcikgPyBvcHRpb25zLm5vQmdDb2xvciA6ICdhY2NlbnQnKVxuICAgICAgfTtcblxuICAgICAgb3B0aW9ucy5jb250cm9sbGVyID0gWyckbWREaWFsb2cnLCBmdW5jdGlvbigkbWREaWFsb2cpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5ub0FjdGlvbiA9IG5vQWN0aW9uO1xuICAgICAgICB2bS55ZXNBY3Rpb24gPSB5ZXNBY3Rpb247XG5cbiAgICAgICAgZnVuY3Rpb24gbm9BY3Rpb24oKSB7XG4gICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHllc0FjdGlvbigpIHtcbiAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgICAgICB9XG4gICAgICB9XTtcblxuICAgICAgb3B0aW9ucy5jb250cm9sbGVyQXMgPSAnY3RybCc7XG4gICAgICBvcHRpb25zLmNsaWNrT3V0c2lkZVRvQ2xvc2UgPSBmYWxzZTtcbiAgICAgIG9wdGlvbnMuaGFzQmFja2Ryb3AgPSB0cnVlO1xuXG4gICAgICByZXR1cm4gJG1kRGlhbG9nLnNob3cob3B0aW9ucyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTcOpdG9kbyBxdWUgZXhpYmUgbyBkaWFsb2cgY3VzdG9taXphZG8gbmEgdGVsYSBkZXBvaXMgcXVlIG8gYnVpbGQgZSBpbnZvY2Fkb1xuICAgICAqIEByZXR1cm5zIHtwcm9taXNzZX0gLSBSZXRvcm5hIHVtYSBwcm9taXNzZSBxdWUgcG9kZSBvdSBuw6NvIHNlciByZXNvbHZpZGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjdXN0b20oY29uZmlnKSB7XG5cbiAgICAgIHZhciBvcHRpb25zID0gYnVpbGQoY29uZmlnKTtcblxuICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQob3B0aW9ucy50ZW1wbGF0ZVVybCkgJiYgYW5ndWxhci5pc1VuZGVmaW5lZChvcHRpb25zLnRlbXBsYXRlKSkge1xuICAgICAgICAkbG9nLmVycm9yKFxuICAgICAgICAgICdQckRpYWxvZzogdGVtcGxhdGVVcmwgb3UgdGVtcGxhdGUgaW5kZWZpbmlkbywgw6kgZXNwZXJhbmRvIHVtIHRlbXBsYXRlVXJsIG91IHVtIHRlbXBsYXRlIGNvbW8gYXRyaWJ1dG8uJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy9DcmlhZG8gbyBiYWNrZHJvcCBtYW51YWxtZW50ZSBwYXJhIGRpbWludWlyIG8gei1pbmRleCBhdHJhdsOpcyBkZSB1bWEgY2xhc3NlIGNzc1xuICAgICAgLy9vIHotaW5kZXggdGVtIHF1ZSBmaWNhciBtZW5vciBkZXZpZG8gYW8gZGlhbG9nLmNvbmZpcm0gdXNhciBvIHotaW5kZXggb3JpZ2luYWwgZGUgODBcbiAgICAgIG9wdGlvbnMgPSBhZGRCYWNrZHJvcChvcHRpb25zKTtcblxuICAgICAgb3B0aW9ucy5oYXNCYWNrZHJvcCA9IGZhbHNlO1xuXG4gICAgICByZXR1cm4gJG1kRGlhbG9nLnNob3cob3B0aW9ucyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTcOpdG9kbyBxdWUgY3JpYSBvIGJhY2tkcm9wIGUgbW9zdHJhIG5hIHRlbGEgY29tIG8gei1pbmRleCBjb25maWd1cmF2w6lsXG4gICAgICogcGFyYSBzb2JyZXBvciBvcyBlbGVtZW50b3MgZGEgdGVsYVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZEJhY2tkcm9wKG9wdGlvbnMpIHtcbiAgICAgIGlmIChvcHRpb25zLmhhc0JhY2tkcm9wKSB7XG4gICAgICAgIHZhciBiYWNrZHJvcCA9ICRtZFV0aWwuY3JlYXRlQmFja2Ryb3AoJHJvb3RTY29wZSwgJ21kLWRpYWxvZy1iYWNrZHJvcCBtZC1vcGFxdWUgbWQtYmFja2Ryb3AtY3VzdG9tJyk7XG5cbiAgICAgICAgJGFuaW1hdGUuZW50ZXIoYmFja2Ryb3AsIGFuZ3VsYXIuZWxlbWVudCgkZG9jdW1lbnQuZmluZCgnYm9keScpKSk7XG5cbiAgICAgICAgdmFyIG9yaWdpbmFsT25SZW1vdmluZyA9IG9wdGlvbnMub25SZW1vdmluZztcblxuICAgICAgICAvL03DqXRvZG8gZXhlY3V0YWRvIHF1YW5kbyBhIGFuaW1hw6fDo28gZGUgZmVjaGFtZW50byBkbyBkaWFsb2cgdGVybWluYVxuICAgICAgICBvcHRpb25zLm9uUmVtb3ZpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgYmFja2Ryb3AucmVtb3ZlKCk7XG4gICAgICAgICAgaWYgKGFuZ3VsYXIuaXNGdW5jdGlvbihvcmlnaW5hbE9uUmVtb3ZpbmcpKSBvcmlnaW5hbE9uUmVtb3ZpbmcuY2FsbCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG9yaWdpbmFsT25Db21wbGV0ZSA9IG9wdGlvbnMub25Db21wbGV0ZTtcblxuICAgICAgICAvL03DqXRvZG8gZXhlY3V0YWRvIHF1YW5kbyBhIGFuaW1hw6fDo28gZGUgYWJlcnR1cmEgZG8gZGlhbG9nIHRlcm1pbmFcbiAgICAgICAgb3B0aW9ucy5vbkNvbXBsZXRlID0gZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgICAgdmFyIHpJbmRleCA9IHBhcnNlSW50KG9wdGlvbnMuekluZGV4LCAxMCk7XG5cbiAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJGRvY3VtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1iYWNrZHJvcC1jdXN0b20nKSkuY3NzKCd6LWluZGV4JywgekluZGV4KTtcbiAgICAgICAgICBlbGVtZW50LmNzcygnei1pbmRleCcsIHpJbmRleCArIDEpO1xuICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24ob3JpZ2luYWxPbkNvbXBsZXRlKSkgb3JpZ2luYWxPbkNvbXBsZXRlLmNhbGwoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gb3B0aW9ucztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNw6l0b2RvIHF1ZSBzZXJ2ZSBwYXJhIGZlY2hhciBvIGRpYWxvZ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICB9XG5cbiAgfVxuXG59KSgpO1xuIiwiLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCduZ1Byb2RlYicpXG4gICAgLmZhY3RvcnkoJ1ByRmlsZScsIFByRmlsZSk7XG5cbiAgLyoqXG4gICAqIFNlcnZpY2UgcXVlIGVuY2Fwc3VsYSBvcyBzZXJ2acOnb3NcbiAgICogZGUgZXhwb3J0YcOnw6NvIGUgaW1wb3J0YcOnw6NvIGRlIGFycXVpdm9zXG4gICAqL1xuICAvKiogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIFByRmlsZShhbGFzcWwsIGxvZGFzaCwgJGZpbHRlcikge1xuICAgIHZhciBvYmogPSB7XG4gICAgICBleHBvcnRUb0V4Y2VsOiBleHBvcnRUb0V4Y2VsLFxuICAgICAgZXhwb3J0VG9DU1Y6IGV4cG9ydFRvQ1NWXG4gICAgfTtcblxuICAgIC8vRGVmaW5lZCBmaWx0ZXJzXG5cbiAgICBhbGFzcWwuZm4uZm9ybWF0RGF0ZSA9IGZ1bmN0aW9uKGRhdGUsIGZvcm1hdCkge1xuICAgICAgcmV0dXJuICRmaWx0ZXIoJ3ByRGF0ZScpKGRhdGUsIGZvcm1hdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0YSBvcyBkYWRvcyBlbnZpYWRvcyBwYXJhIG8gZm9ybWF0byBpbmZvcm1hZG8uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xhcnJheX0gZmllbGRzXG4gICAgICogIFN0cmluZyBjb250ZW5kbyBvcyBjYW1wb3Mgc2VwYXJhZG8gcG9yIHZpcmd1bGFcbiAgICAgKiAgICBleDogbmFtZSwgZGVzY3JpcHRpb25cbiAgICAgKiAgICBleDogbmFtZSBhcyBOb21lLCBkZXNjcmlwdGlvbiBhcyAnRGVzY3Jpw6fDo28nXG4gICAgICogICAgZXg6ICogIChwYXJhIHRvZG9zIG9zIGNhbXBvcylcbiAgICAgKiAgQXJyYXkgZGUgb2JqZXRvcyBjb20gb3MgY2FtcG9zXG4gICAgICogICAgZXg6IFtcbiAgICAgKiAgICAgIHsgbmFtZTogJ25hbWUnLCBsYWJlbDogJ05vbWUnIH0sXG4gICAgICogICAgICB7IG5hbWU6ICdkZXNjcmlwdGlvbicsIGxhYmVsOiAnRGVzY3Jpw6fDo28nIH0sXG4gICAgICogICAgICB7IG5hbWU6ICdyb2xlLm5hbWUnLCBsYWJlbDogJ1BlcmZpbCcgfSxcbiAgICAgKiAgICAgIHsgbmFtZTogJ2Zvcm1hdERhdGUoZGF0ZSknLCBsYWJlbDogJ0RhdGEnIH0sKlxuICAgICAqICAgIF1cbiAgICAgKiBAcGFyYW0ge2FycmF5fSBkYXRhIC0gQXJyYXkgcXVlIHZhaSBzZXJ2aXIgY29tbyBmb250ZSBkZSBkYWRvc1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlTmFtZSAtIE5vbWUgZG8gYXJxdWl2byBzZW0gYSBleHRlbnPDo29cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gY29uZmlnXG4gICAgICogQ29uZmlndXJhw6fDtWVzIGRhIGRvY3VtZW50YcOnw6NvIGRvIGFsYXNxbCBjb21vOlxuICAgICAqICAtIChib29sZWFuKSBoZWFkZXJzXG4gICAgICogbWFpcyBhcyBkZXN0YWNhZGFzIGFiYWl4b1xuICAgICAqICAtIChzdHJpbmcpIHdoZXJlXG4gICAgICogIC0gKHN0cmluZykgb3JkZXJCeVxuICAgICAqXG4gICAgICogZmlsdGVycyBkZWZpbmlkb3NcbiAgICAgKlxuICAgICAqIGZvcm1hdERhdGUoY2FtcG8sIFtmb3JtYXRvXSlcbiAgICAgKlxuICAgICAqIEV4ZW1wbG86XG4gICAgICpcbiAgICAgKiB2YXIgY2FycyA9IFtcbiAgICAgKiAgeyBuYW1lOiAnU3RpbG8nLCAgYnJhbmQ6ICdGaWF0JywgZGF0ZTogbW9tZW50KCkuc3VidHJhY3QoMSwgJ3llYXJzJykgfSxcbiAgICAgKiAgeyBuYW1lOiAnUHVudG8nLCAgYnJhbmQ6ICdGaWF0JywgZGF0ZTogbW9tZW50KCkuc3VidHJhY3QoMywgJ3llYXJzJykgfSxcbiAgICAgKiAgeyBuYW1lOiAnRmllc3RhJywgYnJhbmQ6ICdGb3JkJywgZGF0ZTogJzA0LTAxLTIwMTcnIH1cbiAgICAgKiBdXG4gICAgICpcbiAgICAgKiBQckZpbGUuZXhwb3J0VG9FeGNlbChbXG4gICAgICogIHsgbmFtZTogJ2JyYW5kJywgbGFiZWw6ICdNYXJjYScgfSxcbiAgICAgKiAgeyBuYW1lOiAnbmFtZScsIGxhYmVsOiAnTm9tZScgfSxcbiAgICAgKiAgeyBuYW1lOiAnZm9ybWF0RGF0ZShkYXRlLCBcXCdERC1NTS1ZWVlZXFwnKScsIGxhYmVsOiAnQ29tcHJhZG8gZW0/JyB9XG4gICAgICogXSwgY2FycywgJ2RhdGEtZXhwb3J0Jywge1xuICAgICAqICBvcmRlckJ5OiAnYnJhbmQgQVNDLCBuYW1lIEFTQycsXG4gICAgICogIHdoZXJlOiAnYnJhbmQgbGlrZSBcIiVGaSVcIidcbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtwcm9taXNzZX0gLSBSZXRvcm5hIHVtYSBwcm9taXNzZSBxdWUgcG9kZSBvdSBuw6NvIHNlciByZXNvbHZpZGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleHBvcnRUbyhmaWVsZHMsIGRhdGEsIGZpbGVOYW1lLCBjb25maWcpIHtcbiAgICAgIHZhciBkZWZhdWx0Q29uZmlnID0ge1xuICAgICAgICBoZWFkZXJzOiB0cnVlXG4gICAgICB9XG5cbiAgICAgIGlmIChhbmd1bGFyLmlzT2JqZWN0KGNvbmZpZykpIGFuZ3VsYXIubWVyZ2UoZGVmYXVsdENvbmZpZywgY29uZmlnKTtcbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKGZpbGVOYW1lKSkgZmlsZU5hbWUgPSAnZXhwb3J0J1xuXG4gICAgICBkZWZhdWx0Q29uZmlnLndoZXJlID0gKGFuZ3VsYXIuaXNEZWZpbmVkKGRlZmF1bHRDb25maWcud2hlcmUpKSA/ICcgV0hFUkUgJyArIGRlZmF1bHRDb25maWcud2hlcmUgOiAnICc7XG4gICAgICBkZWZhdWx0Q29uZmlnLm9yZGVyQnkgPSAoYW5ndWxhci5pc0RlZmluZWQoZGVmYXVsdENvbmZpZy5vcmRlckJ5KSkgPyAnIE9SREVSIEJZICcgKyBkZWZhdWx0Q29uZmlnLm9yZGVyQnkgOiAnICc7XG5cbiAgICAgIGZpbGVOYW1lID0gZmlsZU5hbWUgKyAnLicgKyBkZWZhdWx0Q29uZmlnLmZvcm1hdFRvO1xuXG4gICAgICByZXR1cm4gYWxhc3FsLnByb21pc2UoJ1NFTEVDVCAnICsgYnVpbGRGaWVsZHMoZmllbGRzKVxuICAgICAgICArICcgSU5UTyAnICsgZGVmYXVsdENvbmZpZy5mb3JtYXRUby50b1VwcGVyQ2FzZSgpICsgJyg/LCA/KSBGUk9NID8gJ1xuICAgICAgICArIGRlZmF1bHRDb25maWcud2hlcmVcbiAgICAgICAgKyBkZWZhdWx0Q29uZmlnLm9yZGVyQnksIFtmaWxlTmFtZSwgZGVmYXVsdENvbmZpZywgZGF0YV0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4cG9ydGEgb3MgZGFkb3MgZW52aWFkb3MgcGFyYSBjc3ZcbiAgICAgKlxuICAgICAqIEBzZWUgZXhwb3J0VG9cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleHBvcnRUb0NTVihmaWVsZHMsIGRhdGEsIGZpbGVOYW1lLCBjb25maWcpIHtcbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKGNvbmZpZykpIGNvbmZpZyA9IHt9O1xuXG4gICAgICBjb25maWcuZm9ybWF0VG8gPSAnY3N2JztcblxuICAgICAgcmV0dXJuIGV4cG9ydFRvKGZpZWxkcywgZGF0YSwgZmlsZU5hbWUsIGNvbmZpZyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhwb3J0YSBvcyBkYWRvcyBlbnZpYWRvcyBwYXJhIGV4Y2VsXG4gICAgICpcbiAgICAgKiBAc2VlIGV4cG9ydFRvXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXhwb3J0VG9FeGNlbChmaWVsZHMsIGRhdGEsIGZpbGVOYW1lLCBjb25maWcpIHtcbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKGNvbmZpZykpIGNvbmZpZyA9IHt9O1xuXG4gICAgICBjb25maWcuZm9ybWF0VG8gPSAneGxzeCc7XG5cbiAgICAgIHJldHVybiBleHBvcnRUbyhmaWVsZHMsIGRhdGEsIGZpbGVOYW1lLCBjb25maWcpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1vbnRhIHVtYSBzdHJpbmcgY29udGVuZG8gb3MgY2FtcG9zIHBhcmEgbyBTRUxFQ1QgZGEgUXVlcnkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYnVpbGRGaWVsZHMoZmllbGRzKSB7XG4gICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGZpZWxkcykpIHtcbiAgICAgICAgZmllbGRzID0gbG9kYXNoLm1hcChmaWVsZHMsIGZ1bmN0aW9uKGZpZWxkKSB7XG4gICAgICAgICAgcmV0dXJuIGZpZWxkLm5hbWUgKyAnIGFzIFsnICsgZmllbGQubGFiZWwgKyAnXSc7XG4gICAgICAgIH0pLmpvaW4oJywgJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmaWVsZHM7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9iajtcbiAgfVxuXG59KCkpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5maWx0ZXIoJ3ByRGF0ZScsIHByRGF0ZSk7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LXBhcmFtc1xuICBmdW5jdGlvbiBwckRhdGUobW9tZW50KSB7XG4gICAgLyoqXG4gICAgICogRm9ybWF0YSB1bWEgZGF0YSBubyBwYWRyw6NvIGJyYXNpbGVpcm9cbiAgICAgKi9cbiAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUsIGlucHV0Rm9ybWF0KSB7XG4gICAgICB2YXIgb3V0cHV0Rm9ybWF0ID0gJ0REL01NL1lZWVknO1xuXG4gICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoaW5wdXRGb3JtYXQpKSB7XG4gICAgICAgIHJldHVybiBtb21lbnQodmFsdWUsIGlucHV0Rm9ybWF0KS5mb3JtYXQob3V0cHV0Rm9ybWF0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBtb21lbnQodmFsdWUpLmZvcm1hdChvdXRwdXRGb3JtYXQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5maWx0ZXIoJ3ByRGF0ZXRpbWUnLCBwckRhdGV0aW1lKTtcblxuICAvKiogQG5nSW5qZWN0ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtcGFyYW1zXG4gIGZ1bmN0aW9uIHByRGF0ZXRpbWUobW9tZW50KSB7XG4gICAgLyoqXG4gICAgICogRm9ybWF0YSB1bWEgZGF0YSBjb20gaG9yw6FyaW8gbm8gcGFkcsOjbyBicmFzaWxlaXJvXG4gICAgICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gbW9tZW50KHZhbHVlKS5mb3JtYXQoJ0REL01NL1lZWVkgSEg6bW0nKTtcbiAgICB9XG4gIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ25nUHJvZGViJylcbiAgICAuZmlsdGVyKCdyZWFsJywgcmVhbCk7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LXBhcmFtc1xuICBmdW5jdGlvbiByZWFsKCRmaWx0ZXIpIHtcbiAgICAvKipcbiAgICAgKiBGb3JtYXRhIHVtIHZhbG9yIHBhcmEgbyBwYWRyw6NvIGJyYXNpbGVpcm9cbiAgICAgKi9cbiAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiAkZmlsdGVyKCdjdXJyZW5jeScpKHZhbHVlLCAnUiQgJyk7XG4gICAgfVxuICB9XG5cbn0pKCk7XG4iLCIvKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLyogZXNsaW50LWRpc2FibGUgbWF4LWxlbiAqL1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5jb25zdGFudCgnUHJJY29ucycsIFtcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdwci1leGNlbCcsXG4gICAgICAgIHVybDogJ3ByLWV4Y2VsLnN2ZycsXG4gICAgICAgIHN2ZzogJzxzdmcgaGVpZ2h0PVwiMjRcIiB3aWR0aD1cIjI0XCIgc3R5bGU9XCJmaWxsOiMyRTdEMzJcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+PHBhdGggZD1cIk02LDJIMTRMMjAsOFYyMEEyLDIgMCAwLDEgMTgsMjJINkEyLDIgMCAwLDEgNCwyMFY0QTIsMiAwIDAsMSA2LDJNMTMsMy41VjlIMTguNUwxMywzLjVNMTcsMTFIMTNWMTNIMTRMMTIsMTQuNjdMMTAsMTNIMTFWMTFIN1YxM0g4TDExLDE1LjVMOCwxOEg3VjIwSDExVjE4SDEwTDEyLDE2LjMzTDE0LDE4SDEzVjIwSDE3VjE4SDE2TDEzLDE1LjVMMTYsMTNIMTdWMTFaXCIgLz48L3N2Zz4nXG4gICAgICB9XG4gICAgXSk7XG5cbn0oKSk7XG4iLCIvKmVzbGludC1lbnYgZXM2Ki9cblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ25nUHJvZGViJylcbiAgICAuZGlyZWN0aXZlKCdwclBhZ2luYXRpb24nLCBwYWdpbmF0aW9uRGlyZWN0aXZlKTtcblxuICAvKipcbiAgICogRGlyZXRpdmEgcXVlIGV4aWJlIHVtYSBwYWdpbmHDp8Ojby5cbiAgICogQWRvdGEgbyBlc3RpbG8gZGUgcGFnaW5hw6fDo28gZGEgQnVzY2EgZG8gR29vZ2xlLlxuICAgKiBVdGlsaXphIG9zIGVzdGlsb3MgZG8gYm9vdHN0cmFwXG4gICAqL1xuICAvKiogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIHBhZ2luYXRpb25EaXJlY3RpdmUoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnQUUnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcGFnaW5hdG9yOiAnPSdcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8c2VjdGlvbiBjbGFzcz1cInByLXBhZ2luYXRpb25cIiBsYXlvdXQ9XCJyb3dcIj5cbiAgICAgICAgICA8c2VjdGlvbiBsYXlvdXQ9XCJyb3dcIiBsYXlvdXQtYWxpZ249XCJjZW50ZXIgY2VudGVyXCIgbGF5b3V0LXdyYXBcbiAgICAgICAgICAgIHN0eWxlPVwibWFyZ2luLXJpZ2h0OiAxMHB4XCJcbiAgICAgICAgICAgIG5nLXNob3c9XCJwYWdpbmF0b3IubnVtYmVyT2ZQYWdlcyA+IDFcIj5cbiAgICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXG4gICAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCJwYWdpbmF0b3IuY3VycmVudFBhZ2UgPT09IDFcIlxuICAgICAgICAgICAgICAgIG5nLWNsaWNrPVwicGFnaW5hdG9yLmdvVG9QYWdlKDEpXCI+e3twYWdpbmF0b3Iub3B0aW9ucy5sYWJlbHMuZmlyc3R9fTwvbWQtYnV0dG9uPlxuICAgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcmFpc2VkXCJcbiAgICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cInBhZ2luYXRvci5jdXJyZW50UGFnZSA9PT0gMVwiXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCJwYWdpbmF0b3IucHJldmlvdXNQYWdlKClcIj57e3BhZ2luYXRvci5vcHRpb25zLmxhYmVscy5wcmV2aW91c319PC9tZC1idXR0b24+XG4gICAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIlxuICAgICAgICAgICAgICAgIG5nLXJlcGVhdD1cIm4gaW4gcGFnaW5hdG9yLnBhZ2VzKHMpXCJcbiAgICAgICAgICAgICAgICBuZy1jbGFzcz1cInsnbWQtcHJpbWFyeSc6IG4gPT0gcGFnaW5hdG9yLmN1cnJlbnRQYWdlfVwiXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCJwYWdpbmF0b3IuZ29Ub1BhZ2UobilcIlxuICAgICAgICAgICAgICAgIG5nLWJpbmQ9XCJuXCI+MTwvbWQtYnV0dG9uPlxuICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXG4gICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwicGFnaW5hdG9yLmN1cnJlbnRQYWdlID09IHBhZ2luYXRvci5udW1iZXJPZlBhZ2VzXCJcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCJwYWdpbmF0b3IubmV4dFBhZ2UoKVwiPnt7cGFnaW5hdG9yLm9wdGlvbnMubGFiZWxzLm5leHR9fTwvbWQtYnV0dG9uPlxuICAgICAgICAgICAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiXG4gICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwicGFnaW5hdG9yLmN1cnJlbnRQYWdlID09IHBhZ2luYXRvci5udW1iZXJPZlBhZ2VzXCJcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCJwYWdpbmF0b3IuZ29Ub1BhZ2UocGFnaW5hdG9yLm51bWJlck9mUGFnZXMpXCI+e3twYWdpbmF0b3Iub3B0aW9ucy5sYWJlbHMubGFzdH19PC9tZC1idXR0b24+XG4gICAgICAgICAgPC9zZWN0aW9uPlxuICAgICAgICAgIDxzZWN0aW9uIGxheW91dD1cInJvd1wiIGxheW91dC1hbGlnbj1cImNlbnRlciBjZW50ZXJcIlxuICAgICAgICAgICAgbmctc2hvdz1cInBhZ2luYXRvci50b3RhbCA+IDBcIj5cbiAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1yYWlzZWRcIiBzdHlsZT1cImN1cnNvcjogZGVmYXVsdDtcIlxuICAgICAgICAgICAgICBuZy1kaXNhYmxlZD1cInRydWVcIiBtZC1jb2xvcnM9XCI6OntiYWNrZ3JvdW5kOidhY2NlbnQnfVwiPlRvdGFsOiB7e3BhZ2luYXRvci50b3RhbH19IHJlZ2lzdHJvKHMpPC9tZC1idXR0b24+XG4gICAgICAgICAgPC9zZWN0aW9uPlxuICAgICAgICA8L3NlY3Rpb24+YFxuICAgIH07XG4gIH1cblxufSkoKTtcbiIsIi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5mYWN0b3J5KCdQclBhZ2luYXRpb24nLCBwYWdpbmF0aW9uU2VydmljZSk7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBwYWdpbmF0aW9uU2VydmljZSgpIHtcblxuICAgIC8qKlxuICAgICAqIENyaWEgZSByZXRvcm5hIHVtYSBpbnN0YW5jaWEgZG8gb2JqZXRvIHBhZ2luYWRvci5cbiAgICAgKlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHNlYXJjaE1ldGhvZCAtIGZ1bsOnw6NvIHJlc3BvbnPDoXZlbCBwb3IgY2FycmVnYXIgb3MgZGFkb3NcbiAgICAgICBlIHF1ZSB2YWkgc2VyIGNoYW1hZGEgcXVhbmRvIG8gdXN1w6FyaW8gY2xpY2FyIGVtIHVtYSBww6FnaW5hXG4gICAgICogQHBhcmFtIHtpbnR9IHBlclBhZ2UgLSBOw7ptZXJvIGRlIGl0ZW5zIHBvciBww6FnaW5hLiBQYWRyw6NvIMOpIDEwLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBfb3B0aW9ucyAtIE9iamV0byBjb250ZW5kbyBhcyBkZW1haXMgY29uZmlndXJhw6fDtWVzXG4gICAgICovXG4gICAgdmFyIFByUGFnaW5hY2FvID0gZnVuY3Rpb24oc2VhcmNoTWV0aG9kLCBwZXJQYWdlLCBfb3B0aW9ucykge1xuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIG1heFBhZ2VzOiAxMCxcbiAgICAgICAgbGFiZWxzOiB7XG4gICAgICAgICAgZmlyc3Q6ICfCq8KrJyxcbiAgICAgICAgICBwcmV2aW91czogJ8KrJyxcbiAgICAgICAgICBuZXh0OiAnwrsnLFxuICAgICAgICAgIGxhc3Q6ICfCu8K7J1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vc29icmVlc2NyZXZlIG9zIHBhcmFtZXRyb3MgcGFkcsO1ZXNcbiAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKHBlclBhZ2UpKSB7XG4gICAgICAgIHBlclBhZ2UgPSAxMDtcbiAgICAgIH1cblxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKF9vcHRpb25zKSkge1xuICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoX29wdGlvbnMubWF4UGFnZXMpKSB7XG4gICAgICAgICAgb3B0aW9ucy5tYXhQYWdlcyA9IF9vcHRpb25zLm1heFBhZ2VzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChfb3B0aW9ucy5sYWJlbHMpKSB7XG4gICAgICAgICAgb3B0aW9ucy5sYWJlbHMgPSBfb3B0aW9ucy5sYWJlbHM7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy9jYWxjdWxhIHF1YW50YXMgcMOhZ2luYXMgdsOjbyBzZXIgZXhpYmlkYXMgbmEgcGFydGUgaW50ZXJtZWRpYXJpYSBkYSBwYWdpbmHDp8Ojb1xuICAgICAgb3B0aW9ucy5tYXhQYWdlc0lubmVyID0gTWF0aC5mbG9vcihvcHRpb25zLm1heFBhZ2VzIC8gMik7XG5cbiAgICAgIC8vQ3JpYSBvIG9iamV0byBwYWdpbmFkb3IgY29tIG9zIHBhcmFtZXRyb3MgaW5pY2lhaXNcbiAgICAgIHRoaXMuc2VhcmNoTWV0aG9kID0gc2VhcmNoTWV0aG9kO1xuICAgICAgdGhpcy5udW1iZXJPZlBhZ2VzID0gMTtcbiAgICAgIHRoaXMudG90YWwgPSAwO1xuICAgICAgdGhpcy5wZXJQYWdlID0gcGVyUGFnZTtcbiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAwO1xuICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxjdWxhIG8gbsO6bWVybyBkZSBww6FnaW5hcyBxdWUgdmFpIHNlciBleGliaWRhIGJhc2VhZG8gbm8gdG90YWwgZGVcbiAgICAgKiBpdGVucyBjb20gYSBwZXJQYWdlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2ludH0gdG90YWwgLSB0b3RhbCBkZSBpdGVuc1xuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5jYWxjTnVtYmVyT2ZQYWdlcyA9IGZ1bmN0aW9uKHRvdGFsKSB7XG4gICAgICB0aGlzLnRvdGFsID0gdG90YWw7XG5cbiAgICAgIGlmICh0b3RhbCA8PSAwKSB7XG4gICAgICAgIHRoaXMubnVtYmVyT2ZQYWdlcyA9IDFcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubnVtYmVyT2ZQYWdlcyA9IE1hdGguZmxvb3IodG90YWwgLyB0aGlzLnBlclBhZ2UpICsgKHRvdGFsICUgdGhpcy5wZXJQYWdlID4gMCA/IDEgOiAwKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVmVyaWZpY2EgYXMgcMOhZ2luYXMgcXVlIGRldmVtIHNlciBleGliaWRhc1xuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5wYWdlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJldCA9IFtdO1xuXG4gICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSB0aGlzLm51bWJlck9mUGFnZXM7IGkrKykge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA9PT0gaSkge1xuICAgICAgICAgIHJldC5wdXNoKGkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlIDw9ICh0aGlzLm9wdGlvbnMubWF4UGFnZXNJbm5lciArIDEpKSB7XG4gICAgICAgICAgICBpZiAoaSA8PSB0aGlzLm9wdGlvbnMubWF4UGFnZXMpIHtcbiAgICAgICAgICAgICAgcmV0LnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICgoaSA+PSB0aGlzLmN1cnJlbnRQYWdlIC0gdGhpcy5vcHRpb25zLm1heFBhZ2VzSW5uZXIpICYmXG4gICAgICAgICAgICAgIChpIDw9IHRoaXMuY3VycmVudFBhZ2UgKyB0aGlzLm9wdGlvbnMubWF4UGFnZXNJbm5lcikpIHtcbiAgICAgICAgICAgICAgcmV0LnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmV0O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDYXJyZWdhIG9zIGRhZG9zIGRhIHDDoWdpbmEgYW50ZXJpb3JcbiAgICAgKi9cbiAgICBQclBhZ2luYWNhby5wcm90b3R5cGUucHJldmlvdXNQYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA+IDEpIHtcbiAgICAgICAgdGhpcy5zZWFyY2hNZXRob2QodGhpcy5jdXJyZW50UGFnZSAtIDEpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDYXJyZWdhIG9zIGRhZG9zIGRhIHByw7N4aW1hIHDDoWdpbmFcbiAgICAgKi9cbiAgICBQclBhZ2luYWNhby5wcm90b3R5cGUubmV4dFBhZ2UgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlIDwgdGhpcy5udW1iZXJPZlBhZ2VzKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoTWV0aG9kKHRoaXMuY3VycmVudFBhZ2UgKyAxKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FycmVnYSBvcyBkYWRvcyBkYSBww6FnaW5hIGluZm9ybWFkYVxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbnR9IHBhZ2UgLSBwYWdpbmEgcXVlIGRldmUgc2VyIGNhcnJlZ2FkYVxuICAgICAqL1xuICAgIFByUGFnaW5hY2FvLnByb3RvdHlwZS5nb1RvUGFnZSA9IGZ1bmN0aW9uKHBhZ2UpIHtcbiAgICAgIGlmIChwYWdlID49IDEgJiYgcGFnZSA8PSB0aGlzLm51bWJlck9mUGFnZXMpIHtcbiAgICAgICAgdGhpcy5zZWFyY2hNZXRob2QocGFnZSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICBnZXRJbnN0YW5jZTogZnVuY3Rpb24oc2VhcmNoTWV0aG9kLCBwZXJQYWdlLCBfb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gbmV3IFByUGFnaW5hY2FvKHNlYXJjaE1ldGhvZCwgcGVyUGFnZSwgX29wdGlvbnMpO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxufSkoKTtcbiIsIi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICogRGlyZXRpdmEgcXVlIGV4aWJlIHVtIHNwaW5uZXIgc2VtcHJlIHF1ZSB1bSBicm9hZGNhc3QsIG1hbnVhbG1lbnRlLCDDqSBkaXNwYXJhZG9cbiAgICovXG4gIC8qKiBAbmdJbmplY3QgKi9cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ25nUHJvZGViJylcbiAgICAuY29tcG9uZW50KCdwclNwaW5uZXInLCB7XG4gICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8bWQtcHJvZ3Jlc3MtbGluZWFyIGNsYXNzPVwic3Bpbi1sYWJlbC1jb21wb25lbnQge3s6OiRjdHJsLmNvbG9yfX1cIlxuICAgICAgICAgIG5nLXN0eWxlPVwiJGN0cmwuc3R5bGVcIlxuICAgICAgICAgIG1kLW1vZGU9XCJpbmRldGVybWluYXRlXCJcbiAgICAgICAgICBuZy1zaG93PVwiJGN0cmwuc3Bpbm5lciAmJiAkY3RybC5zcGlubmVyLnNob3dcIj48L21kLXByb2dyZXNzLWxpbmVhcj5cbiAgICAgICAgYCxcbiAgICAgIGJpbmRpbmdzOiB7XG4gICAgICAgIHBvc2l0aW9uOiAnQCcsXG4gICAgICAgIGNvbG9yOiAnQCdcbiAgICAgIH0sXG4gICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICB2YXIgY3RybCA9IHRoaXM7XG5cbiAgICAgICAgY3RybC4kb25Jbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy9EZWZpbmUgYSBwb3Npw6fDo29cbiAgICAgICAgICBjdHJsLnN0eWxlID0geyBwb3NpdGlvbjogYW5ndWxhci5pc0RlZmluZWQoY3RybC5wb3NpdGlvbikgPyBjdHJsLnBvc2l0aW9uIDogJ2ZpeGVkJyB9O1xuICAgICAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKGN0cmwuY29sb3IpKSBjdHJsLmNvbG9yID0gJ21kLXByaW1hcnknO1xuICAgICAgICB9O1xuICAgICAgICAvL2NvbXBvcnRhbWVudG8gcGFkcsOjb1xuICAgICAgICBjdHJsLnNwaW5uZXIgPSB7XG4gICAgICAgICAgc2hvdzogZmFsc2VcbiAgICAgICAgfTtcblxuICAgICAgICAvL0VzY3V0YSBvIGNhbmFsIGVtaXRpZG8gdmlhIGJyb2FkY2FzdFxuICAgICAgICAvL3BhcmEgZXhpYmlyL2VzY29uZGVyIG8gY29tcG9uZW50ZVxuICAgICAgICAkc2NvcGUuJG9uKCdzaG93LXNwaW5uZXInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBjdHJsLnNwaW5uZXIgPSB7XG4gICAgICAgICAgICBzaG93OiB0cnVlXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbignaGlkZS1zcGlubmVyJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY3RybC5zcGlubmVyID0ge1xuICAgICAgICAgICAgc2hvdzogZmFsc2VcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH1dXG4gICAgfSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKVxuICAgIC5mYWN0b3J5KCdQclNwaW5uZXInLCBzcGlubmVyU2VydmljZSk7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBzcGlubmVyU2VydmljZSgkcm9vdFNjb3BlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNob3c6IHNob3csXG4gICAgICBoaWRlOiBoaWRlXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEV4aWJlIG8gc3Bpbm5lclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNob3coKSB7XG4gICAgICAvL2VtaXRlIG8gc2luYWwgcGFyYSBhIGRpcmV0aXZhIGluZm9ybWFuZG8gcXVlIG8gY29tcG9uZW50ZSBzcGlubmVyIGRldmUgc2VyIGV4aWJpZG9cbiAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnc2hvdy1zcGlubmVyJyk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBFc2NvbmRlIG8gc3Bpbm5lclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhpZGUoKSB7XG4gICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2hpZGUtc3Bpbm5lcicpO1xuICAgIH1cbiAgfVxuXG59KSgpO1xuIiwiLyplc2xpbnQtZW52IGVzNiovXG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCduZ1Byb2RlYicpXG4gICAgLmZhY3RvcnkoJ1ByVG9hc3QnLCBUb2FzdCk7XG5cbiAgLyoqXG4gICAqIFNlcnZpw6dvIHF1ZSBlbmNhcHN1bGEgZSBhbXBsaWEgb3Mgc2VydmnDp29zIGRvIGFuZ3VsYXIgdG9hc3RyXG4gICAqL1xuICAvKiogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIFRvYXN0KCRtZFRvYXN0LCBsb2Rhc2gsICRsb2cpIHtcbiAgICB2YXIgb2JqID0ge1xuICAgICAgc3VjY2Vzczogc3VjY2VzcyxcbiAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgIGVycm9yVmFsaWRhdGlvbjogZXJyb3JWYWxpZGF0aW9uLFxuICAgICAgaW5mbzogaW5mbyxcbiAgICAgIHdhcm46IHdhcm4sXG4gICAgICBoaWRlOiBoaWRlXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEV4aWJlIHVtYSBub3RpZmljYcOnw6NvXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbXNnIC0gTWVuc2FnZW0gZGEgbm90aWZpY2HDp8Ojb1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjb2xvciAtIENvciBkZSBmdW5kbyBkYSBub3RpZmljYcOnw6NvXG4gICAgICpcbiAgICAgIEByZXR1cm5zIHtwcm9taXNzZX0gLSBSZXRvcm5hIHVtYSBwcm9taXNzZSBxdWUgcG9kZSBvdSBuw6NvIHNlciByZXNvbHZpZGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0b2FzdChtc2csIGNvbG9yLCBvcHRpb25zKSB7XG4gICAgICBpZiAobXNnKSB7XG4gICAgICAgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICAgICAgPG1kLXRvYXN0PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdG9hc3QtY29udGVudFwiIG1kLWNvbG9ycz1cIjo6e2JhY2tncm91bmQ6JyR7Y29sb3J9J31cIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1kLXRvYXN0LXRleHRcIiBmbGV4PiR7bXNnfTwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L21kLXRvYXN0PlxuICAgICAgICAgIGAsXG4gICAgICAgICAgcG9zaXRpb246ICd0b3AgcmlnaHQnXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNPYmplY3Qob3B0aW9ucykpIGRlZmF1bHRPcHRpb25zID0gYW5ndWxhci5tZXJnZShkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgICAgICAgcmV0dXJuICRtZFRvYXN0LnNob3coZGVmYXVsdE9wdGlvbnMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJGxvZy5kZWJ1ZygnTWVuc2FnZW0gcGFyYSBzZXIgZXhpYmlkYSBubyBUb2FzdCBuw6NvIGZvaSBpbmZvcm1hZGEnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFc2NvbmRlIHVtYSBub3RpZmljYcOnw6NvXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gb2JqZWN0IC0gVW0gYXJndW1lbnRvIG9wY2lvbmFsIHBhcmEgYSBwcm9taXNlIGEgc2VyIHJlc29sdmlkYVxuICAgICAqXG4gICAgICogQHJldHVybnMge3Byb21pc3NlfSAtIFJldG9ybmEgdW1hIHByb21pc3NlIHF1ZSDDqSBleGVjdXRhZGEgcXVhbmRvIGEgbm90aWZpY2HDp8OjbyDDqSByZW1vdmlkYSBkbyBET01cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBoaWRlKG9iamVjdCkge1xuICAgICAgcmV0dXJuICRtZFRvYXN0LmhpZGUob2JqZWN0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdWNjZXNzKG1zZywgb3B0aW9ucykge1xuICAgICAgcmV0dXJuIHRvYXN0KG1zZywgJ2dyZWVuJywgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXJyb3IoZXJyb3JzLCBvcHRpb25zKSB7XG4gICAgICAvL3NlIGZvciB1bSBvYmpldG8gY29udGVuZG8gb3MgZXJyb3MsIGl0ZXJhIHNvYnJlIG9zIGF0cmlidXRvcyBkbyBtZXNtb1xuICAgICAgLy9wYXJhIGV4aWJpciBhKHMpIG1lbnNhZ2VtKG5zKSBkZSBlcnJvIGF0cmlidWlkYXNcbiAgICAgIGlmIChhbmd1bGFyLmlzT2JqZWN0KGVycm9ycykpIHtcbiAgICAgICAgdmFyIGVycm9yU3RyID0gJyc7XG5cbiAgICAgICAgLy8gZXhpYmUgYXMgbWVuc2FnZW0gZGUgZXJybyBjb250aWRhcyBubyBvYmpldG9cbiAgICAgICAgLy8gIHtcbiAgICAgICAgLy8gICAgXCJuYW1lXCI6IFtcIm8gY2FtcG8gbm9tZSDDqSBvYnJpZ2F0w7NyaW9cIl0sXG4gICAgICAgIC8vICAgIFwicGFzc3dvcmRcIjogW1xuICAgICAgICAvLyAgICAgIFwiQSBjb25maXJtYcOnw6NvIGRlIHNlbmhhIG7Do28gY29uZmVyZS5cIixcbiAgICAgICAgLy8gICAgICBcInNlbmhhIGRldmUgdGVyIG5vIG3DrW5pbW8gNiBjYXJhY3RlcmVzLlwiXG4gICAgICAgIC8vICAgIF1cbiAgICAgICAgLy8gIH1cbiAgICAgICAgbG9kYXNoLmZvckluKGVycm9ycywgZnVuY3Rpb24oa2V5RXJyb3JzKSB7XG4gICAgICAgICAgZXJyb3JTdHIgKz0gYnVpbGRBcnJheU1lc3NhZ2Uoa2V5RXJyb3JzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZXJyb3JzID0gZXJyb3JTdHI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGVycm9ycykpIHtcbiAgICAgICAgICBlcnJvcnMgPSBidWlsZEFycmF5TWVzc2FnZShlcnJvcnMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0b2FzdChlcnJvcnMsICdyZWQtQTcwMCcsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJ1aWxkQXJyYXlNZXNzYWdlKGFyck1zZykge1xuICAgICAgdmFyIG1zZyA9ICAnJztcblxuICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShhcnJNc2cpKSB7XG4gICAgICAgIC8vaXRlcmEgc29icmUgb3MgZXJyb3MgZGUgdW0gYXRyaWJ1dG9cbiAgICAgICAgYXJyTXNnLmZvckVhY2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICBtc2cgKz0gZXJyb3IgKyAnPGJyLz4nO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1zZyArPSBhcnJNc2cgKyAnPGJyLz4nO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbXNnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4aWJlIHVtIHRvYXN0IGNvbSBhcyBtZW5zYWdlbnMgZGUgZXJybyByZWZlcmVudGUgYSB2YWxpZGHDp8Ojby5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0IHwgYXJyYXl9IGVycm9ycyAtIE9iamV0byBvdSBBcnJheSBjb250ZW5kbyBhcyBtZW5zYWdlbnMgZGUgZXJyby4gRGV2ZSBlc3RhclxuICAgICAqIG5vIHNlZ3VpbnRlIGZvcm1hdG8uXG4gICAgICogICB7XG4gICAgICogICAgXCJub21lLWRvLWF0cmlidXRvMVwiOiBbXCJtZW5zYWdlbSBkZSBlcnJvIDFcIiwgXCJtZW5zYWdlbSBkZSBlcnJvIDJcIl0sXG4gICAgICogICAgXCJub21lLWRvLWF0cmlidXRvMlwiOiBbXCJtZW5zYWdlbSBkZSBlcnJvIDFcIl1cbiAgICAgKiAgIH1cbiAgICAgKiBvdVxuICAgICAqICAgW1xuICAgICAqICAgICdNZW5zYWdlbSAxJyxcbiAgICAgKiAgICAnTWVuc2FnZW0gMidcbiAgICAgKiAgIF1cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbXNnIC0gT3BjaW9uYWwuIE1lbnNhZ2VtIGRlIGVycm8uXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXJyb3JWYWxpZGF0aW9uKGVycm9ycywgbXNnLCBvcHRpb25zKSB7XG4gICAgICBvYmouZXJyb3IoKGFuZ3VsYXIuaXNBcnJheShlcnJvcnMpIHx8IGFuZ3VsYXIuaXNPYmplY3QoZXJyb3JzKSkgPyBlcnJvcnMgOiBtc2csIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluZm8obXNnLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gdG9hc3QobXNnLCAndGVhbCcsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdhcm4obXNnLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gdG9hc3QobXNnLCAnd2FybicsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIHJldHVybiBvYmo7XG4gIH1cblxufSgpKTtcbiIsIi8qZXNsaW50LWVudiBlczYqL1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdQcm9kZWInKS5kaXJlY3RpdmUoJ3ByVXBsb2FkZXJCYXNlNjQnLCBmdW5jdGlvbigkcSkge1xuICAgIHZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcblxuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgcmVxdWlyZTogJz9uZ01vZGVsJyxcbiAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbCkge1xuICAgICAgICBpZiAoIW5nTW9kZWwpIHJldHVybjtcblxuICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHt9O1xuXG4gICAgICAgIGVsZW1lbnQuYmluZCgnY2hhbmdlJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQ7XG5cbiAgICAgICAgICAkcS5hbGwoc2xpY2UuY2FsbChlbGVtZW50LmZpbGVzLCAwKS5tYXAocmVhZEZpbGUpKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24odmFsdWVzKSB7XG4gICAgICAgICAgICAgIGlmIChlbGVtZW50Lm11bHRpcGxlKSBuZ01vZGVsLiRzZXRWaWV3VmFsdWUodmFsdWVzKTtcbiAgICAgICAgICAgICAgZWxzZSBuZ01vZGVsLiRzZXRWaWV3VmFsdWUodmFsdWVzLmxlbmd0aCA/IHZhbHVlc1swXSA6IG51bGwpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICBmdW5jdGlvbiByZWFkRmlsZShmaWxlKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShlLnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgIH1cblxuICAgICAgICB9KTtcblxuICAgICAgfVxuICAgIH07XG5cbiAgfSk7XG5cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
